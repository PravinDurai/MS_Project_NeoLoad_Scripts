var OHRM=(function(parent){var photoQueue=[];var employeeNumbers=[];function fetchEmployeePhotos(){var uniqueEmpNumbers=employeeNumbers.filter(function(value,index,self){return self.indexOf(value)===index});var sortedEmpNumbers=uniqueEmpNumbers.sort(function(a,b){return a-b});$.get(OHRM.dashboard.employeePhotosUrl,{employees:sortedEmpNumbers.join()},function(data,status){var photos=data.reduce(function(map,obj){map[obj.id]={type:obj.type,image:obj.image};return map},{});$('img.employeePhoto').each(function(){var empId=$(this).data('id');if(photos[empId]){$(this).attr('src','data:'+photos[empId].type+';base64,'+photos[empId].image)}})})}
parent.dashboard=parent.dashboard||{};parent.dashboard.addToPhotoQueue=function(key){photoQueue.push(key)};parent.dashboard.fetchPhotos=function(key,newEmployees){employeeNumbers=employeeNumbers.concat(newEmployees);var index=photoQueue.indexOf(key);if(index!=-1){photoQueue.splice(index,1)}
if(photoQueue.length===0){fetchEmployeePhotos()}};return parent}(OHRM||{}));if(OHRM.angularInitialized){$(document).ready(function(){OHRM.dashboard.addToPhotoQueue('pendingLeave');setTimeout(function(){if(!OHRM.pendingLeave){OHRM.dashboard.fetchPhotos('pendingLeave',[]);return}
$.ajax({url:OHRM.pendingLeave.moduleUrl,success:function(obj){$("#pending-leave-collection").html('');$('#dropDownLeaveTrigger').find('.noOfNotifications').html(obj.count);var employeeNumbers=[];for(var i=0;i<obj.list.length;i++){employeeNumbers[i]=obj.list[i].employeeId;var item=$(OHRM.pendingLeave.itemTemplate);item.find('a').attr('href',OHRM.pendingLeave.baseUrl+obj.list[i].leaveRequestId);item.find('.pending-timesheet-title').text(obj.list[i].firstName+' '+obj.list[i].lastName);item.find('.pending-timesheet-content').text(obj.list[i].dateApplied);item.find('img').data('id',obj.list[i].employeeId);$("#pending-leave-collection").append(item)}
$('#leave-total-record-count').html(obj.count);if(obj.count>0){$('#viewLeaveListDashboardIcon').show()}else{$('#viewLeaveListDashboardIcon').hide()}
$('#leave-record-count').text(obj.list.length).parent('span').show();OHRM.dashboard.fetchPhotos('pendingLeave',employeeNumbers)}})},200)})};if(OHRM.angularInitialized){$(document).ready(function(){setTimeout(function(){if(!OHRM.pendingTimesheets){OHRM.dashboard.fetchPhotos('pendingTimesheets',[]);return}
$.ajax({url:OHRM.pendingTimesheets.moduleUrl,success:function(obj){$("#pending-timesheet-collection").html('');$('#dropDownTimeSheetTrigger').find('.noOfNotifications').html(obj.count);var employeeNumbers=[];for(var i=0;i<obj.list.length;i++){employeeNumbers[i]=obj.list[i].employeeId;var item=$(OHRM.pendingTimesheets.itemTemplate);item.find('a').attr('href',obj.list[i].link);var name=obj.list[i].employeeFirstName+' '+obj.list[i].employeeLastName;if(obj.list[i].terminationId==1){name=name+' ('+pastEmployeeTag+')'}
item.find('.pending-timesheet-title').text(name);item.find('.pending-timesheet-content').text(obj.list[i].timesheetStartday+' '+OHRM.lang.to+' '+obj.list[i].timesheetEndDate);item.find('img').data('id',obj.list[i].employeeId);$("#pending-timesheet-collection").append(item)}
$('#time-total-record-count').html(obj.count);if(obj.count>0){$('#viewTimesheetsDashboardIcon').show()}else{$('#viewTimesheetsDashboardIcon').hide()}
$('#time-record-count').text(obj.list.length).parent('span').show();OHRM.dashboard.fetchPhotos('pendingTimesheets',employeeNumbers)}})},200)})};if(OHRM.angularInitialized){$(document).ready(function(){$("#task-list-group-panel-menu_holder-int").mousemove(function(e){if($(this).height()<$("#task-list-group-panel-slider-int").height()){var distance=e.pageY-$(this).offset().top;var percentage=distance/$(this).height();var targetY=-Math.round(($("#task-list-group-panel-slider-int").height()-$(this).height())*percentage);$('#task-list-group-panel-slider-int').animate({top:[targetY+"px","easeOutCirc"]},{queue:!1,duration:200})}});setTimeout(function(){if(!OHRM.scheduledInterviews){return}
$.ajax({url:OHRM.scheduledInterviews.moduleUrl,success:function(obj){$("#task-list-group-panel-menu_holder-int").html('');$('#dropDownRecruitmentTrigger').find('.noOfNotifications').html(obj.count);for(var i=0;i<obj.list.length;i++){var title=obj.list[i].VacancyEvent.eventTitle+' - '+obj.list[i].JobCandidateVacancy.JobCandidate.firstName+' '+obj.list[i].JobCandidateVacancy.JobCandidate.lastName;var testType=obj.list[i].VacancyEvent.VacancyEventType.isInterview?'int':'test';var itemId=testType+'_'+obj.list[i].eventId+'_'+obj.list[i].JobCandidateVacancy.candidateId+'_'+obj.list[i].JobCandidateVacancy.vacancyId;var item=$(OHRM.scheduledInterviews.itemTemplate);item.attr('id',itemId);item.find('.pending-timesheet-title').text(title);item.find('.pending-timesheet-title').attr('data-tooltip',title);item.find('.pending-timesheet-content').text(obj.list[i].scheduledTime);$("#task-list-group-panel-menu_holder-int").append(item);$('body').on('click','#'+itemId,function(event){event.preventDefault();if(OHRM.scheduledInterviews.interviewAssistantEnabled){var id=$(this).attr('id');var params=id.split('_');if(params.length===4){var isInterview=params[0]==='int';goToEvent(params[1],params[2],params[3],isInterview)}}else{toast.warning(OHRM.scheduledInterviews.interviewAssistantDisabledToast)}})}
$('#interview-total-record-count').html(obj.count);$('#interview-record-count').text(obj.list.length).parent('span').show();$('.tooltipped').tooltip()}})},200)});function goToEvent(eventId,candidateId,vacancyId,isInterview){if(isInterview){var url=OHRM.scheduledInterviews.getInterviewUrl(eventId,candidateId)}else{var url=OHRM.scheduledInterviews.getProfileUrl(eventId,candidateId,vacancyId)}
window.open(url,'open_window','height=1600,width=1800,directories=no,titlebar=no,toolbar=no,location =0,status=no,menubar=no,resizable=yes,scrollbars=yes')}};if(typeof ReportVisualizerPieChartGlobals==='undefined'){ReportVisualizerPieChartGlobals={colorStatusMap:{},colorHolder:[]}}
function visualizePieChart(data,graph,properties,divId){var plottedData=[];var showLegend=!1;var interactive=!1;var suffixForValueHover="";var labelColorMatching=!1;if(properties['show-legend']){showLegend=!0}
if(properties.interactive){interactive=!0}
if(properties.suffixForValueHover){suffixForValueHover=" "+properties.suffixForValueHover}
if(properties['label-color-matching']){labelColorMatching=!0}
var chartOptions={series:{pie:{show:!0}},legend:{show:showLegend},grid:{hoverable:interactive},colors:['#EA0034','#FFE63B','#009543','#07B9FC','#FD4703','#8200AC','#0047BD','#9AF000','#00AB38','#FF1A1A','#FF822A','#B610BF','#2929A3','#FFB300','#0288D9','#CC72F5','#FFCE00','#00B300','#732673']};if(properties['show-labels']){var legendLabel={series:{pie:{radius:1,label:{show:!0,radius:2/3,formatter:function(label,series){return '<div style="font-weight:bold;font-size:8pt;text-align:center;padding:2px;color:white;">'+Math.round(series.percent)+'%</div>'},threshold:0.1}}}};$.extend(!0,chartOptions,legendLabel)}
if(graph.legend.legendDivId){legendDivId=graph.legend.legendDivId}
if(graph.legend.useSeparateContainer){var legendContainer={legend:{container:'#'+legendDivId+'_legend'}};$.extend(!0,chartOptions,legendContainer)}
function getColor(status){if(labelColorMatching){if(Object.keys(ReportVisualizerPieChartGlobals.colorStatusMap).indexOf(status)===-1){if(ReportVisualizerPieChartGlobals.colorHolder.length==0){ReportVisualizerPieChartGlobals.colorHolder=chartOptions.colors}
ReportVisualizerPieChartGlobals.colorStatusMap[status]=ReportVisualizerPieChartGlobals.colorHolder.shift()}
return ReportVisualizerPieChartGlobals.colorStatusMap[status]}
return undefined}
for(var idx in data){var item={label:$('<div>').text(idx.toString()).html(),data:data[idx],color:getColor(idx.toString())};plottedData.push(item)}
$.plot($("#"+divId),plottedData,chartOptions);$("#"+divId).bind("plothover",pieHover);function pieHover(event,pos,obj){if(!obj){$("#hover_"+divId).html("");return}
value=obj.series.datapoints.points[1];percent=parseFloat(obj.series.percent).toFixed(2);$("#hover_"+divId).html('<span style="font-weight: bold; color: '+obj.series.color+'">'+obj.series.label+': '+value+suffixForValueHover+' ('+percent+'%)</span>')}};function visualizeBarChart(data,graph,properties,divId,legentVerticalAlignment){var plottedData=null;var graphGroups=[];var ticks=[];var maxNoOfGaps=6;var interactive=!1;var legendDivId=divId;var suffixForValueHover="";var suffixForLabelForHover="";var noOfGraphGroups=parseInt(data.length);var gapsInBetween=(noOfGraphGroups>=maxNoOfGaps)?3:(maxNoOfGaps-noOfGraphGroups);if(properties.interactive){interactive=!0}
var alignmentOptions;if(legentVerticalAlignment){alignmentOptions={show:!0}}else{alignmentOptions={show:!0,noColumns:graph.legend.noOfColumns}}
if(properties.suffixForValueHover){suffixForValueHover=" "+properties.suffixForValueHover}
if(properties.suffixForLabelForHover){suffixForLabelForHover=properties.suffixForLabelForHover+" "}
for(var i in data){plottedData=[];var index=parseInt(i);for(var j in data[i]){var item=[index,data[i][j]];plottedData.push(item);index+=(noOfGraphGroups+gapsInBetween)}
graphGroups.push({data:plottedData,label:graph.legend.labels[i]})}
var tickStartAt=1*0.5*noOfGraphGroups;var noOfTicks=(data.length>0)?data[0].length:0;for(i=0;i<=noOfTicks;i++){ticks.push([tickStartAt,graph.xAxisLabels[i]]);tickStartAt+=(noOfGraphGroups+gapsInBetween)}
var chartOptions={bars:{show:!0,barWidth:graph.barWidth,fill:graph.barOpacity},xaxis:{show:!0,ticks:ticks,tickLength:0},yaxis:{show:!0,min:graph.yAxisMinValue,max:graph.yAxisMaxValue,minTickSize:graph.yAxisMinTickSize},legend:alignmentOptions,grid:{hoverable:interactive},colors:['#EA0034','#FFE63B','#009543','#07B9FC','#FD4703','#8200AC','#0047BD','#9AF000','#00AB38','#FF1A1A','#FF822A','#B610BF','#2929A3','#FFB300','#0288D9','#CC72F5','#FFCE00','#00B300','#732673']};if(graph.legend.legendDivId){legendDivId=graph.legend.legendDivId}
if(graph.legend.useSeparateContainer){var legendContainer={legend:{container:'#'+legendDivId+'_legend'}};$.extend(!0,chartOptions,legendContainer)}
$.plot($("#"+divId),graphGroups,chartOptions);$("#"+divId).bind("plothover",barHover);function barHover(event,pos,obj){if(!obj){$("#hover_"+divId).html("");return}
value=obj.series.datapoints.points[1];$("#hover_"+divId).html('<span style="font-weight: bold; color: '+obj.series.color+'">'+obj.series.label+': '+suffixForLabelForHover+value+suffixForValueHover+' </span>')}}