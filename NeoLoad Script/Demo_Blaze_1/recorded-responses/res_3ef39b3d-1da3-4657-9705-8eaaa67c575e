(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{EkRu:function(e,t,r){"use strict";r.r(t),r.d(t,"ReportScreen",(function(){return ee}));r("LW0h"),r("hBpG"),r("7xRU"),r("z84I"),r("IAdD"),r("+KXO"),r("KqXw"),r("MvUL"),r("3voH");var n=r("1Pcy"),o=r.n(n),a=r("W/Kd"),i=r.n(a),s=r("KEM+"),c=r.n(s),d=r("ERkP"),u=r("EbOo"),p=r("cnVF"),_=(r("WNMA"),r("RqPI")),l=r("1YZw"),v=r("oEGd"),m=r("aWyx"),f=r("0KEI"),E=r("hqKg"),b=r("kHBp"),h=r("lPpt"),A=r("Fg8X"),g=r("fz3c"),T=r("Fmkq"),w=r("QK5w"),O=r("V5Qi"),I=r("XOJV"),D=r("G6rE"),M=function(e,t){return t.match.params.reportType},R=function(e,t){return t.match.params.reportedId},S=function(e,t){var r;if(e&&e.data)return r=e.data.type===m.a.GROUP?"0":e.data.participants.filter((function(e){return e.user_id!==t}))[0].user_id,{conversationId:e.data.conversation_id,reportedUserId:r}},N=Object(E.createSelector)(w.a,(function(e,t){return t.location&&t.location.state&&t.location.state.clientReferer}),(function(e,t){var r,n=M(0,t);if(n!==g.a.DMConversation&&n!==g.a.DMMessage||(r=n===g.a.DMConversation?R(0,t):t.location.state?t.location.state.conversationId:void 0),r){var o=Object(O.a)(e,r),a=function(e,t){return _.g(e)}(e);return S(o,a)}}),(function(e,t){var r=M(0,t)===g.a.Moment?R(0,t):void 0;return r?h.a.select(e,r):void 0}),R,(function(e,t){return!!(t.location&&t.location.state&&t.location.state.isMedia)||!1}),(function(e,t){return M(0,t)===g.a.Moment?A.a.select(e,R(0,t)):void 0}),(function(e,t){var r=M(0,t)===g.a.List?R(0,t):void 0;return r?b.a.select(e,r):void 0}),(function(e,t){return t.location&&t.location.state&&t.location.state.promotedContent}),(function(e,t){return t.location&&t.location.state&&t.location.state.conversationSection}),(function(e,t){var r,n;return null===(r=t.location)||void 0===r||null===(n=r.state)||void 0===n?void 0:n.reportFlowId}),M,(function(e,t){return t.location&&t.location.state&&t.location.state.scribeNamespace}),(function(e,t){var r=M(0,t)===g.a.Tweet?R(0,t):void 0;return r?I.a.selectHydrated(e,r):void 0}),(function(e,t){var r=M(0,t)===g.a.User?R(0,t):void 0;return r?D.e.select(e,r):void 0}),_.f,(function(e,t,r,n,o,a,i,s,c,d,u,p,_,l,v,m){return{canGoBack:e,clientReferer:t,dmConversation:r,reportedId:o,isMedia:a,lang:m,liveEvent:n,moment:i,list:s,promotedContent:c,conversationSection:d,reportFlowId:u,reportType:p,scribeNamespace:_,tweet:l,user:v}})),y={addToast:l.b,block:D.e.block,createLocalApiErrorHandler:Object(f.d)("REPORT_SCREEN"),mute:D.e.mute,markTweetAsReported:I.a.markAsReported,richScribeAction:T.richScribeAction,unblock:D.e.unblock,unfollow:D.e.unfollow,unmute:D.e.unmute},C=Object(v.g)(N,y),k=r("wrlS"),L=r("jHSc"),U=r("3XMw"),j=r.n(U),P=r("tn7R"),H=r("SrIh"),F=r("Rp9C"),B=r("X04g"),V=r("u0B7"),G=r("tJZD"),K=r("/yvb"),W=r("bPFD"),q=r("rHpw"),x=j.a.h030c24b,z=j.a.gf5e9ea6,J=j.a.a9fd20be,X=j.a.i2b9632d,Q=j.a.h59f52ee,Y=j.a.eea0cbed,Z=j.a.b772cd65,$=function(e){if("object"==typeof e&&e)return Object.assign({},e)},ee=function(e){function t(t,r){var n;return n=e.call(this,t,r)||this,c()(o()(n),"_renderDoneButton",(function(){return n.state.isDone?d.createElement(K.a,{onPress:n._handleDone,size:"small",type:"primary"},Z):void 0})),c()(o()(n),"_handleDone",(function(){var e=n.props,t=e.history,r=e.reportType;if(n._scribeAction("done"),r===g.a.DMConversation||r===g.a.DMMessage)t.location.state&&t.location.state.previousPath.startsWith("/messages/requests/additional")?t.replace("/messages/requests/additional"):t.location.state&&t.location.state.previousPath.startsWith("/messages/requests")?t.replace("/messages/requests"):t.replace("/messages");else{var o=n._initialHistoryLength-window.history.length;t.go(o-1)}})),c()(o()(n),"_handleBack",(function(){n.props.history.goBack()})),c()(o()(n),"_handleUndoBlock",(function(e){return function(){var t=n.props,r=t.addToast,o=t.createLocalApiErrorHandler,a=t.promotedContent;(0,t.unblock)(e,{promotedContent:a}).then((function(){r({text:X})}),o(V.a))}})),c()(o()(n),"_handleUndoMute",(function(e){return function(){var t=n.props,r=t.addToast,o=t.createLocalApiErrorHandler;(0,t.unmute)(e).then((function(){r({text:Y})}),o({showToast:!0}))}})),c()(o()(n),"_getReportSource",(function(e){switch(e){case g.a.DMConversation:case g.a.DMMessage:return"dmconversation";case g.a.Moment:return"moment";case g.a.User:return"profile";case g.a.List:return"list";default:return"tweet"}})),c()(o()(n),"_getReportedTweetId",(function(){var e=n.props,t=e.liveEvent,r=e.moment,o=e.reportType,a=e.tweet;switch(o){case g.a.Moment:var i=(t?Object(P.a)(t.slates):[]).find((function(e){return e.tweet_id}));return i?i.tweet_id:r&&r.cover_media&&r.cover_media.tweet_id;case g.a.Tweet:return a&&a.id_str;default:return}})),c()(o()(n),"_getReportedUserId",(function(e){var t=n.props,r=t.dmConversation,o=t.liveEvent,a=t.moment,i=t.reportType,s=t.tweet,c=t.user,d=t.list;switch(i){case g.a.DMConversation:case g.a.DMMessage:if(e&&e.data&&r&&"0"===r.reportedUserId){var u=$(e.data);return u&&u.reported_user_id}return r&&r.reportedUserId;case g.a.Moment:return o&&o.liveEventDetails.attribution_user_id||a&&a.author&&a.author.id;case g.a.User:return c&&c.id_str;case g.a.List:return d&&d.user;case g.a.Tweet:return s&&s.user.id_str;default:return void Object(H.a)("Unknown report type "+i)}})),c()(o()(n),"_getReportUrl",(function(){var e=n.props,t=e.clientReferer,r=e.dmConversation,o=e.reportedId,a=e.isMedia,i=e.lang,s=e.liveEvent,c=e.moment,d=e.promotedContent,u=e.reportFlowId,_=e.conversationSection,l=e.reportType,v=e.list,m=e.scribeNamespace,f=n._getReportSource(l),E=l===g.a.DMConversation,b=l===g.a.DMMessage,h=l===g.a.Moment,A=l===g.a.List,T={client_location:[m.page,m.section,m.component].join(":"),client_referer:t,client_app_id:p.e,conversation_section:_,source:"report"+f,report_flow_id:u,reported_user_id:n._getReportedUserId(),reported_tweet_id:n._getReportedTweetId(),reported_direct_message_conversation_id:(b||E)&&r&&r.conversationId,reported_direct_message_id:b&&o,reported_moment_id:h?s&&s.liveEventDetails.id||c&&c.id_str:void 0,reported_list_id:A?v&&v.id_str:void 0,is_promoted:!!d,is_media:a,initiated_in_app:"1",lang:i};return"https://twitter.com/i/safety/report_story?"+Object.keys(T).filter((function(e){return!!T[e]})).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(T[e])})).join("&")})),c()(o()(n),"_messageHandler",(function(e){var t=n.props,r=t.addToast,o=t.markTweetAsReported,a=t.reportType,i=$(e.data);if(i&&"https://twitter.com"===e.origin&&"ReportAction"===i.type){var s=n.props,c=s.block,d=s.createLocalApiErrorHandler,p=s.mute,_=s.promotedContent,l=s.unfollow,v=n._getReportedUserId(e);switch(i.action){case"block":v&&c(v,{promotedContent:_}).then((function(){r({actionLabel:z,onAction:n._handleUndoBlock(v),text:J})}),d(u.a));break;case"unfollow":v&&l(v,{promotedContent:_}).catch(d(G.a));break;case"mute":v&&p(v).then((function(){r({actionLabel:z,onAction:n._handleUndoMute(v),text:Q})}),d({showToast:!0}));break;case"complete":if("tweet"===n._getReportSource(a)){var m=n._getReportedTweetId();m&&o(m,g.b.Tombstone)}n.setState({isDone:!0});break;case"error":n.setState({isDone:!0})}}})),n.state={isDone:!1},n._accessedDirectly=n._wasAccessedDirectly(),n._reportUrl=n._accessedDirectly?"":n._getReportUrl(),n._reportFlowIdEnabled=k.a.isTrue("report_flow_id_enabled"),n}i()(t,e);var r=t.prototype;return r.componentDidMount=function(){var e=this.props,t=e.addMessageListener,r=e.history;t(this._messageHandler),this._initialHistoryLength=window.history.length,this._wasAccessedDirectly()?r.push("/"):this._scribeAction("impression")},r.componentWillUnmount=function(){var e=this.state.isDone;this.props.removeMessageListener(this._messageHandler),e||this._wasAccessedDirectly()||this._scribeAction("cancel")},r.render=function(){var e=this.props,t=e.history,r=e.location,n=this.state.isDone;return this._accessedDirectly?null:d.createElement(L.b,{backButtonType:n?"close":"back",history:t,location:r,onBackClick:n?this._handleDone:this._handleBack,rightControl:this._renderDoneButton(),title:x},d.createElement(W.a,{allowForms:!0,src:this._reportUrl,style:q.a.absoluteFill}))},r._wasAccessedDirectly=function(){var e=this.props,t=e.canGoBack,r=e.dmConversation,n=e.list,o=e.liveEvent,a=e.reportedId,i=e.moment,s=e.reportType,c=e.scribeNamespace,d=e.tweet,u=e.user,p=o&&o.liveEventDetails.attribution_user_id;return!t||!c||s===g.a.Tweet&&!d||s===g.a.User&&!u||s===g.a.DMConversation&&!r||s===g.a.DMMessage&&(!a||!r)||s===g.a.Moment&&!i&&!p||s===g.a.List&&!n},r._getScribeNamespace=function(){if(this._scribeNamespace)return this._scribeNamespace;var e,t=this.props,r=t.reportType,n=t.scribeNamespace;switch(r){case g.a.DMConversation:e="report_dm_conversation";break;case g.a.Moment:e="report_moment";break;case g.a.Tweet:e="report_tweet";break;case g.a.User:e="report_user"}return this._scribeNamespace=Object.assign({},n,{element:e}),this._scribeNamespace},r._getScribeData=function(){if(this._scribeData)return this._scribeData;var e,t=this.props,r=t.reportType,n=t.promotedContent,o=t.scribeNamespace,a=t.tweet,i=t.user;if(r===g.a.Tweet)this._scribeData={associations:(e={},e[B.a.AssociationType.ASSOCIATED_TWEET]={association_id:a&&a.id_str,association_namespace:{page:o.page}},e),promoted:!!n,items:a?[F.a.forTweet(a)]:[]};else if(r===g.a.User){var s,c=i?[F.a.forUser(i.id_str)]:[];this._scribeData={associations:(s={},s[B.a.AssociationType.ASSOCIATED_USER]={association_id:i&&i.id_str},s),items:c,targets:c}}return this._scribeData},r._scribeAction=function(e){var t=this.props,r=t.reportFlowId,n=t.richScribeAction,o=this._getScribeData();this._reportFlowIdEnabled&&r&&(o=Object.assign({},o,{report_details:{report_flow_id:r}})),n(Object.assign({},this._getScribeNamespace(),{action:e}),o)},t}(d.Component);c()(ee,"defaultProps",{addMessageListener:function(e){return window.addEventListener("message",e)},isMedia:!1,removeMessageListener:function(e){return window.removeEventListener("message",e)}}),c()(ee,"reportTypes",g.a);t.default=C(ee)},aWyx:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return a})),r.d(t,"d",(function(){return i}));r("yH/f");var n=Object.freeze({ONE_TO_ONE:"ONE_TO_ONE",GROUP:"GROUP_DM"}),o=Object.freeze({AT_END:"AT_END",HAS_MORE:"HAS_MORE"}),a=Object.freeze({CONVERSATION_AVATAR_UPDATE:"conversation_avatar_update",CONVERSATION_NAME_UPDATE:"conversation_name_update",CONVERSATION_PROFILE_INFO_HEADER:"conversation_profile_info_header",CONVERSATION_READ:"conversation_read",DISABLE_NOTIFICATIONS:"disable_notifications",ENABLE_NOTIFICATIONS:"enable_notifications",JOIN_CONVERSATION:"join_conversation",MARK_ALL_AS_READ:"mark_all_as_read",MENTION_NOTIFICATIONS_UPDATE:"mention_notifications_setting_update",MESSAGE:"message",MESSAGE_DELETE:"message_delete",MESSAGE_MARK_AS_NOT_SPAM:"message_unmark_as_spam",MESSAGE_MARK_AS_SPAM:"message_mark_as_spam",PARTICIPANTS_JOIN:"participants_join",PARTICIPANTS_LEAVE:"participants_leave",REACTION_CREATE:"reaction_create",REACTION_DELETE:"reaction_delete",READ_ONLY_INDICATOR:"read_only_indicator",REMOVE_CONVERSATION:"remove_conversation",TRUST_CONVERSATION:"trust_conversation",TYPING_INDICATOR:"typing_indicator",WELCOME_MESSAGE:"welcome_message_create"}),i=Object.freeze({MUTUAL_FRIENDS:"mutual_friends"})},lPpt:function(e,t,r){"use strict";r("IAdD");var n=r("LdEA"),o=r.n(n),a=r("Zj7R"),i=r("3zvM"),s=r("lMB6"),c=function(e,t,r){var n,o=e.entities[t.meta.entityId],a=o&&o.liveEventDetails;return/_REQUEST$/.test(t.type)&&a?Object.assign({},e,{entities:Object.assign({},e.entities,(n={},n[a.id_str]=Object.assign({},o,{liveEventDetails:Object.assign({},a,{remind_me_subscription:Object.assign({},a.remind_me_subscription,r(a.remind_me_subscription))})}),n))}):e},d=Object(i.e)({namespace:"liveEvents",fetchOneContext:"FETCH_LIVE_EVENT",fetchOneEndpoint:function(e){return function(t,r){return e.LiveEvent.fetchLiveEventMetadata(t,r).then((function(e){var r=t.eventId;return u(e,r)}))}},fetchOneParams:function(e,t){var r=e[0];return Object.assign({eventId:r},t)},withApiErrorHandler:!1,customActions:{subscribe:{reducer:function(e,t){return c(e,t,(function(e){return{subscribed:!0}}))},getParams:function(e,t){return{eventId:e,params:t}},getApiMethod:function(e){return e.LiveEvent.updateRemindMeSubscription}},unSubscribe:{reducer:function(e,t){return c(e,t,(function(e){return{subscribed:!1}}))},getParams:function(e,t){return{eventId:e,params:t}},getApiMethod:function(e){return e.LiveEvent.updateRemindMeSubscription}}}});d.selectHydratedTweet=function(e,t){return e.tweets&&Object(a.a)(e.tweets,{},e.users,t)};var u=function(e,t){var r,n=e.entities,a=e.result,i=n.liveEvents,s=n.broadcasts,c=n.slates,d=n.tweets,u=n.users,p=o()(n,["liveEvents","broadcasts","slates","tweets","users"]),_={liveEventDetails:i[t],broadcasts:s,response:a.response,slates:c,tweets:d,users:u};return{entities:Object.assign({},p,{liveEvents:(r={},r[t]=_,r)})}};t.a=s.a.register(d)}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/web_legacy/bundle.Report.8804cfd4.js.map