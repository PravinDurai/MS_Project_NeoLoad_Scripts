(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"+0FD":function(e,t,n){"use strict";n("IAdD"),t.__esModule=!0,t.default=void 0;var r=o(n("7DT3")),a=o(n("ERkP")),i=o(n("OkZJ"));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e){return void 0===e&&(e={}),(0,r.default)("svg",Object.assign({},e,{style:[i.default.root,e.style],viewBox:"0 0 24 24"}),a.default.createElement("g",null,a.default.createElement("path",{d:"M16.925 9.5H14.5V7.075c0-.414-.336-.75-.75-.75s-.75.336-.75.75V9.5h-2.425c-.414 0-.75.336-.75.75s.336.75.75.75H13v2.425c0 .414.336.75.75.75s.75-.336.75-.75V11h2.425c.414 0 .75-.336.75-.75s-.336-.75-.75-.75zm-.3 11H4.25c-.413 0-.75-.337-.75-.75V8.402c0-.414-.336-.75-.75-.75s-.75.336-.75.75V19.75C2 20.99 3.01 22 4.25 22h12.375c.414 0 .75-.336.75-.75s-.336-.75-.75-.75z"}),a.default.createElement("path",{d:"M19.75 2h-12C6.51 2 5.5 3.01 5.5 4.25v12c0 1.24 1.01 2.25 2.25 2.25h12c1.24 0 2.25-1.01 2.25-2.25v-12C22 3.01 20.99 2 19.75 2zm.75 14.25c0 .413-.337.75-.75.75h-12c-.413 0-.75-.337-.75-.75v-12c0-.413.337-.75.75-.75h12c.413 0 .75.337.75.75v12z"})))};s.metadata={height:24,width:24};var c=s;t.default=c},"+Yfw":function(e,t,n){"use strict";n("IAdD"),t.__esModule=!0,t.default=void 0;var r=o(n("7DT3")),a=o(n("ERkP")),i=o(n("OkZJ"));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e){return void 0===e&&(e={}),(0,r.default)("svg",Object.assign({},e,{style:[i.default.root,e.style],viewBox:"0 0 24 24"}),a.default.createElement("g",null,a.default.createElement("path",{d:"M19 13H5c-.553 0-1-.447-1-1s.447-1 1-1h14c.553 0 1 .447 1 1s-.447 1-1 1zm0 6H5c-.553 0-1-.447-1-1s.447-1 1-1h14c.553 0 1 .447 1 1s-.447 1-1 1zm0-12H5c-.553 0-1-.447-1-1s.447-1 1-1h14c.553 0 1 .447 1 1s-.447 1-1 1z"})))};s.metadata={height:24,width:24};var c=s;t.default=c},"1DfR":function(e,t,n){"use strict";n("IAdD"),t.__esModule=!0,t.default=void 0;var r=o(n("7DT3")),a=o(n("ERkP")),i=o(n("OkZJ"));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e){return void 0===e&&(e={}),(0,r.default)("svg",Object.assign({},e,{style:[i.default.root,e.style],viewBox:"0 0 24 24"}),a.default.createElement("g",null,a.default.createElement("path",{d:"M19 13.5H5c-.828 0-1.5-.672-1.5-1.5s.672-1.5 1.5-1.5h14c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5zm0 6H5c-.828 0-1.5-.672-1.5-1.5s.672-1.5 1.5-1.5h14c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5zm0-12H5c-.828 0-1.5-.672-1.5-1.5S4.172 4.5 5 4.5h14c.828 0 1.5.672 1.5 1.5s-.672 1.5-1.5 1.5z"})))};s.metadata={height:24,width:24};var c=s;t.default=c},"33Kz":function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));n("2G9S"),n("hBpG"),n("z84I"),n("KqXw"),n("mlET"),n("Ysgh");var r=n("RhWx"),a=n.n(r),i=n("wrlS"),o=function(){return i.a.getArrayValue("dm_reactions_config_active_reactions")},s=function(){var e=i.a.getArrayValue("dm_reactions_config_inactive_reactions"),t=o();return[].concat(a()(t),a()(e))},c=function(e){var t=s().find((function(t){return t.endsWith(e)}));if(t)return t.split(":")[0]},l=function(e){return void 0===e&&(e={includeInactive:!1}),e.includeInactive?s().map((function(e){return e.split(":")[1]})):o().map((function(e){return e.split(":")[1]}))}},"883S":function(e,t,n){"use strict";n.d(t,"a",(function(){return C})),n.d(t,"b",(function(){return E}));var r,a,i=n("k49u"),o=n("3XMw"),s=n.n(o),c=n("fs1G"),l=s.a.c3752568,d=s.a.f9690dc0,u=s.a.i859a9d3,p=s.a.b1d35407,m=s.a.g539cca6,f=s.a.bbac0019,h=s.a.a1d2a68d,v=s.a.d4f2d9d8,g=s.a.hf383be4,b=s.a.b25c5b2a,_=s.a.c4fdbd16,y=s.a.hf3e7e38,C=((r={})[i.a.DirectMessageConversationNotFound]={customAction:function(){return!1}},r),E=((a={defaultToast:{text:l}})[i.a.CurrentUserSuspended]={toast:{text:m,actionLabel:u,actionLink:"https://support.twitter.com/articles/15790"}},a[i.a.DirectMessageCannotDmOtherUser]={toast:{text:d}},a[i.a.DirectMessageDuplicate]={toast:{text:b}},a[i.a.DirectMessageOtherUserNotFollowing]={toast:{text:h,actionLabel:u,actionLink:"https://support.twitter.com/articles/14606"}},a[i.a.DirectMessagesSenderBlocksRecipient]={toast:{text:_}},a[i.a.DirectMessageTooLongError]={toast:{text:f}},a[i.a.DirectMessageTweetNotFound]={toast:{text:v}},a[i.a.GenericBadRequest]={customAction:c.a},a[i.a.MessageSendError]={toast:{text:y}},a[i.a.OverStatusUpdateLimit]={toast:{actionLabel:u,actionLink:"https://support.twitter.com/articles/15364",text:p}},a[i.a.TargetUserNotFound]={toast:{text:g}},a.showToast=!0,a)},AQOc:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return p}));n("LW0h"),n("lTEL"),n("z84I"),n("KOtZ"),n("IAdD"),n("7x/C"),n("kYxP");var r=n("LdEA"),a=n.n(r),i=n("lnti"),o=n("aWyx"),s={entries:{},entryIdsByConversationId:{},reactionsByMessageId:{}},c=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t={}),e.map((function(e){if(e.proof_type===o.d.MUTUAL_FRIENDS){var n=e.users,r=a()(e,["users"]);return Object.assign({},r,{users:Object(i.a)(n.map((function(e){return t[e]})))})}return e}))},l=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t={}),e.reduce((function(e,n){var r=n.user_id,a=t[r]||{id_str:r};return e[r]=Object.assign({},n,{user:a}),e}),{})},d=function(e,t){var n=t.entries;return(t.entryIdsByConversationId[e]||[]).map((function(e){return n[e]&&n[e].data})).filter(Boolean)},u=function(e,t,n){void 0===t&&(t=s);var r=e.conversation_id,i=e.participants,o=a()(e,["conversation_id","participants"]);return Object.assign({conversation_id:r},o,{entries:t.entryIdsByConversationId[r]||[],participants:l(i,n)})},p=function(e,t,n){var r=e.conversation_id,i=e.participants,o=e.social_proof,s=a()(e,["conversation_id","participants","social_proof"]);return Object.assign({conversation_id:r},s,{entries:d(r,t),participants:l(i,n)},o?{social_proof:c(o,n)}:{})}},COQJ:function(e,t,n){"use strict";n("IAdD"),t.__esModule=!0,t.default=void 0;var r=o(n("7DT3")),a=o(n("ERkP")),i=o(n("OkZJ"));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e){return void 0===e&&(e={}),(0,r.default)("svg",Object.assign({},e,{style:[i.default.root,e.style],viewBox:"0 0 24 24"}),a.default.createElement("g",null,a.default.createElement("path",{d:"M22.436 16.92H19.76v-2.673c0-.415-.335-.75-.75-.75s-.75.335-.75.75v2.674h-2.676c-.413 0-.75.337-.75.75s.337.75.75.75h2.677v2.677c0 .413.337.75.75.75s.75-.337.75-.75V18.42h2.676c.414 0 .75-.337.75-.75s-.336-.75-.75-.75z"}),a.default.createElement("path",{d:"M11.088 21.214c-2.61-.046-10.064-6.778-10.064-13.157 0-3.066 2.525-5.755 5.404-5.755 2.29 0 3.83 1.582 4.646 2.73.816-1.148 2.357-2.73 4.646-2.73 2.878 0 5.403 2.69 5.403 5.755 0 1.13-.232 2.323-.69 3.545-.145.39-.58.584-.966.44-.388-.146-.584-.58-.438-.966.394-1.053.594-2.07.594-3.02 0-2.266-1.824-4.254-3.903-4.254-2.525 0-3.94 2.937-3.952 2.966-.23.562-1.155.562-1.387 0-.01-.03-1.425-2.966-3.952-2.966-2.08 0-3.904 1.988-3.904 4.255 0 5.76 7.076 11.63 8.563 11.657.168-.003.764-.195 1.758-.892.343-.238.81-.154 1.045.184.237.34.155.808-.184 1.045-1.085.76-1.966 1.153-2.618 1.164z"})))};s.metadata={height:24,width:24};var c=s;t.default=c},GSsg:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("yH/f");var r=n("B5iK"),a=function(){function e(e,t){void 0===t&&(t=Object.freeze({}));var n=t,a=n.interval,i=void 0===a?6e4:a,o=n.burstInterval,s=void 0===o?3e3:o,c=n.burstDuration,l=void 0===c?3e5:c;this.pollTimer=new r.b(i).interval(e),this.burstTimer=new r.a(this.pollTimer,s,l)}var t=e.prototype;return t.start=function(e){return this.pollTimer.start(),e&&this.burstTimer.requestBurst(),this},t.stop=function(){return this.burstTimer.stopBurst(),this.pollTimer.stop(),this},t.restart=function(){return this.stop(),this.start(),this},e}()},H4nC:function(e,t,n){"use strict";var r=n("ERkP"),a=n("3XMw"),i=n.n(a),o=n("3xO4"),s=n.n(o),c=n("rHpw"),l=n("t62R"),d=c.a.create((function(e){return{root:{paddingBottom:e.spaces.medium}}})),u=i.a.d84b485d,p=i.a.be0c83d7;t.a=function(e){var t=e.entry,n=e.isCompact,a="follow"===t.reason?u:p;return n?r.createElement(l.c,{color:"deepGray"},a):r.createElement(s.a,{style:d.root},r.createElement(l.c,{align:"center",color:"deepGray",size:"small"},a))}},"I2k/":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("k49u"),a=n("lRnM"),i=n("LVU8"),o=function(e){var t;return(t={})[r.a.ClientNotPermitted]={customAction:function(){return Object(i.d)("/messages",{statusCode:401}),Object(a.s)(e)}},t}},J2UM:function(e,t,n){"use strict";var r=n("0JOx");t.a=function(){return Object(r.h)().then((function(e){return e.inputDetect}))}},"K2+g":function(e,t,n){"use strict";n("IAdD"),t.__esModule=!0,t.default=void 0;var r=o(n("7DT3")),a=o(n("ERkP")),i=o(n("OkZJ"));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e){return void 0===e&&(e={}),(0,r.default)("svg",Object.assign({},e,{style:[i.default.root,e.style],viewBox:"0 0 24 24"}),a.default.createElement("g",null,a.default.createElement("path",{d:"M20.746 5.236h-3.75V4.25c0-1.24-1.01-2.25-2.25-2.25h-5.5c-1.24 0-2.25 1.01-2.25 2.25v.986h-3.75c-.414 0-.75.336-.75.75s.336.75.75.75h.368l1.583 13.262c.216 1.193 1.31 2.027 2.658 2.027h8.282c1.35 0 2.442-.834 2.664-2.072l1.577-13.217h.368c.414 0 .75-.336.75-.75s-.335-.75-.75-.75zM8.496 4.25c0-.413.337-.75.75-.75h5.5c.413 0 .75.337.75.75v.986h-7V4.25zm8.822 15.48c-.1.55-.664.795-1.18.795H7.854c-.517 0-1.083-.246-1.175-.75L5.126 6.735h13.74L17.32 19.732z"}),a.default.createElement("path",{d:"M10 17.75c.414 0 .75-.336.75-.75v-7c0-.414-.336-.75-.75-.75s-.75.336-.75.75v7c0 .414.336.75.75.75zm4 0c.414 0 .75-.336.75-.75v-7c0-.414-.336-.75-.75-.75s-.75.336-.75.75v7c0 .414.336.75.75.75z"})))};s.metadata={height:24,width:24};var c=s;t.default=c},MMRb:function(e,t,n){"use strict";n.r(t);var r=n("9OUN"),a=n("lRnM"),i=n("uKEd"),o=n("AQ79");n.d(t,"GLOBAL_STATE_KEY",(function(){return o.a}));var s,c=n("xPna"),l=n("Ssj5"),d=n("xCUF"),u=n("aWyx");n.d(t,"CONVERSATION_TYPE",(function(){return u.a})),n.d(t,"ENTRY_TYPE",(function(){return u.b})),n.d(t,"PAGINATION_STATUS",(function(){return u.c})),n.d(t,"addParticipants",(function(){return a.d})),n.d(t,"selectConversation",(function(){return a.t})),n.d(t,"selectConversationAvatarMediaId",(function(){return a.u})),n.d(t,"selectConversationFetchStatus",(function(){return a.x})),n.d(t,"selectConversationIsLoaded",(function(){return a.y})),n.d(t,"selectConversationIsRead",(function(){return a.z})),n.d(t,"selectConversationAvatarMediaIsUploading",(function(){return a.v})),n.d(t,"selectConversationAvatarMediaUploadProgress",(function(){return a.w})),n.d(t,"selectConversations",(function(){return a.B})),n.d(t,"selectEntries",(function(){return i.l})),n.d(t,"selectEntriesForConversation",(function(){return i.m})),n.d(t,"selectEntry",(function(){return i.n})),n.d(t,"selectInbox",(function(){return c.p})),n.d(t,"selectFetchStatus",(function(){return c.o})),n.d(t,"selectInboxIsLoaded",(function(){return c.q})),n.d(t,"selectIsLoadingTop",(function(){return c.r})),n.d(t,"selectUnreadCount",(function(){return c.t})),n.d(t,"selectUntrustedCursor",(function(){return c.v})),n.d(t,"selectUntrustedUnreadCount",(function(){return c.y})),n.d(t,"selectUntrustedConversationCount",(function(){return c.u})),n.d(t,"selectUntrustedLowQualityCursor",(function(){return c.x})),n.d(t,"selectUntrustedLowQualityConversationCount",(function(){return c.w})),n.d(t,"selectPoppedOutConversationId",(function(){return c.s})),n.d(t,"selectDrawerVisibility",(function(){return c.n})),n.d(t,"selectDrawerExperimentEnabled",(function(){return c.m})),n.d(t,"selectUpdates",(function(){return d.e})),n.d(t,"acceptConversation",(function(){return a.a})),n.d(t,"addAvatarMedia",(function(){return a.b})),n.d(t,"addWelcomeMessageToConversation",(function(){return a.e})),n.d(t,"disableMentionNotifications",(function(){return a.g})),n.d(t,"disableNotifications",(function(){return a.h})),n.d(t,"enableMentionNotifications",(function(){return a.i})),n.d(t,"enableNotifications",(function(){return a.j})),n.d(t,"fetchConversation",(function(){return a.k})),n.d(t,"fetchConversationFromParticipants",(function(){return a.l})),n.d(t,"fetchConversationIfNeeded",(function(){return a.n})),n.d(t,"fetchConversationHistory",(function(){return a.m})),n.d(t,"leaveConversation",(function(){return a.o})),n.d(t,"markAllAsRead",(function(){return a.p})),n.d(t,"markConversationRead",(function(){return a.q})),n.d(t,"removeAvatarMedia",(function(){return a.r})),n.d(t,"removeConversation",(function(){return a.s})),n.d(t,"setConversationAvatar",(function(){return a.C})),n.d(t,"toggleNotifications",(function(){return a.D})),n.d(t,"updateConversationReadState",(function(){return a.I})),n.d(t,"updateConversationAvatar",(function(){return a.E})),n.d(t,"updateConversationName",(function(){return a.G})),n.d(t,"updateTyping",(function(){return a.J})),n.d(t,"fetchInbox",(function(){return c.d})),n.d(t,"fetchInboxIfNeeded",(function(){return c.e})),n.d(t,"fetchTrustedInboxHistory",(function(){return c.f})),n.d(t,"fetchUntrustedInboxHistory",(function(){return c.g})),n.d(t,"fetchUntrustedLowQualityInboxHistory",(function(){return c.h})),n.d(t,"updateLastSeenEventId",(function(){return c.B})),n.d(t,"updateTrustedLastSeenEventId",(function(){return c.C})),n.d(t,"updateUntrustedLastSeenEventId",(function(){return c.D})),n.d(t,"popOutConversation",(function(){return c.l})),n.d(t,"setDrawerVisibility",(function(){return c.A})),n.d(t,"loadDrawerVisibilityFromPersistence",(function(){return c.k})),n.d(t,"setDrawerExperimentEnabled",(function(){return c.z})),n.d(t,"loadDrawerExperimentFromPersistence",(function(){return c.j})),n.d(t,"deleteEntry",(function(){return i.f})),n.d(t,"markSpamStatus",(function(){return i.h})),n.d(t,"removeEntry",(function(){return i.j})),n.d(t,"fetchUpdates",(function(){return d.b})),n.d(t,"fetchUpdatesIfNeeded",(function(){return d.d}));var p=Object(r.c)({conversations:a.f,entries:i.e,inbox:c.c,updates:d.a});l.a.register(((s={})[o.a]=p,s)),t.default=p},OhSZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));n("z84I"),n("ho0z");var r=n("ERkP"),a=n("aWyx"),i=n("XnpN"),o=n("jV+4"),s=n("t62R"),c=n("p9G8"),l=function(e){return void 0===e&&(e=[]),e.map((function(e){return e.data}))},d=function(e){var t=e.conversation,n=e.newConversationParticipants,r=e.perspective;if(t)return t.type===a.a.ONE_TO_ONE?Object(i.a)(t,r).map((function(e){return e.user}))[0].name:Object(c.a)(t,r);var o=l(n);return Object(c.b)(o,r)};t.b=function(e){var t=e.conversation,n=e.newConversationParticipants,d=e.perspective,u=e.titleWeight,p=void 0===u?"bold":u,m=e.textColor,f=void 0===m?"normal":m,h=e.withScreenName,v=void 0===h||h;if(t){if(t.type===a.a.ONE_TO_ONE){var g=Object(i.a)(t,d).map((function(e){return e.user}))[0];return r.createElement(o.a,{color:f,isProtected:g.protected,isVerified:g.verified,name:g.name,screenName:g.screen_name,weight:p,withLink:!1,withScreenName:v})}return r.createElement(s.c,{color:f,numberOfLines:1,weight:p},Object(c.a)(t,d))}var b=l(n);return r.createElement(s.c,{color:f,numberOfLines:1,weight:p},Object(c.b)(b,d))}},Oi4X:function(e,t,n){"use strict";n("lTEL"),n("z84I"),n("IAdD"),n("+KXO"),n("7x/C"),n("JtPf"),n("Qavd"),n("KqXw"),n("MvUL"),n("kYxP");var r,a=n("1Pcy"),i=n.n(a),o=n("W/Kd"),s=n.n(o),c=n("KEM+"),l=n.n(c),d=n("ERkP"),u=n("0JOx"),p=n("zh9S"),m=n("MMRb"),f=n("VnFT"),h=n("RqPI"),v=n("1YZw"),g=n("oEGd"),b=n("0KEI"),_=n("hqKg"),y=n("kGix"),C=n("Myq3"),E=n("AQOc"),S=n("UhuB"),x=n("pNZL"),R=n("G6rE"),w=n("P1r1"),I=n("X/yg"),A=function(e,t){return t.conversationId},O=Object(_.createSelector)(m.selectFetchStatus,(function(e,t){return m.selectConversationFetchStatus(e,A(0,t))}),(function(e,t){return e===y.a.LOADED?t:e})),T=Object(_.createSelector)((function(e,t){return m.selectEntriesForConversation(e,A(0,t))}),h.g,(function(e,t){return t?function(e,t){var n=Object(C.a)(e,(function(e){return!!e.message_data&&(e.message_data&&e.message_data.recipient_id===t)}));return n&&n.message_data&&n.message_data.quick_reply&&n.message_data.quick_reply&&"options"===n.message_data.quick_reply.type?n.message_data.quick_reply:void 0}(e,t):void 0})),k=Object(_.createSelector)((function(e,t){return m.selectConversation(e,A(0,t))}),m.selectEntries,I.b,h.g,I.c,I.d,R.e.selectAll,O,(function(e,t){return m.selectConversationIsLoaded(e,A(0,t))}),(function(e,t){return f.g(e,A(0,t))}),(function(e,t){return f.j(e,A(0,t))}),(function(e,t){return f.i(e,A(0,t))}),(function(e,t){return f.k(e,A(0,t))}),(function(e,t){return f.l(e,A(0,t))}),(function(e,t){return f.h(e,A(0,t))}),(function(e,t){return f.m(e,A(0,t))}),w.j,S.j,T,w.l,(function(e,t,n,r,a,i,o,s,c,l,d,u,p,m,f,h,v,g,b,_){var y=e&&e.data;return{conversation:y&&Object(E.a)(y,t,o),dataSaverMode:v,draftText:h,dtabBarInfo:_,fetchStatus:s,gifMetadata:f,isDmReceiptSettingEnabled:g,isLoaded:c,cardUrl:l,isNewGroupConversation:n,isUploading:d,media:u,mediaMetadata:p,mediaUploadProgress:m,newConversationParticipants:a,perspective:r,quickReplyOptions:b,tweetAttachment:i}})),M=function(e){return function(){return f.b(e)}},L=function(e){return function(t){return f.c(e,t)}},F=Object(g.d)(k,(function(e){return{acceptConversation:m.acceptConversation,addMedia:(t=e.conversationId,function(e,n){return f.a(t,e,n)}),saveText:f.f,addToast:v.b,addWelcomeMessageToConversation:m.addWelcomeMessageToConversation,cancelUpload:M(e.conversationId),createLocalApiErrorHandler:Object(b.d)("DIRECT_MESSAGES_CONVERSATION"),fetchConversationHistory:m.fetchConversationHistory,fetchConversationIfNeeded:m.fetchConversationIfNeeded,fetchInboxIfNeeded:m.fetchInboxIfNeeded,fetchUpdatesIfNeeded:m.fetchUpdatesIfNeeded,googleAnalyticsPageView:p.a,leaveConversation:m.leaveConversation,removeMedia:L(e.conversationId),removeText:f.d,scribeAction:p.c,scribePageImpression:p.d,sendMessage:f.n,updateConversationReadState:m.updateConversationReadState,updateTweetDetailNav:x.b,updateTyping:m.updateTyping,removeConversation:m.removeConversation,popOutConversation:m.popOutConversation};var t})),B=n("7JQg"),P=n("I2k/"),D=n("n+Zb"),j=(n("6/0d"),n("IRWI")),N=n("VPAj"),W=function(e,t){return e.getForItem(t).doesIntersectWith(e.getForViewport())},U=function(e){return e.getForList().getBottom()-e.getForViewport().getBottom()},H=function(e){var t=e.isOwnMessage,n=e.typingIndicatorId,r=function(e){return Object(C.a)(e.getList(),(function(e){return e.id!==n}))};return Object.assign({},j.a,{initialScrollHeadroom:Object(N.a)(0),scrollHeadroom:Object(N.a)(0),offsetCorrection:function(e,a){var i=r(e),o=r(a),s=o&&(!i||i.id!==o.id),c=o&&t(o.data.data),l=i&&W(e,i.id);return s&&(c||l)||l&&function(e,t){var r=e.getForItem(n),a=t.getForItem(n);return!r||a&&a.getHeight()>r.getHeight()}(e,a)?Math.max(0,U(a)):j.a.offsetCorrection(e,a)}})},z=(n("KOtZ"),n("aWyx")),G=function(e,t){return{entry:{id:t,time:"",type:e},isActive:!1,isRapidFire:!1,isFirstRapidFire:!1,isLastRapidFire:!1,type:e}},q=G(z.b.CONVERSATION_PROFILE_INFO_HEADER,"conversationProfileInfoHeader"),V=G(z.b.TYPING_INDICATOR,"typingIndicator"),K=G(z.b.READ_ONLY_INDICATOR,"readOnlyIndicator"),Q=(n("Blm6"),n("b9JY")),Y=function(e,t){if(e&&e.message_data&&t&&t.message_data&&Object(Q.b)(e)&&Object(Q.b)(t)){var n=e.message_data,r=n.sender_id,a=n.time,i=t.message_data,o=i.sender_id,s=i.time,c=parseInt(s,10)-parseInt(a,10);return r===o&&c>=0&&c<=6e4}return!1},X=n("jat/"),J=(n("1t7P"),n("jQ/y"),n("ho0z"),n("uFXj"),n("XnpN")),Z=n("v6aA"),$=n("LhSm"),ee=n("I4+6"),te=n("rHpw"),ne=n("cm6r"),re=n("jV+4"),ae=n("pBrB"),ie=n("wCd/"),oe=function(e,t){var n=Object(J.a)(e,t).map((function(e){return e.user})),r=n&&n[0];return{userDescription:r&&r.description,userEntities:r&&r.entities,userFollowerCount:r&&r.followers_count,userFriendsCount:r&&r.friends_count,userIdStr:r&&r.id_str,userJoinDate:r&&r.created_at,userName:r&&r.name,userScreenName:r&&r.screen_name,userIsVerified:r&&r.verified}},se=te.a.create((function(e){return{root:{flexDirection:"column",alignItems:"center",marginBottom:e.spaces.small,paddingVertical:e.spaces.medium,paddingHorizontal:e.spaces.small,borderRadius:e.borderRadii.small},profileInfoItemMargin:{marginBottom:e.spaces.xxSmall},borderBottom:{borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid"}}})),ce=function(e){var t=e.conversation,n=e.withBottomBorder,r=void 0===n||n,a=d.useContext(Z.a).loggedInUserId;if(!t)return null;var i=oe(t,a||""),o=i.userDescription,s=i.userEntities,c=i.userFollowerCount,l=i.userFriendsCount,u=i.userIdStr,p=i.userJoinDate,m=i.userName,f=i.userScreenName,h=i.userIsVerified,v=!!(m&&f&&(c&&l||p)),g=ee.a.generate({color:te.a.theme.colors.text,backgroundColor:te.a.theme.colors.transparent,customFocusBackgroundColor:te.a.theme.colors.faintGray,customHoverBackgroundColor:te.a.theme.colors.faintGray,customPressedBackgroundColor:te.a.theme.colors.activeFaintGray});return d.createElement(ne.a,{interactiveStyles:g,link:{pathname:"https://twitter.com/"+(f||"")},style:[se.root,r&&v&&se.borderBottom]},d.createElement(re.a,{isVerified:h,name:m,screenName:f,style:se.profileInfoItemMargin,weight:"bold",withHoverCard:!0,withLink:!0}),o&&s&&u?d.createElement(ae.a,{description:o,entities:s,style:se.profileInfoItemMargin,userId:u}):null,c&&l?d.createElement(ie.a,{followersCount:c,friendsCount:l,screenName:f||"",style:se.profileInfoItemMargin,withLink:!1}):null,p?d.createElement($.a,{joinDate:p}):null)},le=(n("LW0h"),n("vrRf"),n("g54k")),de=n("aA19"),ue=n("mN6z"),pe=(n("AxOO"),n("c2p2")),me=n("3xO4"),fe=n.n(me),he=n("t62R"),ve=n("zQEV"),ge=(n("aWzz"),function(e){function t(){return e.apply(this,arguments)||this}s()(t,e);var n=t.prototype;return n.shouldComponentUpdate=function(e){return!Object(ue.a)(this.props,e)},n.render=function(){var e=this.props,t=e.conversation,n=e.entry,r=e.entryType,a=e.perspective,i=e.users,o=Object(ve.a)(n,r,a,i);return d.createElement(fe.a,{style:be.root},r===z.b.CONVERSATION_AVATAR_UPDATE&&this._isValidImageSource(n.conversation_avatar_image_https)?d.createElement(fe.a,{style:be.conversationAvatarContainer},d.createElement(de.a,{conversation:t,perspective:a})):null,d.createElement(he.c,{align:"center",color:"deepGray",size:"small"},o),r===z.b.JOIN_CONVERSATION?d.createElement(fe.a,{style:be.joinConversationDetails},d.createElement(he.c,{align:"center",color:"deepGray",size:"small"},this._getParticipantsFromEntryText()),d.createElement(pe.a,{align:"center",maxItems:20,style:be.userAvatarList,users:this._getParticipantsFromEntry()})):null)},n._isValidImageSource=function(e){return e&&""!==e&&e.indexOf("MEDIA_NOT_FOUND")<0},n._getParticipantsFromEntry=function(){var e=this.props,t=e.entry,n=e.perspective,r=e.users;return t.participants?t.participants.filter((function(e){var t=e.user_id;return n!==t})).map((function(e){var t=e.user_id;return r[t]})).filter(Boolean):[]},n._getParticipantsFromEntryText=function(){var e=this.props.conversation.conversation_id,t=this._getParticipantsFromEntry().length;return Object(ve.b)(t,e)},t}(d.Component)),be=te.a.create((function(e){return{conversationAvatarContainer:{alignSelf:"center",height:e.spaces.jumbo,marginBottom:e.spaces.xSmall,width:e.spaces.jumbo},joinConversationDetails:{marginTop:e.spaces.xxSmall},root:{paddingBottom:e.spaces.medium},userAvatarList:{marginTop:e.spaces.xxSmall}}})),_e=Object(le.a)(ge),ye=(n("2G9S"),{scribeAction:p.c}),Ce=Object(_.createSelector)((function(e,t){return R.e.select(e,t.senderId)}),w.k,(function(e,t){return{user:e,displaySensitiveMedia:t}})),Ee=Object(g.g)(Ce,ye),Se=(n("jwue"),n("+oxZ"),{addToast:v.b,createLocalApiErrorHandler:Object(b.d)("DIRECT_MESSAGES_OVERFLOW_ACTIONS"),deleteEntry:m.deleteEntry}),xe=Object(g.b)(Se),Re=n("k49u"),we=n("LVU8"),Ie=n("3XMw"),Ae=n.n(Ie),Oe=Ae.a.f58dff33,Te=Ae.a.ad5a8e8e,ke=((r={})[Re.a.MissingParameter]={toast:Object(we.a)(Oe)},r[Re.a.DirectMessageDestroyPermissionsError]={toast:{text:Te}},r.showToast=!0,r),Me=(n("jQ3i"),n("x4t0"),n("xCUF")),Le=n("uKEd"),Fe=[],Be=Object(_.createSelector)((function(e){return Object(Le.l)(e).entries}),(function(e,t){return Object(Le.p)(e,t.entry.id)||Fe}),(function(e,t){return t.perspective}),(function(e,t,n){return{selectedReactions:t.filter((function(t){var r=e[t]&&e[t].data;return r&&r.sender_id===n})).map((function(t){return e[t].data.reaction_key}))}})),Pe={createReaction:Le.d,createLocalApiErrorHandler:Object(b.d)("DIRECT_MESSAGES_REACTIONS_POPOVER"),fetchUpdatesIfNeeded:Me.d,removeReaction:Le.k},De=Object(g.g)(Be,Pe),je=n("RhWx"),Ne=n.n(je),We=n("33Kz"),Ue=n("wTX1"),He=function(e){var t=e.accessible,n=e.accessibilityLabelFormatter,r=e.count,a=e.emojiSize,i=e.emotion,o=e.enableHoverStyle,s=e.onPress,c=e.style,l=Object(We.b)(i),u=n&&l?n({emoji:l,count:r}):void 0,p=ee.a.generate({backgroundColor:te.a.theme.colors.fadedGray,color:te.a.theme.colors.deepGray});return d.createElement(ne.a,{accessibilityLabel:u,accessible:t,interactiveStyles:o?p:null,onPress:s,style:[ze.container].concat(Ne()(c||[]))},d.createElement(he.c,{size:a,style:ze.unsetLineHeight},l),r&&d.createElement(Ue.a,{color:"deepGray",containerStyle:ze.count,count:r,size:"xSmall"},r))},ze=te.a.create((function(e){return{container:{flexDirection:"row"},count:{alignSelf:"center",minWidth:e.spaces.small,paddingLeft:e.spaces.micro},unsetLineHeight:{lineHeight:"unset"}}})),Ge=n("Irs7"),qe=Ae.a.ca7a2214,Ve=Ae.a.fc0e94b7,Ke=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,l()(i()(t),"_handleReactionScribing",(function(e,n){var r=n?"delete_reaction":"create_reaction";t.props.analytics.scribe({section:"twitter_service",component:"direct_messages",element:r,action:"success",data:{reaction_emotion:e}})})),l()(i()(t),"_reactionClickHandler",(function(e,n){return function(){var r=t.props,a=r.createReaction,i=r.createLocalApiErrorHandler,o=r.dismiss,s=r.fetchUpdatesIfNeeded,c=r.removeReaction,l=r.entry,d=r.perspective,u={reaction_key:e,conversation_id:l.conversation_id,dm_id:l.id,perspective:d};(n?c:a)(u).then(t._handleReactionScribing(e,n)).then((function(){return s()})).catch(i()),o()}})),t}return s()(t,e),t.prototype.render=function(){var e=this,t=this.props.selectedReactions,n=Object(We.a)().map((function(n){var r=t.includes(n);return d.createElement(He,{accessibilityLabelFormatter:r?qe:Ve,accessible:!0,emojiSize:"xLarge",emotion:n,enableHoverStyle:!0,key:n,onPress:e._reactionClickHandler(n,r),style:[Ye.reaction,r&&Ye.selectedReaction]})}));return d.createElement(fe.a,{style:Ye.reactions},n)},t}(d.Component),Qe=Object(Ge.a)(De(Ke)),Ye=te.a.create((function(e){return{reactions:{cursor:"pointer",flexDirection:"row",padding:e.spaces.xSmall},reaction:{borderRadius:e.borderRadii.medium,padding:e.spaces.xxSmall},selectedReaction:{backgroundColor:e.colors.fadedGray}}})),Xe=n("OiMc"),Je=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,l()(i()(t),"_renderDMReactionPickerContent",(function(e){var n=t.props,r=n.entry,a=n.perspective;return d.createElement(Qe,{dismiss:e,entry:r,perspective:a})})),t}return s()(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=e.onDismiss;return d.createElement(Xe.a,{enableEnterKeyToggle:!0,onDismiss:n,preferredVerticalOrientation:"up",renderContent:this._renderDMReactionPickerContent,withArrow:!0},t)},t}(d.Component),Ze=n("O/fU"),$e=n.n(Ze),et=n("COQJ"),tt=n.n(et),nt=n("/aF9"),rt=n.n(nt),at=n("+0FD"),it=n.n(at),ot=n("K2+g"),st=n.n(ot),ct=n("fz3c"),lt=n("mjJ+"),dt=n("Q0VY"),ut=n("eb3s"),pt=n("/yvb"),mt=n("ZToW"),ft=n("8aq1"),ht=n.n(ft),vt=n("jdj2"),gt=n.n(vt),bt=(n("hBpG"),n("lZm3"),function(e,t){if(null==e)return!1;var n=t||[0,0],r=n[0],a=n[1];return!((0===r||1===r)&&e.length===a)}),_t=function(e){var t=e.message_data;if(!t)return!1;var n=t.attachment;if(!n)return!0;if(n.sticker)return!1;var r=n.tweet||n.photo||n.animated_gif||n.video||void 0;if(r)return bt(t.text,r.indices);if(n.card){var a,i=((null===(a=t.entities)||void 0===a?void 0:a.urls)||[]).find((function(e){return e.url===n.card}));return bt(t.text,i&&i.indices)}return!0},yt=function(e){var t,n=null==e||null===(t=e.message_data)||void 0===t?void 0:t.attachment;return!(!n||!(n.card||n.tweet||n.photo||n.animated_gif||n.video))},Ct=function(e,t,n){return{compositeRendered:e?void 0!==t&&void 0!==n:void 0!==t,isTextSquared:void 0!==t&&void 0!==n&&(n===t||n<=t-(r=1.25,r*parseFloat(te.a.theme.fontSizes.normal))),isAttachmentSquared:void 0!==n&&void 0!==t&&n===t};var r},Et=Ae.a.ba60339a,St=Ae.a.j4bfee22,xt=Ae.a.d96cf7cd,Rt=Ae.a.faddd3a2,wt=Ae.a.eb497e08,It=Ae.a.b170974a,At=Ae.a.i202bd22,Ot=Ae.a.f2e5491a,Tt=Ae.a.f88553c8,kt=function(e){function t(t){var n;return n=e.call(this,t)||this,l()(i()(n),"_renderOverflowMenu",(function(e){var t=n.props,r=t.entry,a=t.isSent,i=t.analytics.contextualScribeNamespace,o=[{text:Et,Icon:st.a,isEmphasized:!0,onClick:n._handleShowDeleteConfirmation(e)}];return a||o.push({text:At,Icon:$e.a,link:{pathname:"/i/report/"+ct.a.DMMessage+"/"+r.id,state:{clientReferer:window.location.pathname,conversationId:r.conversation_id,scribeNamespace:i}}}),ht.a.isAvailable()&&o.push({text:Ot,Icon:it.a,onClick:n._handleCopyMessageText}),d.createElement(lt.a,{items:o,onCloseRequested:n._handleHideActionsAndMenus(e),preferredHorizontalOrientation:"right"})})),l()(i()(n),"_handleCopyMessageText",(function(e){var t=n.props.addToast,r=n._replaceMessageUrls();r&&(ht.a.setString(r),t({text:Tt})),e&&e()})),l()(i()(n),"_handleSetActionsActive",(function(){var e=n.props.setShouldFreezeUpdates;n.setState({actionsAreActive:!0}),e(!0)})),l()(i()(n),"_handleDelete",(function(){var e=n.props,t=e.createLocalApiErrorHandler,r=e.deleteEntry,a=e.entry;r({conversationId:a.conversation_id,id:a.id}).catch(t(ke))})),l()(i()(n),"_handleHideDeleteConfirmation",(function(){n.setState({showDeleteConfirmation:!1})})),l()(i()(n),"_handleHideActionsAndMenus",(function(e){return function(){var t=n.props.setShouldFreezeUpdates;e&&e(),n.setState({actionsAreActive:!1}),t(!1)}})),l()(i()(n),"_handlePressReactionPickerButton",(function(){var e=n.props,t=e.analytics,r=e.entry;t.scribe({component:"reaction_button",element:Object(I.a)(r),action:"click"}),n._handleSetActionsActive()})),l()(i()(n),"_handleShowDeleteConfirmation",(function(e){return function(){var t=n.props.setShouldFreezeUpdates;e(),n.setState({actionsAreActive:!1,showDeleteConfirmation:!0}),t(!1)}})),l()(i()(n),"_replaceMessageUrls",(function(){var e=n.props.entry,t=e&&e.message_data&&e.message_data.entities,r=e&&e.message_data&&e.message_data.text||"";return dt.a.tweetTextParts(r,[0,r.length],t).forEach((function(e){"url"===e.entityType&&(r=r.replace(e.url,e.expandedUrl))})),r})),n.state={actionsAreActive:!1,showDeleteConfirmation:!1},n._hasMedia=yt(n.props.entry),n._isNarrow=gt.a.get("screen").width<te.a.theme.breakpoints.xSmall,n}s()(t,e);var n=t.prototype;return n.render=function(){var e=this.props,t=e.isSent,n=e.shouldShowReactionButton,r=this._areActionsVisible();return d.createElement(fe.a,{pointerEvents:r?"auto":"none",style:[Lt.messageActions,t?Lt.messageActionsLeft:Lt.messageActionsRight,r?Lt.visible:Lt.invisible,this._isNarrow&&(this._hasMedia?Lt.messageActionsMediaNarrow:Lt.messageActionsNarrow)]},n&&this._renderReactionButton(),this._renderOverflowButton(),this._renderDeleteConfirmation())},n._renderDeleteConfirmation=function(){return this.state.showDeleteConfirmation?d.createElement(ut.a,{confirmButtonLabel:xt,confirmButtonType:"destructive",headline:St,onCancel:this._handleHideDeleteConfirmation,onConfirm:this._handleDelete,text:Rt}):null},n._renderReactionButton=function(){var e=this.props,t=e.entry,n=e.perspective,r=this.state.actionsAreActive;return d.createElement(Je,{entry:t,onDismiss:this._handleHideActionsAndMenus(),perspective:n},d.createElement(pt.a,{accessibilityLabel:It,"aria-expanded":r?"true":"false","aria-haspopup":"true",icon:Ft,onPress:this._handlePressReactionPickerButton,size:this._isNarrow?"normalCompact":"normal",type:"text"}))},n._renderOverflowButton=function(){return d.createElement(pt.a,{accessibilityLabel:wt,icon:Bt,onPress:this._handleSetActionsActive,renderMenu:this._renderOverflowMenu,size:this._isNarrow?"normalCompact":"normal",type:"text"})},n._areActionsVisible=function(){var e,t=this.props,n=t.containerIsActive,r=t.containerIsFocused,a=t.containerIsHovered,i=t.isDraft,o=this.state.actionsAreActive,s=(e=this.props.entry,!_t(e)&&yt(e)&&!mt.a.isEnabled);return!i&&(s||n&&!mt.a.isEnabled||r||a||o)},t}(d.Component),Mt=Object(Ge.a)(xe(kt)),Lt=te.a.create((function(e){return{invisible:{opacity:0},messageActions:{alignSelf:"flex-end",flexDirection:"row"},messageActionsMediaNarrow:{flexDirection:"column"},messageActionsNarrow:{flexShrink:1,flexWrap:"wrap",minWidth:e.spaces.large},messageActionsLeft:{justifyContent:"flex-end",paddingRight:e.spaces.xxSmall,order:-1},messageActionsRight:{justifyContent:"flex-start",paddingLeft:e.spaces.xxSmall,order:1},actionIcon:{color:e.colors.deepGray},visible:{opacity:1}}})),Ft=d.createElement(tt.a,{style:Lt.actionIcon}),Bt=d.createElement(rt.a,{style:Lt.actionIcon}),Pt=(n("6U7i"),n("97Jx")),Dt=n.n(Pt),jt=n("uDfI"),Nt={createLocalApiErrorHandler:Object(b.d)("DIRECT_MESSAGES_CONVERSATION"),removeEntry:m.removeEntry,sendMessage:f.n},Wt=Object(jt.b)(null,Nt),Ut=(n("hCOa"),n("87if"),n("dlmX"),n("m9LP"),[]),Ht=function(e,t){return Object(Le.p)(e,t.entryId)||Ut},zt=function(e){return Object(Le.l)(e).entries},Gt={createLocalApiErrorHandler:Object(b.d)("DIRECT_MESSAGES_REACTIONS")},qt=Object(g.e)((function(){return Object(_.createSelector)(zt,Ht,h.g,(function(e,t,n){var r,a=Object(We.a)({includeInactive:!0}),i=0;return{reactionsWithCounts:t.reduceRight((function(t,o){var s=e[o]&&e[o].data;if(!s)return t;if(!a.includes(s.reaction_key))return t;var c=(t.get(s.reaction_key)||0)+1;return t.set(s.reaction_key,c),(null==s?void 0:s.sender_id)===n&&(r=s.reaction_key),i+=1,t}),new Map),selectedReactionKey:r,totalReactionCount:i}}))}),Gt),Vt=n("E89d"),Kt=(n("vfdX"),n("tQbP"),n("Ee2X"),[]),Qt=function(e,t){return t.entryId},Yt=function(e){return Object(Le.l)(e).entries},Xt=function(e,t){return Object(Le.p)(e,Qt(0,t))||Kt},Jt=function(e,t){return R.e.selectMany(e,function(e,t){return Object(Le.q)(e,Qt(0,t))}(e,t))},Zt={removeReaction:Le.k,fetchUpdatesIfNeeded:Me.d,createLocalApiErrorHandler:Object(b.d)("DIRECT_MESSAGES_REACTION_SUMMARY_CONTEXT")},$t=Object(g.e)((function(){return Object(_.createSelector)(Yt,Xt,h.g,Jt,(function(e,t,n,r){var a=Object(We.a)({includeInactive:!0}),i=[];t.forEach((function(t){var o=e[t]&&e[t].data;if(o&&a.includes(o.reaction_key)){var s=r.find((function(e){return e&&e.id_str===o.sender_id})),c=s&&{avatarUri:s.profile_image_url_https,userId:s.id_str,reactionKey:o.reaction_key,isLoggedInUser:s.id_str===n,screenName:s.screen_name,name:s.name,isProtected:s.protected,isVerified:s.verified,time:o.time};c&&i.push(c)}})),i.sort((function(e,t){return t.time-e.time}));var o=i.findIndex((function(e){return e.userId===n}));return o>-1&&i.push.apply(i,Ne()(i.splice(0,o))),{loggedInUserId:n,usersWithReactions:i}}))}),Zt),en=n("TIdA"),tn=n("oSwX"),nn=n("htQn"),rn=Ae.a.gf5e9ea6,an=Ae.a.a2d48778,on=en.a.createLayoutCache(),sn=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,l()(i()(t),"_handleUndoReaction",(function(e){var n=t.props.onUndoPress;e.stopPropagation(),n()})),t}return s()(t,e),t.prototype.render=function(){var e=this.props,t=e.user,n=e.renderUndo,r=e.withBottomBorder,a=t.avatarUri,i=t.name,o=t.screenName,s=t.isProtected,c=t.isVerified,l=d.createElement(tn.default,{imageLayoutCache:on,screenName:o,size:"xxLarge",uri:a}),u=d.createElement(He,{accessible:!1,emojiSize:"xLarge",emotion:t.reactionKey}),p=d.createElement(re.a,{badgeContext:"content",isProtected:s,isVerified:c,name:i,screenName:o,withHoverCard:!0,withStackedLayout:!0});return d.createElement(nn.a,{link:{pathname:"/"+o,anchorless:!0},style:[cn.root,r&&cn.bottomBorder]},d.createElement(fe.a,{style:cn.reactionColumn},u),d.createElement(fe.a,{style:cn.column},l),d.createElement(fe.a,{style:cn.bodyColumn},d.createElement(fe.a,{style:cn.body},p)),n?d.createElement(fe.a,{style:cn.column},d.createElement(pt.a,{accessibilityLabel:an({emoji:Object(We.b)(t.reactionKey)}),onClick:this._handleUndoReaction,size:"normalCompact",type:"text"},rn)):null)},t}(d.Component),cn=te.a.create((function(e){return{bodyColumn:{flexShrink:1,flexGrow:1,justifyContent:"center",marginHorizontal:e.spaces.xxSmall},body:{alignItems:"center",flexDirection:"row",justifyContent:"space-between"},bottomBorder:{borderBottomColor:e.colors.borderColor,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small},column:{alignItems:"center",justifyContent:"center",marginRight:e.spaces.xxSmall},reactionColumn:{alignItems:"center",justifyContent:"center",marginRight:e.componentDimensions.gutterHorizontal},root:{flexDirection:"row",minHeight:"56px",paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical}}})),ln=sn,dn=n("TnY3"),un=n("cHvH"),pn=n("xKuM"),mn=n("sgih"),fn=Ae.a.b772cd65,hn=Ae.a.c0098d49,vn=Ae.a.j85999eb,gn=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,l()(i()(t),"_renderContent",(function(){return d.createElement(d.Fragment,null,d.createElement(un.a,null,(function(e){var n=e.windowWidth<te.a.theme.breakpoints.medium;return d.createElement(fe.a,null,t._renderAppBar({isSmallScreen:n}),d.createElement(fe.a,{accessibilityLabel:vn,style:bn.container},t._renderUsers()),n?t._renderSmallSheetFooter():null)})))})),l()(i()(t),"_renderAppBar",(function(e){var n=e.isSmallScreen,r=t.props.onClose;return d.createElement(pn.a,{leftControl:n?void 0:d.createElement(Vt.a,{backButtonType:"close",onClick:r}),title:hn,withBottomBorder:!0})})),l()(i()(t),"_renderSmallSheetFooter",(function(){var e=t.props.onClose;return d.createElement(pt.a,{key:"button_done",onPress:e,style:bn.cancelButton,type:"neutral"},fn)})),l()(i()(t),"_renderUsers",(function(){return t.props.usersWithReactions.filter(Boolean).map((function(e,n){return d.createElement(ln,{history:t.props.history,key:e.userId,onUndoPress:t._reactionUndoHandler(e.reactionKey),renderUndo:e.isLoggedInUser,user:e,withBottomBorder:n!==t.props.usersWithReactions.length-1})}))})),l()(i()(t),"_reactionUndoHandler",(function(e){return function(){var n=t.props,r=n.analytics,a=n.conversationId,i=n.fetchUpdatesIfNeeded,o=n.createLocalApiErrorHandler,s=n.entryId,c=n.loggedInUserId,l=n.onClose,d=n.removeReaction,u={reaction_key:e,conversation_id:a,dm_id:s,perspective:c};l(),d(u).then(r.scribe({page:"app",section:"twitter_service",component:"direct_messages",element:"delete_reaction",action:"success",data:{reaction_emotion:e}})).then(i).catch(o())}})),t}s()(t,e);var n=t.prototype;return n.render=function(){var e=this.props.onClose;return d.createElement(mn.a,{accessibilityRole:"menu",allowBackNavigation:!0,enableMaskForDismiss:!0,onMaskClick:e,style:bn.root,type:"bottom",withMask:!0},this._renderContent())},n.componentDidMount=function(){this.props.analytics.scribe({component:"dm_reaction_summary",action:"show"})},t}(d.PureComponent),bn=te.a.create((function(e){return{cancelButton:{marginHorizontal:e.spaces.xSmall,marginVertical:e.spaces.xSmall},container:{overflowY:"scroll",paddingVertical:e.spaces.xSmall,maxHeight:"65vh"},root:{backgroundColor:e.colors.cellBackground,flexGrow:1,flexShrink:1}}})),_n=Object(dn.a)(Object(Ge.a)($t(gn))),yn=n("7nmT"),Cn=n.n(yn),En=Ae.a.h95f9e76,Sn=function(e){function t(t){var n;return n=e.call(this,t)||this,l()(i()(n),"_onSetReactionsNode",(function(e){var t=Cn.a.findDOMNode(e);n._measureWidths(t instanceof window.HTMLElement?t:void 0)})),l()(i()(n),"_renderReactions",(function(e){var t=e.isHovered,r=n.props,a=r.reactionsWithCounts,i=r.selectedReactionKey,o=n.state.emojiSize||"large",s=a.size-1;return Array.from(a,(function(e,n){var r=e[0],a=e[1];return d.createElement(He,{accessible:!0,count:a,emojiSize:o,emotion:r,enableHoverStyle:!1,key:r,style:[n===s&&xn.rightPadding,xn.elementPadding,i===r?xn.selfSelect:null,t&&xn.transparentBorder]})}))})),l()(i()(n),"_renderReactionSummary",(function(e){var t=n.props,r=t.conversationId,a=t.entryId;return d.createElement(_n,{conversationId:r,entryId:a,onClose:e})})),n.state={emojiSize:void 0},n}s()(t,e);var n=t.prototype;return n.render=function(){var e=this.props,t=e.isEndOfDM,n=e.isSent,r=e.totalReactionCount,a=this.state.emojiSize;if(0===r)return null;var i=ee.a.generate({backgroundColor:te.a.theme.colors.fadedGray,color:te.a.theme.colors.deepGray}),o=En({reactionCount:r});return d.createElement(ne.a,{accessibilityLabel:o,accessible:!0,interactiveStyles:i,renderMenu:this._renderReactionSummary,style:[xn.container,t?xn.marginShort:xn.marginLong,n?xn.alignRight:xn.alignLeft,a?xn.visible:xn.invisible],viewRef:this._onSetReactionsNode},this._renderReactions)},n._measureWidths=function(e){var t=e&&e.parentElement,n={emojiSize:"large"};if(t){var r=t.getBoundingClientRect().width,a=(e?e.getBoundingClientRect():{}).width;(void 0===a?0:a)>r&&(n.emojiSize="small")}this.setState(Object.assign({},n))},t}(d.PureComponent),xn=te.a.create((function(e){return{container:{borderRadius:e.borderRadii.infinite,boxSizing:"border-box",display:"inline-flex",flexDirection:"row"},rightPadding:{paddingRight:e.spaces.micro},elementPadding:{borderColor:e.colors.transparent,borderWidth:e.borderWidths.small,paddingBottom:e.spaces.micro,paddingTop:e.spaces.micro,paddingLeft:"calc("+e.spaces.micro+" * 2)"},selfSelect:{borderColor:te.a.theme.colors.fadedGray,borderRadius:e.borderRadii.infinite},alignLeft:{alignSelf:"flex-start"},alignRight:{alignSelf:"flex-end"},invisible:{opacity:0},visible:{opacity:1},marginShort:{marginBottom:e.spaces.xxSmall},marginLong:{marginBottom:e.spaces.xSmall},transparentBorder:{borderColor:e.colors.transparent}}})),Rn=qt(Sn),wn=(n("M+/F"),{listTwo:Ae.a.b781c1ec,listItems:Ae.a.j4bbbbcf,listEnd:Ae.a.i653d8ce});var In=Ae.a.icd0bf34,An=Ae.a.e8bd8fec,On=Ae.a.b2d32fad,Tn=Ae.a.a763d33e,kn=function(e){function t(t){var n;return n=e.call(this,t)||this,l()(i()(n),"_handlePress",(function(e){e.stopPropagation(),n.setState({showFullList:!0})})),n.state={showFullList:!1},n}s()(t,e);var n=t.prototype;return n.render=function(){var e=this.props,t=e.isGroupDM,n=e.isSeenByEveryone,r=e.namesToDisplay;return d.createElement(fe.a,{style:Mn.root},d.createElement(he.c,{align:"right",color:"deepGray",size:"small",style:Mn.seenLabel},this._renderSeenLabel()),!n&&t&&r.length?this._renderNameList():null)},n._renderSeenLabel=function(){var e=this.props,t=e.isGroupDM,n=e.isSeenByEveryone,r=e.namesToDisplay;return n?t?On:In:r.length?Tn({count:r.length}):An},n._renderNameList=function(){var e=this,t=this.props.namesToDisplay,n=!this.state.showFullList&&t.length>10,r=t.length-10,a=function(t){var n=t.namesList,r=t.othersCount;return d.createElement(Ae.a.I18NFormatMessage,{$i18n:"f6464106"},d.createElement(he.c,null,n),d.createElement(he.c,{color:"link",onPress:e._handlePress},Ae.a.d7a0722f({othersCount:r})))};n&&(t=t.slice(0,10));var i=function(e,t){void 0===t&&(t=!1);var n=e.length,r=e[0];switch(n){case 0:return null;case 1:break;case 2:r=wn.listTwo({listItem1:r,listItem2:e[1]});break;default:r=function e(n,r){return 1===n.length?(t?wn.listItems:wn.listEnd)({listItem1:r,listItem2:n[0]}):e(n.slice(1),wn.listItems({listItem1:r,listItem2:n[0]}))}(e.slice(1),r)}return r}(t,n);return d.createElement(he.c,{align:"right",color:"deepGray",size:"small",style:Mn.namesList},n?d.createElement(a,{namesList:i,othersCount:r}):d.createElement(he.c,null,i))},t}(d.PureComponent),Mn=te.a.create((function(e){return{root:{alignItems:"flex-end",width:"calc(100% - "+e.spaces.micro+")"},seenLabel:{cursor:"pointer"},namesList:{marginBottom:e.spaces.micro,whiteSpace:"pre-line"}}})),Ln=kn,Fn=n("t0aI"),Bn=function(e){var t=e.entryId,n=e.participants,r=e.user,a=Object.keys(n),i=Pn({entryId:t,participants:n,user:r});return{namesToDisplay:i,isSeenByEveryone:i.length===a.length-1}},Pn=function(e){var t=e.entryId,n=e.participants,r=e.user;return Object.keys(n).reduce((function(e,a){var i=n[a],o=i.join_conversation_event_id,s=i.last_read_event_id,c=i.user.name,l=a!==r.id_str,d=s&&1!==Object(Fn.a)(t,s),u=!o||1!==Object(Fn.a)(o,t);return l&&d&&u&&e.push(c),e}),[])},Dn=n("5/+E"),jn=n.n(Dn),Nn=n("21zW"),Wn=n("gmpV"),Un=Ae.a.fad48ee9,Hn=Ae.a.ba60339a,zn=Ae.a.d338f53e,Gn=Ae.a.ae7d7a24,qn=Ae.a.d725a288,Vn=Ae.a.bbe74f3f,Kn=Ae.a.h0e4cdf4,Qn=Ae.a.bfbc051c,Yn=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,l()(i()(t),"_handleRemove",(function(){var e=t.props,n=e.conversationId;(0,e.removeEntry)(n,null,{id:e.entryId})})),l()(i()(t),"_handleTryAgain",(function(){var e=t.props,n=e.sendMessage,r=e.conversationId,a=e.entryText;n({senderId:e.user.id_str,conversationId:r,text:a}),t._handleRemove()})),t}s()(t,e);var n=t.prototype;return n.render=function(){var e=this.props.isSent,t=this._renderSending(),n=this._renderError(),r=this._renderTimestamp(),a=this._renderReadReceipt(),i=this._renderSentCheckmark(),o=this._renderReactions(),s=r||a||i;return(t||n||o||s)&&d.createElement(fe.a,{style:[Xn.root,e&&Xn.sentMessage]},t,n,o,s?d.createElement(fe.a,{style:e&&Xn.sentContainer},d.createElement(fe.a,{style:e&&Xn.groupedItems},r,i),a):null)},n._renderError=function(){return this.props.isError&&d.createElement(fe.a,null,d.createElement(he.c,{align:"right",color:"deepGray",size:"small"},Gn),d.createElement(fe.a,{style:Xn.groupedItems},d.createElement(he.c,{accessibilityRole:"button",color:"red",onPress:this._handleRemove,size:"small",withInteractiveStyling:!0},Hn),d.createElement(Nn.a,null),d.createElement(he.c,{accessibilityRole:"button",color:"primary",onPress:this._handleTryAgain,size:"small",withInteractiveStyling:!0},zn)))},n._renderReactions=function(){var e=this.props,t=e.conversationId,n=e.entryId,r=e.isLastRapidFire,a=e.isRapidFire,i=e.isSent,o=!a||r;return d.createElement(fe.a,{style:!i&&Xn.footerPadderWithAvatar},d.createElement(Rn,{conversationId:t,entryId:n,isEndOfDM:o,isSent:i}))},n._renderReadReceipt=function(){var e=this.props,t=e.entryId,n=e.isActive,r=e.isDraft,a=e.isError,i=e.isGroupDM,o=e.isSent,s=e.participants,c=e.user;return n&&o&&!r&&!a?d.createElement(Ln,Dt()({isGroupDM:i},Bn({entryId:t,participants:s,user:c}))):null},n._renderSending=function(){var e=this.props,t=e.isDraft,n=e.isError;return t&&!n&&d.createElement(he.c,{align:"right",color:"deepGray",size:"small"},Un)},n._renderSentCheckmark=function(){var e=this.props,t=e.entryId,n=e.isDraft,r=e.isError,a=e.isLastRapidFire,i=e.isRapidFire,o=e.isSent,s=e.participants,c=e.user,l=Bn({entryId:t,participants:s,user:c}).isSeenByEveryone;return!o||n||r||i&&!a?null:d.createElement(he.c,{color:l?"primary":"deepGray",style:Xn.checkmarkContainer},d.createElement(jn.a,{style:Xn.checkmark}))},n._renderTimestamp=function(){var e=this.props,t=e.entryTime,n=e.isDraft,r=e.isGroupDM,a=e.isError,i=e.isLastRapidFire,o=e.isRapidFire,s=e.isSent,c=e.user.name;if(n||a||o&&!i)return null;var l,u=new Date(Number(t));l=Object(Wn.b)(u)?qn(u):Object(Wn.c)(u)?Vn({time:qn(u)}):Object(Wn.d)(u)?Kn(u):Qn(u);var p=r&&!s,m=s?"right":"left",f=!s;return d.createElement(fe.a,{style:[f&&Xn.footerPadderWithAvatar,s&&Xn.timestamp]},d.createElement(he.c,{align:m,color:"deepGray",size:"small",withInteractiveStyling:s||!mt.a.isEnabled},p&&d.createElement(Ae.a.I18NFormatMessage,{$i18n:"c8b914d4"},d.createElement(he.c,null,c)),p&&" ",l))},t}(d.PureComponent),Xn=te.a.create((function(e){return{root:{marginTop:e.spaces.micro,overflow:"hidden",width:"87.5%"},sentMessage:{alignSelf:"flex-end",justifyContent:"flex-end"},sentContainer:{flexDirection:"column"},groupedItems:{justifyContent:"flex-end",flexDirection:"row"},timestamp:{cursor:"pointer"},checkmark:{cursor:"pointer",flexShrink:0,height:"1rem",paddingLeft:e.spaces.micro},checkmarkContainer:{lineHeight:"1"},footerPadderWithAvatar:{marginLeft:"calc("+e.spaces.xLarge+" + "+e.spaces.xSmall+")"}}})),Jn=Object(B.c)()(Wt(Yn)),Zn=n("jtO7"),$n=te.a.create((function(e){return{root:{borderColor:e.colors.fadedGray,borderStyle:"solid",borderWidth:"1px",borderBottomWidth:0,boxSizing:"border-box",overflow:"hidden"},isLast:{borderBottomWidth:"1px"},insideTopRoundedSent:{borderTopLeftRadius:"1.25rem"},insideTopRoundedReceived:{borderTopRightRadius:"1.25rem"},outsideTopRoundedSent:{borderTopRightRadius:"1.25rem"},outsideTopRoundedReceived:{borderTopLeftRadius:"1.25rem"},sentLast:{borderBottomLeftRadius:"1.25rem"},receivedLast:{borderBottomRightRadius:"1.25rem"}}})),er=function(e){var t=e.insideTopRounded,n=e.isSent,r=e.isLast,a=e.label,i=e.onClick,o=e.tcoUrl,s=e.outsideTopRounded,c=[$n.root,r&&$n.isLast,r&&n&&$n.sentLast,r&&!n&&$n.receivedLast,t&&n&&$n.insideTopRoundedSent,t&&!n&&$n.insideTopRoundedReceived,s&&n&&$n.outsideTopRoundedSent,s&&!n&&$n.outsideTopRoundedReceived];return d.createElement(fe.a,{style:c},d.createElement(Zn.a,{align:"center",color:"primary",label:a,link:o,onClick:i,withBottomBorder:!1}))},tr=n("fs1G"),nr=function(e){function t(){return e.apply(this,arguments)||this}s()(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.onImpression()},n.render=function(){var e=this.props,t=e.callToActions,n=e.isSent,r=e.onCtaClick,a=e.withSticker,i=e.withUserText,o=t.map((function(e,o){var s=0===o;return d.createElement(er,{insideTopRounded:s&&(a||!i),isLast:o===t.length-1,isSent:n,key:o,label:e.label,onClick:r,outsideTopRounded:s&&a,tcoUrl:e.tco_url})}));return d.createElement(fe.a,null,o)},t}(d.Component);l()(nr,"defaultProps",{onCtaClick:tr.a,onImpression:tr.a});var rr=nr,ar=n("/dtk"),ir=n("vjRr"),or=Object(_.createSelector)((function(e,t){return t.messageData.attachment&&t.messageData.attachment.card?ir.a.createManyHydratedSelector([t.messageData.attachment.card])(e)[0]:void 0}),w.j,(function(e,t){return{card:e,dataSaverMode:t}})),sr=Object(g.c)(or),cr=te.a.create((function(e){return{root:{width:"100%"},invisible:{opacity:0},visible:{opacity:1}}})),lr=function(e){var t=e.attachmentContent,n=e.isVisible,r=void 0===n||n,a=e.textContent;return d.createElement(fe.a,{style:[r?cr.visible:cr.invisible,cr.root]},t,a)},dr=n("cTG8"),ur=function(e){var t=e.excludeCardUrl,n=e.isActive,r=void 0!==n&&n,a=e.isFailedDraft,i=e.isFirstRapidFire,o=void 0!==i&&i,s=e.isRapidFire,c=void 0!==s&&s,l=e.isSent,u=e.hasAssociatedAttachment,p=e.messageData,m=void 0===p?{}:p,f=e.rootStyle,h=e.tweetId,v=e.withCta,g=e.withMediaLinks,b=e.withMessageBubble,_=[f,b&&pr.messageTextContainer,b&&l&&pr.sent,b&&!l&&pr.received,a&&pr.failedDraft,c&&!o&&!l&&pr.rapidFireReceived,c&&!o&&l&&pr.rapidFireSent,u&&l&&pr.hasAssociatedAttachmentSent,u&&!l&&pr.hasAssociatedAttachmentReceived,b&&r&&l&&pr.activeSent,b&&r&&!l&&!mt.a.isEnabled&&pr.activeReceived,v&&pr.withCta],y=[pr.tweetText,b&&pr.textAlignLeft,!b&&l&&pr.textAlignRight],C=te.a.theme.colors,E=C.white,S=C.text,x=C.primary,R=C.faintGray,w=C.red,I=ee.a.generate({color:l?E:S,backgroundColor:a?w:l?x:R}),A=m.text&&m.text.length||0;return d.createElement(ne.a,{accessibilityRole:"none",interactive:l,interactiveStyles:b?I:null,style:_},d.createElement(dr.a,{color:te.a.isDarkMode()||l?"whiteOnColor":void 0,displayTextRange:[0,A],entities:m.entities,excludeCardUrl:t,linkColor:b&&l||te.a.isDarkMode()?"whiteOnColor":"link",linkify:!0,quotedTweetId:h,size:b?void 0:"jumbo",style:y,text:m.text||"",underlineLinks:!0,withMediaLinks:g}))},pr=te.a.create((function(e){return{tweetText:{overflow:"hidden"},messageTextContainer:{borderRadius:"1.25rem",boxSizing:"border-box",maxWidth:"100%",paddingVertical:e.spaces.xSmall,paddingHorizontal:e.spaces.small},textAlignLeft:{textAlign:"left"},textAlignRight:{textAlign:"right"},sent:{alignSelf:"flex-end",backgroundColor:e.colors.primary,borderBottomRightRadius:0,borderColor:e.colors.primary},received:{alignSelf:"flex-start",backgroundColor:e.colors.dmReceivedBubbleBackground,borderBottomLeftRadius:0,borderColor:e.colors.lightGray},activeSent:{backgroundColor:e.colors.lightPrimary},activeReceived:{backgroundColor:e.colors.lightGray},failedDraft:{backgroundColor:e.colors.red},rapidFireReceived:{borderTopLeftRadius:0},rapidFireSent:{borderTopRightRadius:0},withCta:{borderBottomRightRadius:0,borderBottomLeftRadius:0},hasAssociatedAttachmentSent:{borderTopRightRadius:0},hasAssociatedAttachmentReceived:{borderTopLeftRadius:0}}}));ur.defaultProps={withMediaLinks:!1};var mr=ur,fr=function(e){var t=e.isActive,n=void 0!==t&&t,r=e.isFailedDraft,a=e.isFirstRapidFire,i=void 0!==a&&a,o=e.isRapidFire,s=void 0!==o&&o,c=e.isSent,l=e.messageData,u=e.withCta,p=e.withMessageBubble;return d.createElement(mr,{isActive:n,isFailedDraft:r,isFirstRapidFire:i,isRapidFire:s,isSent:c,messageData:l,withCta:u,withMediaLinks:!0,withMessageBubble:p})},hr=n("wrlS"),vr=n("NnR4"),gr=n("SMZj"),br=function(e){function t(t){var n;return n=e.call(this,t)||this,l()(i()(n),"state",{attachmentWidth:void 0,textContentWidth:void 0}),l()(i()(n),"_handleAttachmentLayout",(function(e){var t=e.nativeEvent.layout.width;if(n.state.attachmentWidth!==t){var r={attachmentWidth:t};n.setState(r)}})),l()(i()(n),"_handleTextContentLayout",(function(e){var t=e.nativeEvent.layout.width;if(n.state.textContentWidth!==t){var r={textContentWidth:t};n.setState(r)}})),n._hwCardsEnabled=hr.a.isTrue("responsive_web_hw_cards_in_dms_enabled"),n}return s()(t,e),t.prototype.render=function(){var e=this.props,t=e.card,n=e.dataSaverMode,r=e.hasUserText,a=e.isActive,i=e.isFailedDraft,o=e.isFirstRapidFire,s=e.isRapidFire,c=e.isSent,l=e.messageData,u=e.withCta,p=e.withMessageBubble,m=this.state,f=m.attachmentWidth,h=m.textContentWidth,v=this._hwCardsEnabled&&Object(gr.n)(t),g=!t||!v&&!Object(gr.l)(t),b=Ct(r,f,h),_=[c?_r.sent:_r.received,b.isAttachmentSquared?c?_r.attachmentSentSquared:_r.attachmentReceivedSquared:void 0],y=b.isAttachmentSquared?"both":c?"right":"left";if(g)return d.createElement(fr,{isActive:a,isFailedDraft:i,isFirstRapidFire:o,isRapidFire:s,isSent:c,messageData:l,withMessageBubble:p});var C=t?v&&t.hw_card_binding_values?d.createElement(fe.a,{onLayout:this._handleAttachmentLayout},d.createElement(vr.a,{card:{name:t.name,url:t.url,binding_values:t.hw_card_binding_values,users:t.users},cardContext:{tweetUserId:l.sender_id},dmSentOrReceived:c?"sent":"received",withSquareBottomBorderRadius:y})):d.createElement(fe.a,{onLayout:this._handleAttachmentLayout},d.createElement(ar.a,{boxStyle:_,card:t,dataSaverMode:n,onMediaClick:tr.a,onPollVote:tr.a,onShown:tr.a})):null,E=r&&l.attachment&&l.attachment.card?d.createElement(fe.a,{onLayout:this._handleTextContentLayout,style:c?_r.sentMessageWrapper:_r.receivedMessageWrapper},d.createElement(mr,{excludeCardUrl:l.attachment.card,hasAssociatedAttachment:!0,isActive:a,isFailedDraft:i,isFirstRapidFire:o,isRapidFire:s,isSent:c,messageData:l,rootStyle:b.isTextSquared?c?_r.textSentSquared:_r.textReceivedSquared:void 0,withCta:u,withMessageBubble:p})):null;return d.createElement(lr,{attachmentContent:C,isVisible:b.compositeRendered,textContent:E})},t}(d.Component);l()(br,"defaultProps",{hasUserText:!1});var _r=te.a.create((function(e){return{attachmentReceivedSquared:{borderBottomRightRadius:0},attachmentSentSquared:{borderBottomLeftRadius:0},card:{marginBottom:e.spaces.micro},receivedMessageWrapper:{alignSelf:"flex-start"},sentMessageWrapper:{alignSelf:"flex-end"},received:{borderBottomLeftRadius:0},sent:{borderBottomRightRadius:0},textReceivedSquared:{borderTopRightRadius:0},textSentSquared:{borderTopLeftRadius:0}}})),yr=sr(br),Cr=Ae.a.cc1030a5,Er=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,l()(i()(t),"state",{attachmentWidth:void 0,textContentWidth:void 0}),l()(i()(t),"_handleAttachmentLayout",(function(e){var n=e.nativeEvent.layout.width;if(t.state.attachmentWidth!==n){var r={attachmentWidth:n};t.setState(r)}})),l()(i()(t),"_handleTextContentLayout",(function(e){var n=e.nativeEvent.layout.width;if(t.state.textContentWidth!==n){var r={textContentWidth:n};t.setState(r)}})),t}s()(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.analytics.scribe({element:"fleets_attachment_tombstone",action:"impression"})},n.render=function(){var e=this.props,t=e.hasUserText,n=e.isActive,r=e.isFailedDraft,a=e.isFirstRapidFire,i=e.isRapidFire,o=e.isSent,s=e.messageData,c=e.withCta,l=this.state,u=l.attachmentWidth,p=l.textContentWidth;if(!s||!s.attachment||!s.attachment.fleet)return null;var m=Ct(t,u,p),f=m.isAttachmentSquared?"both":o?"right":"left",h=d.createElement(fe.a,{accessible:!0,onLayout:this._handleAttachmentLayout,style:[xr.root,f&&Sr[f]]},d.createElement(fe.a,{style:xr.description},d.createElement(he.c,null,Cr))),v=t?d.createElement(fe.a,{onLayout:this._handleTextContentLayout,style:o?xr.sentMessageWrapper:xr.receivedMessageWrapper},d.createElement(mr,{hasAssociatedAttachment:!0,isActive:n,isFailedDraft:r,isFirstRapidFire:a,isRapidFire:i,isSent:o,messageData:s,rootStyle:m.isTextSquared?o?xr.sentSquared:xr.receivedSquared:void 0,withCta:c,withMessageBubble:!0})):null;return d.createElement(lr,{attachmentContent:h,isVisible:m.compositeRendered,textContent:v})},t}(d.Component),Sr=te.a.create((function(e){return{both:{borderBottomRightRadius:0,borderBottomLeftRadius:0},left:{borderBottomLeftRadius:0},right:{borderBottomRightRadius:0}}})),xr=te.a.create((function(e){return{attachment:{marginBottom:0},description:{flexGrow:1,flexShrink:1},isSent:{borderBottomRightRadius:0},received:{borderBottomLeftRadius:0},receivedMessageWrapper:{alignSelf:"flex-start"},root:{backgroundColor:e.colors.faintGray,borderColor:e.colors.fadedGray,borderRadius:"1.25rem",boxSizing:"border-box",borderWidth:e.borderWidths.small,maxWidth:"100%",padding:e.spaces.small,overflow:"auto",display:"flex"},sentMessageWrapper:{alignSelf:"flex-end"},receivedSquared:{borderTopRightRadius:0},sentSquared:{borderTopLeftRadius:0}}})),Rr=Object(Ge.a)(Er),wr=n("prG5"),Ir=n("RCZO"),Ar=n("A91F"),Or=Ae.a.b327c129,Tr=function(e){e.stopPropagation()},kr=function(e){var t=e.media,n=e.mediaUrl,r=t.ext_alt_text||Or,a=t.media_url_https,i=t.original_info||{},o=i.width,s=i.height,c=Object(Ir.b)(t).rgb,l=d.createElement(wr.a,{accessibilityLabel:r,aspectMode:Ar.a.withinRange(9/16,10),backgroundColor:c,image:{url:a,width:o,height:s},shouldShowAltLabel:!!t.ext_alt_text});return n?d.createElement(ne.a,{interactiveStyles:null,link:n,onPress:Tr},l):l},Mr=n("iOGT"),Lr=n("TrHT"),Fr=n("Modb"),Br=n("lklz"),Pr=function(e){var t=e.media,n=e.messageId,r=t&&Object(Lr.a)(Br.b.forDm(n),t);return r?d.createElement(Fr.a,Dt()({},r,{aspectRatio:Mr.b(t),withPostPlayback:!0})):null},Dr={scribeAction:p.c},jr=Object(g.b)(Dr),Nr=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,l()(i()(r),"_getElement",(function(){return"untrusted_"+r.props.contentType+"_interstitial"})),l()(i()(r),"_handleClick",(function(){var e=r.props,t=e.scribeAction,n=e.scribeNamespace;r.setState({hide:!1}),t(Object.assign({},n,{element:r._getElement(),action:"reveal"}))})),r.state={hide:!0},r}s()(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.scribeAction,n=e.scribeNamespace;t(Object.assign({},n,{element:this._getElement(),action:"impression"}))},n.render=function(){var e=this,t=this.props,n=t.children,r=t.ctaText,a=t.description,i=t.withSquareBottomBorderRadius;return this.state.hide?d.createElement(un.a,null,(function(t){var n=t.windowWidth<te.a.theme.breakpoints.medium;return d.createElement(fe.a,{accessible:!0,style:[Ur.root,n?{flexDirection:"column"}:{flexDirection:"row",alignItems:"center"},i&&Wr[i]]},d.createElement(fe.a,{style:Ur.description},d.createElement(he.c,null,a)),d.createElement(fe.a,{style:[Ur.button,n?Ur.breakButtonWrapper:void 0]},d.createElement(pt.a,{onClick:e._handleClick,size:"normalCompact",style:Ur.buttonElement,type:"text"},r)))})):n},t}(d.PureComponent),Wr=te.a.create((function(e){return{both:{borderBottomRightRadius:0,borderBottomLeftRadius:0},left:{borderBottomLeftRadius:0},right:{borderBottomRightRadius:0}}})),Ur=te.a.create((function(e){return{breakButtonWrapper:{marginTop:te.a.theme.spaces.xxSmall,marginLeft:"calc(-1 * "+e.spaces.xSmall+")"},button:{flexGrow:1,alignItems:"flex-start"},buttonElement:{paddingHorizontal:e.spaces.xSmall},description:{flexGrow:1,flexShrink:1},root:{backgroundColor:e.colors.faintGray,borderBottomLeftRadius:0,borderColor:e.colors.fadedGray,borderRadius:"1.25rem",boxSizing:"border-box",borderWidth:e.borderWidths.small,maxWidth:"100%",paddingLeft:e.spaces.small,paddingTop:e.spaces.small,paddingBottom:e.spaces.small,paddingRight:e.spaces.xxSmall,overflow:"auto",display:"flex"}}})),Hr=Object(B.c)()(jr(Nr)),zr=n("M7Ix"),Gr=d.createElement(zr.a,null),qr=Ae.a.d9de7b57,Vr=Ae.a.f277e949,Kr=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,l()(i()(t),"state",{attachmentWidth:void 0,textContentWidth:void 0}),l()(i()(t),"_handleAttachmentLayout",(function(e){var n=e.nativeEvent.layout.width;if(t.state.attachmentWidth!==n){var r={attachmentWidth:n};t.setState(r)}})),l()(i()(t),"_handleTextContentLayout",(function(e){var n=e.nativeEvent.layout.width;if(t.state.textContentWidth!==n){var r={textContentWidth:n};t.setState(r)}})),t}s()(t,e);var n=t.prototype;return n.render=function(){var e,t,n=this.props,r=n.entry,a=n.hasUserText,i=n.isActive,o=n.isFailedDraft,s=n.isFirstRapidFire,c=n.isRapidFire,l=n.isSent,u=n.isTrusted,p=n.messageData,m=n.withCta,f=n.withMessageBubble,h=this.state,v=h.attachmentWidth,g=h.textContentWidth,b=(p||{}).attachment,_=r.is_draft,y=Ct(a,v,g),C=[Qr.mediaAttachment,l&&Qr.isSent,!l&&Qr.received,l&&y.isAttachmentSquared&&Qr.equalComponentDimensionsSent,!l&&y.isAttachmentSquared&&Qr.equalComponentDimensionsReceived,c&&!s&&l&&Qr.rapidFireSent,c&&!s&&!l&&Qr.rapidFireReceived],E=null;!_&&r.conversation_id&&(E="/messages/"+r.conversation_id+"/media/"+r.id),b&&(b.photo?(e=b.photo,t=d.createElement(kr,{media:e,mediaUrl:E})):b.animated_gif?(e=b.animated_gif,t=d.createElement(Pr,{media:e,messageId:r.id})):b.video&&(e=b.video,t=d.createElement(Pr,{media:e,messageId:r.id})));var S=y.isAttachmentSquared?"both":l?"right":"left",x=e&&t&&this._getMediaContentWithGuard(e,u,t,S),R=d.createElement(fe.a,{onLayout:this._handleAttachmentLayout,style:C},x),w=a?d.createElement(fe.a,{onLayout:this._handleTextContentLayout,style:l?Qr.sentMessageWrapper:Qr.receivedMessageWrapper},d.createElement(mr,{hasAssociatedAttachment:!0,isActive:i,isFailedDraft:o,isFirstRapidFire:s,isRapidFire:c,isSent:l,messageData:_?p:this._parseMessageData(p,e),rootStyle:y.isTextSquared?l?Qr.sentSquared:Qr.receivedSquared:void 0,withCta:m,withMessageBubble:f})):null;return d.createElement(lr,{attachmentContent:R,isVisible:y.compositeRendered,textContent:w})},n._getMediaContentWithGuard=function(e,t,n,r){return!this.props.displaySensitiveMedia&&e.possibly_sensitive?d.createElement(Hr,{contentType:"media",ctaText:Vr,description:Gr,withSquareBottomBorderRadius:r},n):t?n:d.createElement(Hr,{contentType:"media",ctaText:Vr,description:qr,withSquareBottomBorderRadius:r},n)},n._parseMessageData=function(e,t){var n=e&&e.entities&&e.entities.urls&&t?e.entities.urls.filter((function(e){return e.display_url!==t.display_url})):null;return e&&n?Object.assign({},e,{entities:Object.assign({},e.entities,{urls:n,media:[t]})}):void 0},t}(d.Component);l()(Kr,"defaultProps",{hasUserText:!1});var Qr=te.a.create((function(e){return{equalComponentDimensionsSent:{borderBottomLeftRadius:0},equalComponentDimensionsReceived:{borderBottomRightRadius:0},invisible:{opacity:0},isSent:{borderBottomRightRadius:0},mediaAttachment:{borderRadius:"1.25rem",WebkitMaskImage:"url(data:image/png;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICRAEAOw==)"},receivedMessageWrapper:{alignSelf:"flex-start"},sentMessageWrapper:{alignSelf:"flex-end"},rapidFireReceived:{borderTopLeftRadius:0},rapidFireSent:{borderTopRightRadius:0},received:{borderBottomLeftRadius:0},receivedSquared:{borderTopRightRadius:0},sentSquared:{borderTopLeftRadius:0},visible:{opacity:1}}})),Yr=Kr,Xr=n("rxPX"),Jr=Object(Xr.a)().propsFromActions((function(){return{markSpamStatus:m.markSpamStatus}})),Zr=Ae.a.fd07947f,$r=Ae.a.c7a92dc9,ea=Ae.a.f277e949,ta=Ae.a.fb3ccb55,na=Jr(function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,l()(i()(t),"_handlePress",(function(e){return function(){var n=t.props,r=n.conversationId,a=n.dmId;(0,n.markSpamStatus)({conversationId:r,dmId:a,markSpam:e})}})),t}s()(t,e);var n=t.prototype;return n.render=function(){var e=this.props.children;return d.createElement(Hr,{contentType:"dm",ctaText:ea,description:ta},e,this._renderButtons())},n._renderButtons=function(){return d.createElement(fe.a,{style:ra.buttons},d.createElement(pt.a,{onPress:this._handlePress(!1),style:ra.leftButton,type:"secondary"},$r),d.createElement(pt.a,{onPress:this._handlePress(!0),type:"secondary"},Zr))},t}(d.PureComponent)),ra=te.a.create((function(e){return{buttons:{flexDirection:"row",paddingTop:e.spaces.xxSmall},leftButton:{marginRight:e.spaces.xSmall}}})),aa=n("D4le"),ia=n.n(aa),oa=function(e){var t=e.images,n=t.svg||t.size_1x;if(n)return n.url},sa=te.a.create((function(e){return{stickerItem:{height:"calc(3 * "+e.fontSizes.jumbo+")",width:"calc(3 * "+e.fontSizes.jumbo+")"}}})),ca=function(e){var t=e.sticker;return d.createElement(ia.a,{accessibilityLabel:t.display_name,source:oa(t),style:sa.stickerItem})},la=Object(Xr.a)().propsFromActions((function(){return{popOutConversation:m.popOutConversation}})),da=n("b5s6"),ua=Ae.a.e4df0ad7,pa=Ae.a.f277e949,ma=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,l()(i()(t),"state",{attachmentWidth:void 0,textContentWidth:void 0}),l()(i()(t),"_handleAttachmentLayout",(function(e){var n=e.nativeEvent.layout.width;if(t.state.attachmentWidth!==n){var r={attachmentWidth:n};t.setState(r)}})),l()(i()(t),"_handleTextContentLayout",(function(e){var n=e.nativeEvent.layout.width;if(t.state.textContentWidth!==n){var r={textContentWidth:n};t.setState(r)}})),l()(i()(t),"_handlePopOutDM",(function(){var e=t.props,n=e.conversationId,r=e.popOutConversation;n&&r(n)})),t}return s()(t,e),t.prototype.render=function(){var e=this.props,t=e.hasUserText,n=void 0!==t&&t,r=e.isActive,a=void 0!==r&&r,i=e.isFailedDraft,o=e.isFirstRapidFire,s=void 0!==o&&o,c=e.isRapidFire,l=void 0!==c&&c,u=e.isSent,p=e.isTrusted,m=e.messageData,f=e.withCta,h=e.withMessageBubble,v=this.state,g=v.attachmentWidth,b=v.textContentWidth;if(!m||!m.attachment||!m.attachment.tweet)return null;var _=m.attachment.tweet,y=u?"sent":"received",C=Ct(n,g,b),E=d.createElement(da.a,{onPress:hr.a.isTrue("responsive_web_dm_quick_access_enabled")?this._handlePopOutDM:void 0,style:[fa[y],n&&fa.attachment,C.isAttachmentSquared?u?fa.sentAttachmentSquared:fa.receivedAttachmentSquared:void 0],tweetId:_.status}),S=C.isAttachmentSquared?"both":u?"right":"left",x=p?E:d.createElement(Hr,{contentType:"tweet",ctaText:pa,description:ua,withSquareBottomBorderRadius:S},E),R=d.createElement(fe.a,{onLayout:this._handleAttachmentLayout,style:fa.attachment},x),w=n?d.createElement(fe.a,{onLayout:this._handleTextContentLayout,style:u?fa.sentMessageWrapper:fa.receivedMessageWrapper},d.createElement(mr,{hasAssociatedAttachment:!0,isActive:a,isFailedDraft:i,isFirstRapidFire:s,isRapidFire:l,isSent:u,messageData:m,rootStyle:C.isTextSquared?u?fa.sentSquared:fa.receivedSquared:void 0,tweetId:_.status,withCta:f,withMediaLinks:!0,withMessageBubble:h})):null;return d.createElement(lr,{attachmentContent:R,isVisible:C.compositeRendered,textContent:w})},t}(d.Component),fa=te.a.create((function(e){return{attachment:{marginBottom:0},receivedMessageWrapper:{alignSelf:"flex-start"},sentMessageWrapper:{alignSelf:"flex-end"},received:{borderBottomLeftRadius:0,borderColor:e.colors.lightGray},receivedAttachmentSquared:{borderBottomRightRadius:0},receivedSquared:{borderTopRightRadius:0},sent:{borderBottomRightRadius:0,borderColor:e.colors.primary},sentAttachmentSquared:{borderBottomLeftRadius:0},sentSquared:{borderTopLeftRadius:0}}})),ha=la(ma),va=function(e){function t(){return e.apply(this,arguments)||this}s()(t,e);var n=t.prototype;return n.render=function(){var e,t=this.props,n=t.entry,r=t.isSent,a=t.onCtaClick,i=t.onCtaImpression,o=n.message_data,s=o&&o.attachment?o.attachment:{},c=n.marked_as_spam,l=yt(n),u=!!o&&!!o.ctas,p=_t(n),m=!(p&&n.isEmojiOnly);e=s.sticker?d.createElement(ca,{sticker:s.sticker}):this._renderDMMessage(p,u,m);var f=c?d.createElement(na,{conversationId:n.conversation_id,dmId:n.id},e):e;return d.createElement(fe.a,{style:[l?ga.mediaRoot:ga.root,r?ga.isSent:ga.isReceived,u&&ga.withCta]},f,o&&o.ctas?d.createElement(rr,{callToActions:o.ctas,isSent:r,onCtaClick:a,onImpression:i,withSticker:!!s.sticker||n.isEmojiOnly,withUserText:p}):null)},n._renderDMMessage=function(e,t,n){var r=this.props,a=r.entry,i=r.isActive,o=r.isFirstRapidFire,s=r.isRapidFire,c=r.isSent,l=r.isTrusted,u=r.displaySensitiveMedia,p=a.message_data,m=a.error,f=Object.assign({},p,{entities:p&&p.entities||void 0,error:m}),h=f.attachment||{},v={isActive:i,isFailedDraft:!!m,isFirstRapidFire:o,isRapidFire:s,isSent:c,messageData:f,withCta:t,withMessageBubble:n};return h.tweet?d.createElement(ha,Dt()({conversationId:a.conversation_id,hasUserText:e,isTrusted:l},v)):h.photo||h.animated_gif||h.video?d.createElement(Yr,Dt()({displaySensitiveMedia:u,entry:a,hasUserText:e,isTrusted:l},v)):h.card?d.createElement(yr,Dt()({hasUserText:e},v)):h.fleet?d.createElement(Rr,Dt()({hasUserText:e},v,{withMessageBubble:!0})):d.createElement(fr,v)},t}(d.Component),ga=te.a.create((function(e){return{root:{flexShrink:1},mediaRoot:{flex:1},isSent:{alignItems:"flex-end"},isReceived:{alignItems:"flex-start"},withCta:{alignItems:"stretch"}}})),ba=va,_a=te.a.create((function(e){return{avatar:{alignSelf:"flex-end",borderRadius:e.borderRadii.infinite,marginRight:e.spaces.xSmall},avatarSpacer:{height:e.spaces.xLarge,width:e.spaces.xLarge}}})),ya=function(e){var t=e.showAvatar,n=e.user;return t?d.createElement(tn.default,{accessibilityLabel:n.name,circle:!0,link:{pathname:"/"+n.screen_name},size:"xLarge",style:_a.avatar,uri:n.profile_image_url_https}):d.createElement(fe.a,{style:[_a.avatar,_a.avatarSpacer]})},Ca=n("uArA"),Ea="messageEntry",Sa={element:"cta_dm"},xa=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,l()(i()(t),"_handleClick",Object(Ca.a)((function(){var e=t.props,n=e.entry,r=n.error,a=n.id,i=n.is_draft,o=e.isActive,s=e.setActiveEntry;i||r||(s(o?null:a),t._handleScribeMessageEntryClick())}))),l()(i()(t),"_handleScribeMessageEntryClick",(function(){var e=t.props.isActive;if(!mt.a.isEnabled&&!e){var n=t.props.entry,r={component:"message",element:Object(I.a)(n),action:"click"};t._scribeAction(r)}})),l()(i()(t),"_handleCtaImpression",(function(){t._scribeAction(Object.assign({},Sa,{action:"show"}))})),l()(i()(t),"_handleCtaClick",(function(){t._scribeAction(Object.assign({},Sa,{action:"click"}))})),t}s()(t,e);var n=t.prototype;return n.shouldComponentUpdate=function(e){return!Object(ue.a)(this.props,e)},n.render=function(){var e=this,t=this.props,n=t.isActive,r=t.isLastRapidFire,a=t.isRapidFire,i=t.isSent,o=t.user,s=[wa.root,i?wa.pointerCursor:wa.defaultCursor,a&&!r&&wa.bottomSpacing];return o?d.createElement(ne.a,{accessible:!0,"aria-expanded":!mt.a.isEnabled&&n||n&&i?"true":"false",interactiveStyles:null,onPress:i||!mt.a.isEnabled?this._handleClick:void 0,style:s,testID:Ea},(function(t){var n=t.isFocused,r=t.isHovered;return d.createElement(d.Fragment,null,e._renderMessage({isFocused:n,isHovered:r}),e._renderFooter())})):null},n._renderMessage=function(e){var t=void 0===e?{isFocused:!1,isHovered:!1}:e,n=t.isHovered,r=t.isFocused,a=this.props,i=a.displaySensitiveMedia,o=a.entry,s=a.isActive,c=a.isWide,l=a.isFirstRapidFire,u=a.isLastRapidFire,p=a.isRapidFire,m=a.isReadOnly,f=a.isSent,h=a.isTrusted,v=a.perspective,g=a.setShouldFreezeUpdates,b=a.user,_=[wa.messageContainer,c?wa.messageContainerWide:wa.messageContainerNarrow,f&&wa.messageContainerSent,f&&c&&wa.messageContainerSentWide,!f&&c&&wa.messageContainerReceivedWide],y=!f&&b?d.createElement(ya,{showAvatar:!p||!!u,user:b}):null,C=h&&!m;return d.createElement(fe.a,{style:_},y,d.createElement(ba,{displaySensitiveMedia:i,entry:o,isActive:s,isFirstRapidFire:l,isRapidFire:p,isSent:f,isTrusted:h,key:o.id,onCtaClick:this._handleClick,onCtaImpression:this._handleCtaImpression}),o.error?null:d.createElement(Mt,{containerIsActive:s,containerIsFocused:r,containerIsHovered:n,entry:o,isDraft:!!o.is_draft,isSent:f,perspective:v,setShouldFreezeUpdates:g,shouldShowReactionButton:C}))},n._renderFooter=function(){var e=this.props,t=e.isGroupDM,n=e.entry,r=e.isActive,a=e.isLastRapidFire,i=e.isRapidFire,o=e.isSent,s=e.participants,c=e.user;return d.createElement(Jn,{conversationId:n.conversation_id,entryId:n.id,entryText:n.message_data&&n.message_data.text,entryTime:n.time,isActive:r,isDraft:!!n.is_draft,isError:!!n.error,isGroupDM:t,isLastRapidFire:a,isRapidFire:i,isSent:o,participants:s,user:c})},n._scribeAction=function(e){this.props.analytics.scribe(Object.assign({},e))},t}(d.Component);l()(xa,"defaultProps",{isGroupDM:!1,isRapidFire:!1,isFirstRapidFire:!1,isLastRapidFire:!1});var Ra=Object(Ge.a)(Ee(xa)),wa=te.a.create((function(e){return{bottomSpacing:{paddingBottom:e.spaces.micro},messageContainer:{flexDirection:"row"},messageContainerNarrow:{width:"100%"},messageContainerWide:{width:"87.5%"},messageContainerReceivedWide:{paddingRight:e.spaces.xSmall},messageContainerSent:{alignSelf:"flex-end",justifyContent:"flex-end"},messageContainerSentWide:{paddingLeft:e.spaces.xSmall},root:{flexDirection:"column",paddingBottom:e.spaces.medium},defaultCursor:{cursor:"default"},pointerCursor:{cursor:"pointer"}}})),Ia=n("H4nC"),Aa=function(e){function t(){return e.apply(this,arguments)||this}s()(t,e);var n=t.prototype;return n.shouldComponentUpdate=function(e){return!Object(ue.a)(this.props,e)},n.render=function(){var e=this.props,t=e.conversation,n=e.entry,r=e.isActive,a=e.isWide,i=e.isFirstRapidFire,o=e.isLastRapidFire,s=e.isRapidFire,c=e.perspective,l=e.scribeNamespace,u=e.setActiveEntry,p=e.setShouldFreezeUpdates;if(Object(Q.b)(n)||Object(Q.e)(n)){var f=t.conversation_id,h=t.participants,v=t.read_only,g=t.trusted,b=t.type,_=n.message_data,y=(_=void 0===_?{}:_).sender_id,C=void 0===f||g;return d.createElement(Ra,{entry:n,isActive:r,isFirstRapidFire:i,isGroupDM:b===m.CONVERSATION_TYPE.GROUP,isLastRapidFire:o,isRapidFire:s,isReadOnly:v,isSent:y===c,isTrusted:C,isWide:a,participants:h,perspective:c,scribeNamespace:l,senderId:y,setActiveEntry:u,setShouldFreezeUpdates:p})}return Object(Q.a)(n)?d.createElement(_e,{conversation:t,entry:n,entryType:n.type,perspective:c}):Object(Q.d)(n)?d.createElement(Ia.a,{entry:n,isCompact:!1}):null},t}(d.Component);l()(Aa,"defaultProps",{isActive:!1});var Oa=Object(_.createSelector)((function(e,t){var n=Object(Le.o)(e,t.conversationId),r=n&&Object(X.a)(n);return r&&Object(m.selectEntry)(e,r)}),(function(e){return{lastEntry:e}})),Ta=Object(g.c)(Oa),ka=(n("Ef13"),Object(_.createSelector)((function(e,t){return R.e.selectMany(e,t.userIds||[])}),(function(e){return{users:e}}))),Ma=Object(jt.b)(ka),La=n("Enqy"),Fa=n("PARX"),Ba=n.n(Fa),Pa=function(e,t){return e.id_str<t.id_str?-1:e.id_str>t.id_str?1:0},Da={stiffness:1e3,damping:70},ja={scale:Object(La.spring)(1,Da),translateY:Object(La.spring)(0,Da)},Na=function(e,t){return{key:e.id_str,data:e,style:ja}},Wa=Object(N.a)({translateY:140,scale:0}),Ua=Object(N.a)({scale:Object(La.spring)(1,Da),translateY:Object(La.spring)(140,Da)}),Ha=[{key:"bubble",style:{scale:Object(La.spring)(1,Da),translateY:Object(La.spring)(0,Da)}}],za=Object(N.a)({translateY:140,scale:0}),Ga=Object(N.a)({scale:Object(La.spring)(1,Da),translateY:Object(La.spring)(140,Da)}),qa=function(e){return[isFinite(e.scale)&&{scale:e.scale.toFixed(3)},isFinite(e.translateY)&&{translateY:Math.round(e.translateY)+"%"}].filter(Boolean)},Va=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,l()(i()(t),"state",{isHidden:!0}),l()(i()(t),"_afterLeave",(function(){var e=t.props.users;t.setState((function(t){return{isHidden:0===e.length}}))})),t}s()(t,e);var n=t.prototype;return n.componentDidUpdate=function(e,t){this.state.isHidden&&this.props.users&&this.props.users.length&&this.setState({isHidden:!1})},n.shouldComponentUpdate=function(e,t){return!Object(ue.a)(this.props,e)||!Object(ue.a)(this.state,t)},n.render=function(){var e=this.state.isHidden,t=this.props.users,n=t.sort(Pa).slice(0,5).map(Na);return t.length>5&&n.push({key:"overflow",style:ja}),d.createElement(fe.a,{style:[Ka.root,e&&Ka.hidden]},d.createElement(fe.a,{style:Ka.avatarRow},d.createElement(La.TransitionMotion,{styles:n,willEnter:Wa,willLeave:Ua},(function(e){return d.createElement(d.Fragment,null,e.map((function(e,n){if(e.style.scale<=.05)return null;var r=qa(e.style);return"overflow"===e.key?d.createElement(fe.a,{key:e.key,style:[Ka.avatar,Ka.avatarSpacer,Ka.overflowAvatar,{transform:r}]},d.createElement(Ba.a,{style:Ka.overflowAvatarText},"+",t.length-5)):d.createElement(fe.a,{key:e.key,style:[Ka.avatar,{transform:r}]},d.createElement(tn.default,{accessibilityLabel:e.data&&e.data.name,size:"xLarge",uri:e.data&&e.data.profile_image_url_https}))})))}))),d.createElement(La.TransitionMotion,{didLeave:this._afterLeave,styles:t.length>0?Ha:[],willEnter:za,willLeave:Ga},(function(e){return d.createElement(d.Fragment,null,e.map((function(e){return d.createElement(fe.a,{key:e.key,style:[Ka.messageBubble,{transform:qa(e.style)}]},d.createElement(fe.a,{style:Ka.dot}),d.createElement(fe.a,{style:[Ka.dot,Ka.dot1]}),d.createElement(fe.a,{style:[Ka.dot,Ka.dot2]}))})))})))},t}(d.Component),Ka=te.a.create((function(e){return{root:{flexDirection:"row",paddingBottom:e.spaces.medium,paddingRight:e.spaces.xSmall,width:"calc(100% * 7/8)",position:"relative",transitionProperty:"height, padding-bottom",transitionDuration:"0.2s",overflow:"hidden"},hidden:{paddingBottom:0,paddingRight:0,height:0,width:0},avatarRow:{display:"inline-flex",alignItems:"flex-start",flexDirection:"row"},avatar:{marginEnd:e.spaces.xSmall,transformOrigin:"50% 100%"},avatarSpacer:{height:e.spaces.xLarge,width:e.spaces.xLarge},overflowAvatar:{borderRadius:e.borderRadii.infinite,backgroundColor:e.colors.primary,alignItems:"center",justifyContent:"center"},overflowAvatarText:{color:"white"},messageBubble:{alignItems:"center",borderRadius:"1.25rem",maxWidth:"100%",paddingVertical:e.spaces.xSmall,paddingHorizontal:e.spaces.small,backgroundColor:e.colors.fadedGray,borderBottomLeftRadius:0,borderColor:e.colors.lightGray,flexDirection:"row",height:e.spaces.xLarge,overflow:"hidden",transformOrigin:"0% 100%"},dot:{display:"flex-inline",position:"relative",width:e.spaces.xSmall,height:e.spaces.xSmall,overflow:"hidden",borderRadius:e.borderRadii.infinite,backgroundColor:e.colors.deepGray,marginEnd:e.spaces.xxSmall,animationDuration:"1.2s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationKeyframes:[{"15%":{transform:[{scale:1.4}],backgroundColor:e.colors.primary},"30%":{transform:[{scale:1}]}}]},dot1:{animationDelay:"0.1s"},dot2:{animationDelay:"0.2s"}}})),Qa=Ma(Va),Ya=n("tn7R"),Xa=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,l()(i()(t),"_timers",{}),l()(i()(t),"state",{forceHide:!1,userIds:[]}),l()(i()(t),"_handleLivePipelineUpdate",(function(e){var n=e.dm_typing.user_id;n!==t.context.loggedInUserId&&(t._timers[n]&&clearTimeout(t._timers[n]),t._timers[n]=setTimeout((function(){return t._removeAvatar(n)}),4e3),t.setState((function(e){return{forceHide:!1,userIds:[].concat(Ne()(e.userIds.filter((function(e){return e!==n}))),[n])}})))})),l()(i()(t),"_removeAvatar",(function(e,n){void 0===n&&(n=!1),t.setState((function(t){var r=t.userIds.filter((function(t){return t!==e}));return{forceHide:n&&0===r.length,userIds:r}}))})),t}s()(t,e);var n=t.prototype;return n.componentDidMount=function(){this._initializeLivePipeline()},n.UNSAFE_componentWillReceiveProps=function(e){if(e.lastEntry){var t=(this.props||{}).lastEntry,n=void 0===t?{}:t,r=e.lastEntry;n&&n.id!==r.id&&r.message_data&&this._removeAvatar(r.message_data.sender_id,!0)}},n.componentDidUpdate=function(e,t){e.conversationId!==this.props.conversationId&&(this._teardownLivePipeline(),this._initializeLivePipeline())},n.componentWillUnmount=function(){this._teardownLivePipeline()},n.render=function(){var e=this.state,t=e.forceHide,n=e.userIds;return!t&&d.createElement(Qa,{conversationId:this.props.conversationId,userIds:n})},n._teardownLivePipeline=function(){Object(Ya.a)(this._timers).forEach((function(e){return clearTimeout(e)})),this._livePipelineSubscription&&this._livePipelineSubscription.teardown()},n._initializeLivePipeline=function(){var e=this,t=this.props.conversationId;Object(u.h)().then((function(n){var r=n.LivePipeline;r.isSupportedAndReady()&&hr.a.isTrue("livepipeline_dm_features_enabled")&&!e._livePipelineSubscription&&(e._livePipelineSubscription=r.get().subscribeTopic("/dm_typing/"+t,e._handleLivePipelineUpdate))}))},t}(d.PureComponent);l()(Xa,"contextType",Z.a);var Ja=Ta(Xa),Za=n("yw4N"),$a=n("9YUM"),ei=n("Qwev"),ti=n("mw9i"),ni=Ae.a.i859a9d3,ri=Ae.a.i8ecae5b,ai=Ae.a.ffde2fdb,ii=function(){return d.createElement(fe.a,{style:ci.spinner},d.createElement(ei.a,{accessibilityLabel:ai}))},oi=function(e){return e.entry.id},si=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,l()(i()(r),"_inlineConversationProfileInfoHeaderEnabled",hr.a.isTrue("responsive_web_dm_health_convo_inline_profile_info_enabled")),l()(i()(r),"_renderItem",(function(e){var t=r.props.conversation,n=t.conversation_id;switch(e.type){case z.b.TYPING_INDICATOR:return n?d.createElement(Ja,{conversationId:n}):null;case z.b.READ_ONLY_INDICATOR:return n?d.createElement(fe.a,{style:ci.readOnly},d.createElement(he.c,{align:"center",color:"deepGray",size:"small"},ri," ",d.createElement(he.c,{link:"https://support.twitter.com/articles/14606#faq"},ni))):null;case z.b.CONVERSATION_PROFILE_INFO_HEADER:return d.createElement(ce,{conversation:t});default:return r._renderDMEntry(e)}})),l()(i()(r),"_setActiveEntry",(function(e){r.setState({activeEntryId:e})})),l()(i()(r),"_setShouldFreezeUpdates",(function(e){r.setState({shouldFreezeUpdates:e})})),r._anchoring=H({isOwnMessage:function(e){var t,n;return(null===(t=e.entry)||void 0===t||null===(n=t.message_data)||void 0===n?void 0:n.sender_id)===r.props.perspective||!1},typingIndicatorId:"typingIndicator"}),r.state={activeEntryId:null,shouldFreezeUpdates:!1},r}s()(t,e);var n=t.prototype;return n.shouldComponentUpdate=function(e,t){return!1===t.shouldFreezeUpdates},n.render=function(){var e,t=this.props,n=t.conversation,r=t.style,a=t.onHistoryRequest,i=this.state.activeEntryId,o=function(e){var t=e.conversation,n=e.footer,r=e.readOnlyEntry,a=e.canInjectConversationProfileInfoHeader,i=e.activeEntryId,o=t&&t.entries||[],s=o.reduce((function(e,t,n){a&&0===n&&e.push(q);var r=Object(X.a)(e),s=n===o.length-1;if(e.push({isRapidFire:!1,isFirstRapidFire:!1,isLastRapidFire:!1,entry:t,isActive:i===t.id}),r){var c=Y(r.entry,t),l=e[e.length-2];c?(e[e.length-1].isRapidFire=!0,l.isRapidFire||(l.isFirstRapidFire=!0,l.isRapidFire=!0),s&&(e[e.length-1].isLastRapidFire=!0)):l.isRapidFire&&(l.isLastRapidFire=!0)}return e}),[]);return n&&s.push(n),t.read_only&&r&&s.push(r),s}({conversation:n,footer:V,readOnlyEntry:K,canInjectConversationProfileInfoHeader:n.status===z.c.AT_END&&n.type===z.a.ONE_TO_ONE&&this._inlineConversationProfileInfoHeaderEnabled,activeEntryId:i}),s=n.conversation_id;return d.createElement(Za.a,{style:[ci.scrollContainer,r]},n.status&&n.status!==z.c.AT_END?d.createElement(ii,null):null,d.createElement(ti.a,{style:ci.content,withGutter:!0},d.createElement($a.a,{anchoring:this._anchoring,assumedItemHeight:100,cacheKey:"dm-activity-"+s,identityFunction:oi,initialAnchor:o.length>0?D.a(oi((e=o,e[e.length-1]))):void 0,items:o,nearStartProximityRatio:2,onNearStart:a,renderer:this._renderItem})))},n._renderDMEntry=function(e){var t=e.entry,n=e.isActive,r=e.isFirstRapidFire,a=e.isLastRapidFire,i=e.isRapidFire,o=this.props,s=o.conversation,c=o.isWide,l=o.perspective,u=o.scribeNamespace;return t&&d.createElement(Aa,{conversation:s,entry:t,isActive:n,isFirstRapidFire:r,isLastRapidFire:a,isRapidFire:i,isWide:c,key:t.id,perspective:l,scribeNamespace:u,setActiveEntry:this._setActiveEntry,setShouldFreezeUpdates:this._setShouldFreezeUpdates})},t}(d.Component),ci=te.a.create((function(e){return{spinner:{alignItems:"center",marginVertical:"30px"},scrollContainer:{backgroundColor:e.colors.cellBackground,flexGrow:1,maxHeight:"100%",overflowX:"hidden",paddingTop:e.spaces.medium,WebkitOverflowScrolling:"touch"},content:{flexGrow:1,justifyContent:"flex-end",transform:[{translate3d:"0,0,0"}]},readOnly:{paddingBottom:e.spaces.medium}}})),li=n("uB9N"),di=n("v//M"),ui=n("J2UM"),pi=n("gpVt"),mi=n("I8M8"),fi=n("7myi"),hi=n("883S"),vi=n("z0MJ"),gi=n.n(vi),bi=n("Es6L"),_i=n("LsPn"),yi=n("GSsg"),Ci=n("EbOo"),Ei=n("DLPW"),Si=n.n(Ei),xi=n("CKsB"),Ri=Ae.a.f9e45cfb,wi=Ae.a.cf74e524,Ii=Ae.a.f3bb6f4e,Ai=Ae.a.g3f155be,Oi=Ae.a.cfd2f35d,Ti=te.a.create((function(e){return{root:{backgroundColor:e.colors.cellBackground},roundCorners:{borderRadius:e.borderRadii.large},flatCorners:{borderRadius:0},cancelButton:{marginHorizontal:e.spaces.small,marginVertical:e.spaces.small}}})),ki=function(e){var t=e.dismiss,n=e.onReportClick,r=e.onBlockClick,a=e.requestorScreenName,i=e.flatBorders,o=void 0!==i&&i,s=e.showCancel,c=void 0!==s&&s,l=d.useCallback((function(){n&&n(),t()}),[t,n]),u=d.useCallback((function(){r&&r(),t()}),[t,r]);return d.createElement(fe.a,{accessibilityRole:"dialog",style:[Ti.root,o?Ti.flatCorners:Ti.roundCorners]},d.createElement(xi.a,{Icon:Si.a,actionSubText:wi,actionText:Ri({screenName:a}),onClick:u}),d.createElement(xi.a,{Icon:$e.a,actionSubText:Ai,actionText:Ii({screenName:a}),onClick:l}),c?d.createElement(pt.a,{onPress:t,style:Ti.cancelButton,type:"neutral"},Oi):null)},Mi=Object(Xr.a)().propsFromActions((function(){return{addToast:v.b,block:R.e.block,createLocalApiErrorHandler:Object(b.d)("UNTRUSTED_CONVERSATION_ACTIONS"),unblock:R.e.unblock}})),Li=n("u0B7"),Fi=n("aITJ"),Bi=n("GygS"),Pi=n("vMjK"),Di=Ae.a.ccf2f24e,ji=Ae.a.ib3fe8a9,Ni=Ae.a.da878dcf,Wi=Ae.a.d96cf7cd,Ui=Ae.a.hc52446b,Hi=Ae.a.f7e1ad65,zi=Ae.a.i6b19b07,Gi={headline:Ae.a.gdf4b79f,text:Ae.a.bbf83d83,confirmButtonLabel:Ae.a.bb1d57b6},qi=function(e,t,n){return{pathname:"/i/report/dm_conversation/"+e,state:{clientReferer:t,scribeNamespace:n}}},Vi=function(e){function t(t){var n;return n=e.call(this,t)||this,l()(i()(n),"_enableConsolidatedBlockAndReport",hr.a.isTrue("responsive_web_dm_health_convo_block_report_button_enabled")),l()(i()(n),"_renderCopy",(function(e){var t=n.props,r=t.conversationId,a=t.scribeNamespace;return d.createElement(he.c,{style:Qi.copy},e?Ui:Hi({senderName:n._getTheOtherParticipantFromOneToOneConvo().name}),r&&!n._enableConsolidatedBlockAndReport?d.createElement(he.c,{link:qi(r,window.location.pathname,a),onClick:n._handleReportTextClick,style:Qi.reportlink},zi):null)})),l()(i()(n),"_renderActionButtons",(function(e){var t=n._enableConsolidatedBlockAndReport?"normal":"normalCompact";return d.createElement(un.a,null,(function(r){var a=r.windowWidth<=te.a.theme.breakpoints.small;return d.createElement(fe.a,{style:Qi.actionsContainer},n._enableConsolidatedBlockAndReport?d.createElement(Ki,{isGroup:e,isMobileLayout:a,onBlockClick:n._handleBlockClick,onReportClick:n._handleReportMenuItemClick,requestorScreenName:n._getTheOtherParticipantFromOneToOneConvo().screenName}):null,d.createElement(pt.a,{onPress:n._handleLeaveConversationClick,size:t,style:n._enableConsolidatedBlockAndReport?a?[Qi.actionFullWidth,Qi.actionMarginTop]:[Qi.actionHalfWidth,Qi.actionMarginLeft]:[Qi.actionHalfWidth,Qi.actionMarginRight],type:"destructiveSecondary"},Wi),d.createElement(pt.a,{onPress:n._handleAcceptConversation,size:t,style:n._enableConsolidatedBlockAndReport?[Qi.actionFullWidth,Qi.actionMarginTop]:[Qi.actionHalfWidth,Qi.actionMarginLeft],type:"secondary"},Ni))}))})),l()(i()(n),"_renderLeaveConfirmationSheet",(function(){return d.createElement(ut.a,{confirmButtonLabel:Gi.confirmButtonLabel,confirmButtonType:"destructive",headline:Gi.headline,onCancel:n._handleCancelLeave,onConfirm:n._handleConfirmLeave,text:Gi.text})})),l()(i()(n),"_renderBlockConfirmationSheet",(function(){var e=n._getTheOtherParticipantFromOneToOneConvo(),t=e.screenName,r=e.idStr;return d.createElement(ut.a,{confirmButtonLabel:Bi.a,confirmButtonType:"destructive",headline:Object(Bi.c)({screenName:t}),onCancel:n._handleBlockLeave,onConfirm:n._createBlockUserHandler(r),text:Object(Bi.b)({screenName:t})})})),l()(i()(n),"_scribeAction",(function(e){var t=n.props,r=t.scribeAction,a=t.scribeNamespace;r(Object.assign({},a,{action:e}),n._getScribeData())})),l()(i()(n),"_getScribeData",(function(){return{items:[{conversation_type:n.props.conversation.type===m.CONVERSATION_TYPE.GROUP?1:0}]}})),l()(i()(n),"_handleReportTextClick",(function(){n._scribeAction("report")})),l()(i()(n),"_handleReportMenuItemClick",(function(){var e=n.props,t=e.conversationId,r=e.history,a=e.scribeNamespace;t&&(n._scribeAction("report"),r.push(qi(t,window.location.pathname,a)))})),l()(i()(n),"_handleLeaveConversationClick",(function(){n.setState({showLeaveConfirmation:!0,showBlockConfirmation:!1})})),l()(i()(n),"_handleBlockClick",(function(){n.setState({showBlockConfirmation:!0,showLeaveConfirmation:!1})})),l()(i()(n),"_handleCancelLeave",(function(){n.setState({showLeaveConfirmation:!1})})),l()(i()(n),"_handleBlockLeave",(function(){n.setState({showBlockConfirmation:!1})})),l()(i()(n),"_handleConfirmLeave",(function(){var e=n.props,t=e.leaveConversation,r=e.conversation,a=e.conversationId,i=e.history,o=r.type===m.CONVERSATION_TYPE.GROUP?"leave_group":"delete_thread";n.setState({showLeaveConfirmation:!1}),t({conversationId:a}),n._scribeAction(o),i.goBack()})),l()(i()(n),"_handleAcceptConversation",(function(){var e=n.props,t=e.acceptConversation,r=e.conversationId;r&&(t(r),n._scribeAction("accept"))})),l()(i()(n),"_createBlockUserHandler",(function(e){return function(){var t=n.props,r=t.addToast,a=t.block,i=t.createLocalApiErrorHandler;n.setState({showBlockConfirmation:!1}),a(e).then((function(){r({actionLabel:Pi.c,onAction:n._createUnblockUserHandler(e),text:Pi.a}),n._handleConfirmLeave()}),i(Ci.a)),n._scribeAction("block")}})),l()(i()(n),"_createUnblockUserHandler",(function(e){return function(){var t=n.props,r=t.createLocalApiErrorHandler;(0,t.unblock)(e).catch(r(Li.a)),n._scribeAction("unblock")}})),l()(i()(n),"_getTheOtherParticipantFromOneToOneConvo",(function(){var e=n.props.conversation,t=n.context.loggedInUserId,r=Object(J.a)(e,t).map((function(e){return e.user})),a=r&&r[0];return{name:a&&a.name||"",screenName:a&&a.screen_name||"",idStr:a&&a.id_str||""}})),n.state={showLeaveConfirmation:!1,showBlockConfirmation:!1},n}s()(t,e);var n=t.prototype;return n.componentDidMount=function(){this._scribeAction("impression")},n.render=function(){var e=this.props.conversation,t=this.state,n=t.showBlockConfirmation,r=t.showLeaveConfirmation,a=(e&&e.type)===m.CONVERSATION_TYPE.GROUP;return d.createElement(d.Fragment,null,d.createElement(fe.a,{style:Qi.root},this._renderCopy(a),this._renderActionButtons(a)),Fi.a.isKaiOS()?d.createElement(_i.a,{leftText:Wi,onLeftClick:this._handleLeaveConversationClick,onRightClick:this._handleAcceptConversation,rightText:Ni}):null,r?this._renderLeaveConfirmationSheet():null,n&&this._enableConsolidatedBlockAndReport?this._renderBlockConfirmationSheet():null)},t}(d.PureComponent);l()(Vi,"contextType",Z.a);var Ki=function(e){var t=e.isGroup,n=e.isMobileLayout,r=e.onBlockClick,a=e.onReportClick,i=e.requestorScreenName,o=n?Qi.actionFullWidth:[Qi.actionHalfWidth,Qi.actionMarginRight],s={backgroundColor:"transparent",borderColor:"deepGray",color:"deepGray",size:"normal"};if(t)return d.createElement(fe.a,{style:o},d.createElement(pt.a,Dt()({},s,{onPress:a}),Di));var c=d.createElement(pt.a,Dt()({},s,{renderMenu:n?function(e){return d.createElement(mn.a,{onMaskClick:e,type:"bottom",withKeyboardNavigation:!0,withMask:!0},d.createElement(ki,{dismiss:e,flatBorders:!0,onBlockClick:r,onReportClick:a,requestorScreenName:i,showCancel:!0}))}:void 0}),ji);return d.createElement(fe.a,{style:o},n?c:d.createElement(Xe.a,{enableEnterKeyToggle:!0,preferredVerticalOrientation:"up",renderContent:function(e){return d.createElement(ki,{dismiss:e,onBlockClick:r,onReportClick:a,requestorScreenName:i})}},c))},Qi=te.a.create((function(e){return{root:{backgroundColor:e.colors.cellBackground,borderColor:e.colors.borderColor,borderTopStyle:"solid",borderTopWidth:"1px",paddingVertical:e.spaces.medium,paddingHorizontal:e.componentDimensions.gutterHorizontal},copy:{paddingBottom:e.spaces.medium},reportlink:{marginLeft:e.spaces.xxSmall},actionsContainer:{display:"flex",flexWrap:"wrap",flexDirection:"row"},actionFullWidth:{width:"100%"},actionHalfWidth:{width:"calc(50% - "+e.spaces.xxSmall+")"},actionMarginRight:{marginRight:e.spaces.xxSmall},actionMarginLeft:{marginLeft:e.spaces.xxSmall},actionMarginTop:{marginTop:e.spaces.xSmall}}})),Yi=Object(B.c)({element:"untrusted_interstitial"})(Mi(Vi)),Xi=n("rFBM"),Ji=n("jTgF"),Zi=n("+d3d"),$i=Ae.a.badb01a0,eo=Ae.a.d6b11d9c,to=Ae.a.i7ca1446,no=function(e){return e&&(e.tweet||e.media)},ro=function(e){var t,n=e.gifMetadata,r=void 0===n?{}:n,a=e.tweetAttachment,i=e.media;return a?t={tweet:a}:i?i.mediaFile?t={media:i}:i.externalMediaDetails&&(t={media:i,provider:r.provider,gifUrl:r.url}):t=null,t},ao=function(e){function t(t){var n;return n=e.call(this,t)||this,l()(i()(n),"_composer",d.createRef()),l()(i()(n),"_handleLivePipelineUpdate",(function(){n._fetchUpdatesIfNeeded(),n._updatePolling&&n._updatePolling.restart()})),l()(i()(n),"_fetchUpdatesIfNeeded",(function(){var e=n.props,t=e.conversationId,r=e.createLocalApiErrorHandler;(0,e.fetchUpdatesIfNeeded)(e.isDmReceiptSettingEnabled?{active_conversation_id:t,dm_users:!0}:{}).catch(r())})),l()(i()(n),"_handleInitialFetch",(function(){n._initialFetch()})),l()(i()(n),"_initialFetch",(function(){var e=n.props,t=e.conversationId,r=e.createLocalApiErrorHandler,a=e.fetchInboxIfNeeded,i=e.fetchUpdatesIfNeeded;return a().then((function(){if(t)return n._fetchConversation(t).then((function(){return n._requestWelcomeMessage(t)}))})).then((function(){return i()})).catch(r()).finally((function(){n._updatePolling&&n._updatePolling.start()}))})),l()(i()(n),"_isUntrustedConversation",(function(e){var t=n.props.isNewGroupConversation;return!(null==e?void 0:e.trusted)&&!t})),l()(i()(n),"_leaveConversation",(function(e){var t=n.props,r=t.createLocalApiErrorHandler;(0,t.leaveConversation)(e).catch(r({showToast:!0}))})),l()(i()(n),"_acceptConversation",(function(e){var t=n.props,r=t.acceptConversation,a=t.createLocalApiErrorHandler;r(e).then((function(){Fi.a.isMobileOS()&&n._fetchConversation(e)})).catch(a({showToast:!0}))})),l()(i()(n),"_renderActions",(function(){var e=n.props,t=e.conversation,r=e.conversationId,a=e.history,i=e.scribeAction;return t&&n._isUntrustedConversation(t)?t.read_only?null:r&&d.createElement(Yi,{acceptConversation:n._acceptConversation,conversation:t,conversationId:r,history:a,leaveConversation:n._leaveConversation,scribeAction:i}):d.createElement(d.Fragment,null,n._renderComposerBar(),Fi.a.isKaiOS()?d.createElement(_i.a,{leftText:to,onLeftClick:n._handleInfoClick,onRightClick:n._handleComposeClick,rightText:$i}):null)})),l()(i()(n),"_render",(function(){var e=n.props,t=e.conversation,r=e.isWide,a=e.perspective,i=e.scribeNamespace,o=n.state,s=o.attachment,c=o.composerHeight;return d.createElement(Xi.a,{allowDragDrop:!no(s),onFilesAdded:n._handleDragDrop,style:io.dragDrop},d.createElement(Za.a,{style:[io.scrollView,!Object(bi.a)()&&!n._isUntrustedConversation(t)&&{bottom:c}]},a&&t?d.createElement(si,{conversation:t,isWide:r,onHistoryRequest:n._handleHistoryRequest,perspective:a,scribeNamespace:i,style:io.activity}):null),n._renderActions())})),l()(i()(n),"_handleNavHeightChange",(function(e){n.setState({composerHeight:e+"px"})})),l()(i()(n),"_handleTyping",(function(){n._throttleSaveDraftText(),n._throttleUpdateTyping()})),l()(i()(n),"_throttleUpdateTyping",Object(Zi.a)((function(){var e=n.props,t=e.conversationId,r=e.createLocalApiErrorHandler,a=e.updateTyping;t&&a({conversationId:t}).catch(r())}),2e3,{trailing:!1})),l()(i()(n),"_throttleSaveDraftText",Object(Zi.a)((function(){n.props.conversationId&&n._handleSaveDraftText()}),1e3,{leading:!1})),l()(i()(n),"_handleDragDrop",(function(e){n._composer.current&&n._composer.current._handleAddMediaFiles(e)})),l()(i()(n),"_handleHistoryRequest",(function(){var e=n.props,t=e.conversationId,r=e.fetchConversationHistory,a=e.createLocalApiErrorHandler;r({conversationId:t}).catch(a())})),l()(i()(n),"_handleSendMessage",(function(e,t){var r=n.props,a=r.addToast,i=r.cardUrl,o=r.conversationId,s=r.createLocalApiErrorHandler,c=r.gifMetadata,l=r.history,d=r.location,u=r.newConversationParticipants,p=r.perspective,m=r.scribeAction,f=r.scribeNamespace,h=r.sendMessage,v=r.tweetAttachment;return e.emoji||e.quickReply||(n._composer.current&&n._composer.current.clear(),n._composer.current&&n._composer.current.focus()),c&&m(Object.assign({},f,{element:"remote",action:"send_gif_dm"})),m(v?Object.assign({},f,{action:"send_tweet_dm"}):Object.assign({},f,{action:"send_dm"})),o?(n.state.attachment&&(n.setState({attachment:null}),l.replace(d.pathname)),h(Object.assign({senderId:p,cardUrl:i,conversationId:o,text:t,tweetAttachment:v},e.quickReply&&{quickReply:e.quickReply})).catch((function(e){if(!Object(Ji.d)(e)||e.code!==mi.b.CANCELED)if(Object(Ji.d)(e)){var t=Object(Ji.b)(e,eo);t&&a(t)}else s(hi.b)(e)}))):(h({senderId:p,recipients:u&&u.map((function(e){return e.data.id_str})),text:t,tweetAttachment:v}).then((function(e){n.setState({attachment:null}),l.replace("/messages/"+e)}),s(hi.b)),Promise.resolve())})),l()(i()(n),"_handlePopOutConvo",(function(){var e=n.props,t=e.conversationId;(0,e.popOutConversation)(t)})),l()(i()(n),"_handleInfoClick",(function(){var e=n.props,t=e.history,r=e.conversationId;r&&t.push("/messages/"+r+"/info")})),l()(i()(n),"_handleComposeClick",(function(){n._composer.current&&n._composer.current.focus()})),l()(i()(n),"_handleSaveDraftText",(function(){var e=n.props,t=e.conversationId,r=e.saveText;t&&n._composer.current&&r(t,n._composer.current.value())})),n.state={attachment:ro(t),composerHeight:te.a.theme.componentDimensions.appBarHeight},n._showDMQuickAccess=hr.a.isTrue("responsive_web_dm_quick_access_enabled"),n}s()(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.googleAnalyticsPageView,n=e.scribeNamespace,r=e.scribePageImpression,a=e.updateTweetDetailNav;return r(n),a(n),t(n),this._initializePolling({interval:3e3}),this._initializeLivePipeline(),this._focusComposerIfNeeded(),this._initialFetch()},n._focusComposerIfNeeded=function(){var e=this;gi()((function(){return Object(ui.a)().then((function(t){var n=t.detectedType,r=t.KEYBOARD,a=t.MOUSE,i=e.props.quickReplyOptions;(n(r)||n(a))&&!i&&e._composer.current&&e._composer.current.focus()}))}))},n._initializeLivePipeline=function(){var e=this,t=this.props.conversationId;Object(u.h)().then((function(n){var r=n.LivePipeline;t&&r.isSupportedAndReady()&&hr.a.isTrue("livepipeline_dm_features_enabled")&&!e._livePipelineSubscription&&(e._livePipelineSubscription=r.get().subscribeTopic("/dm_update/"+t,e._handleLivePipelineUpdate),e._initializePolling({interval:1e4}))}))},n._initializePolling=function(e){var t=e.interval;this._updatePolling&&this._updatePolling.stop(),this._updatePolling=new yi.a(this._fetchUpdatesIfNeeded,{interval:t})},n.componentWillUnmount=function(){var e=this.props,t=e.conversation,n=e.conversationId,r=e.removeConversation,a=(null==t?void 0:t.entries)||[];this._updatePolling&&this._updatePolling.stop(),this._updatePolling=void 0,this._livePipelineSubscription&&this._livePipelineSubscription.teardown(),0===a.length&&r(n),1===a.length&&"welcome_message_create"===a[0].type&&r(n)},n.componentDidUpdate=function(e,t){var n,r=this.props,a=r.conversationId,i=r.conversation,o=r.isLoaded,s=r.isUploading,c=r.quickReplyOptions,l=r.updateConversationReadState;a!==e.conversationId?(a&&this._fetchConversation(a),this._focusComposerIfNeeded(),this._livePipelineSubscription&&this._livePipelineSubscription.teardown(),this._initializeLivePipeline()):((null==i?void 0:i.sort_event_id)!==(null===(n=e.conversation)||void 0===n?void 0:n.sort_event_id)&&l(a),s||!e.isUploading||c||this._composer.current&&this._composer.current.focus(),e.isLoaded&&!o&&a&&this._fetchConversation(a))},n.UNSAFE_componentWillReceiveProps=function(e){var t=this.props.media,n=e.media;Object(ue.a)(t,n)||this.setState({attachment:ro(e)})},n.render=function(){var e=this.props.fetchStatus;return d.createElement(ti.a,{style:[io.root,Fi.a.isKaiOS()&&io.kaiOSFix]},d.createElement(di.a,{fetchStatus:e,onRequestRetry:this._handleInitialFetch,render:this._render}))},n._renderComposerBar=function(){var e=this.props,t=e.addMedia,n=e.cardUrl,r=e.conversation,a=e.conversationId,i=e.dataSaverMode,o=e.draftText,s=e.dtabBarInfo,c=e.history,l=e.isUploading,u=e.mediaMetadata,p=e.mediaUploadProgress,m=e.quickReplyOptions,f=e.removeMedia,h=e.richTextInputContext,v=e.scribeNamespace,g=e.typeaheadWrapper,b=this.state.attachment,_=this.props.prefillText||o,y=!Object(bi.a)();return(null==r?void 0:r.read_only)?null:d.createElement(li.a,{attachment:b,conversationId:a,disabled:l,dtabBarInfo:s,history:c,isCardPreviewTombstoned:Object(pi.c)(n),isUploading:l,key:a,mediaMetadata:u,mediaUploadProgress:p,onAddMedia:t,onBlur:this._handleSaveDraftText,onHeightChange:this._handleNavHeightChange,onSend:this._handleSendMessage,onTyping:i?this._throttleSaveDraftText:this._handleTyping,prefillText:"string"==typeof _?_:void 0,quickReplyOptions:m,ref:this._composer,removeMedia:f,richTextInputContext:h,scribeNamespace:v,style:[!y&&io.offsetBottom],typeaheadWrapper:g})},n._fetchConversation=function(e){var t=this.props,n=t.createLocalApiErrorHandler,r=t.fetchConversationIfNeeded,a=t.updateConversationReadState;return r({conversationId:e}).then((function(){return a(e)})).catch(n(Object(P.a)(e)))},n._requestWelcomeMessage=function(e){var t=this.props,n=t.addWelcomeMessageToConversation,r=t.createLocalApiErrorHandler,a=t.conversation,i=t.location,o=i.query.text,s=Array.isArray(i.query.welcome_message_id)?i.query.welcome_message_id[0]:i.query.welcome_message_id,c=!!this.state.attachment||!(!o||s),l=!a||!a.type||a.type===m.CONVERSATION_TYPE.GROUP,d=a&&a.participants&&Object.keys(a.participants).length<=1;return c||l||d?Promise.resolve():n(e,s).catch(r({showToast:!1}))},t}(d.PureComponent);l()(ao,"defaultProps",{isNewGroupConversation:!1,typeaheadWrapper:fi.a});var io=te.a.create((function(e){return{root:{flexGrow:1},activity:{flexBasis:"1px",flexGrow:1,height:"100%"},kaiOSFix:{paddingBottom:20},dragDrop:{flexGrow:1},scrollView:{flexGrow:1},infoButton:{marginRight:e.spaces.xxSmall},offsetBottom:{paddingBottom:te.a.iPhoneOffsetBottom}}}));t.a=Object(B.c)()(F(ao))},"X/yg":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=function(e,t){return t.location&&t.location.state&&t.location.state.tweetAttachment},a=function(e,t){return t.location&&t.location.state&&t.location.state.participants},i=function(e,t){return t.location&&t.location.state&&t.location.state.isNewGroupConversation},o=function(e){var t=e.message_data,n="text_bubble",r=t&&t.attachment||{};return r.tweet?n="tweet":r.photo?n="photo":r.animated_gif?n="gif":r.video?n="video":r.card&&(n="card"),n}},XnpN:function(e,t,n){"use strict";n("2G9S"),n("tQbP");var r=n("RhWx"),a=n.n(r),i=n("aWyx"),o=(n("LW0h"),n("z84I"),n("6U7i"),n("t0aI")),s=function(e){return void 0===e&&(e=0),new Date(Number(e))},c=function(e,t){return s(e.join_time)-s(t.join_time)},l=function(e,t){var n=e.user,r=t.user;return Object(o.a)(n.id_str,r.id_str)},d=function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n){return t.map((function(t){return t(e,n)})).filter((function(e){return!!e}))[0]||0}}(function(e){return function(t,n){var r=t.user,a=n.user;switch(e){case r.id_str:return-1;case a.id_str:return 1;default:return 0}}}(e),c,l)},u=n("tn7R"),p=n("VIKJ");t.a=function(e,t){var n=e.participants,r=e.type,o=e.created_by_user_id,s=Object(u.a)(n),c=Object(p.a)(s,(function(e){return e.user.id_str===t})),l=c[0],m=c[1];return m.length?r===i.a.GROUP&&1===m.length?[].concat(a()(l),a()(m)):o?m.sort(d(o)):m:l}},aA19:function(e,t,n){"use strict";n("z84I"),n("M+/F"),n("hBvt"),n("uFXj");var r=n("W/Kd"),a=n.n(r),i=n("ERkP"),o=n("aWyx"),s=n("XnpN"),c=n("rHpw"),l=n("9Xij"),d=n("cm6r"),u=n("TIdA"),p=n("A91F"),m=n("oSwX"),f=n("D4le"),h=n.n(f),v=n("3xO4"),g=n.n(v),b=c.a.create((function(e){return{root:{borderRadius:e.borderRadii.infinite,overflow:"hidden"},container:{height:"auto",overflow:"hidden",width:"100%"},image:{borderRadius:0}}})),_=c.a.create((function(e){return{container:{flexDirection:"row"},left:{flex:1},right:{flex:1,marginLeft:e.borderWidths.small,marginRight:"calc(-1 * "+e.borderWidths.small+")"}}})),y=c.a.create((function(e){return{container:{flexDirection:"column"},top:{flex:1,marginBottom:e.borderWidths.small},bottom:{flex:1}}})),C=function(e){var t=e.left,n=e.right;return i.createElement(g.a,{style:_.container},i.createElement(g.a,{style:_.left},t),i.createElement(g.a,{style:_.right},n))},E=function(e){var t=e.top,n=e.bottom;return i.createElement(g.a,{style:y.container},i.createElement(g.a,{style:y.top},t),i.createElement(g.a,{style:y.bottom},n))},S=function(e){function t(){return e.apply(this,arguments)||this}a()(t,e);var n=t.prototype;return n.render=function(){var e=this.props,t=e.link,n=e.conversation,r=e.perspective,a=n&&n.avatar_image_https,o=n?Object(s.a)(n,r).map((function(e){return e.user})):[],c=o.slice(0,3),u=this._avatarFromGroup(n)||this._avatarFromSrc(a)||this._avatarFromParticipants(c),p=t||this._defaultLink(n,o);return u?i.createElement(l.a,{ratio:1,style:b.root},p?i.createElement(d.a,{interactiveStyles:null,link:p},u):u):null},n._defaultLink=function(e,t){if(e)return e.type===o.a.GROUP?"/messages/"+e.conversation_id+"/participants":e.type===o.a.ONE_TO_ONE?"/"+t[0].screen_name:void 0},n._avatarFromGroup=function(e){var t=e&&e.avatar&&e.avatar.image&&e.avatar.image.original_info;return t?i.createElement(u.a,{accessibilityLabel:"",aspectMode:p.a.SQUARE,backgroundColor:c.a.theme.colors.fadedGray,image:t,rounded:!0}):null},n._avatarFromSrc=function(e){return e?i.createElement(h.a,{source:e}):null},n._avatarFromParticipants=function(e){var t=e.length;return 0===t?null:1===t?this._singleParticipantAvatar(e[0]):this._multipleParticipantAvatar(e)},n._singleParticipantAvatar=function(e){var t=this.props.size;return i.createElement(g.a,{key:e.id_str,style:b.container},i.createElement(m.default,{importantForAccessibility:"no-hide-descendants",size:t||"xxLarge",style:b.image,uri:e.profile_image_url_https}))},n._multipleParticipantAvatar=function(e){var t=e.length,n=e.map((function(e,n){var r=2===t||3===t&&0===n?.5:1;return i.createElement(g.a,{key:e.id_str,style:b.container},i.createElement(m.default,{aspectRatio:r,circle:!1,importantForAccessibility:"no-hide-descendants",size:"custom",style:b.image,uri:e.profile_image_url_https}))}));if(2===t)return i.createElement(C,{left:n[1],right:n[0]});var r=i.createElement(E,{bottom:n[2],top:n[1]}),a=n[0];return i.createElement(C,{left:r,right:a})},t}(i.Component);t.a=S},b5s6:function(e,t,n){"use strict";var r=n("ERkP"),a=n("rxPX"),i=n("P1r1"),o=n("XOJV"),s=function(e,t){return t.tweetId},c=Object(a.a)().propsFromState((function(){return{mediaPreviewsEnabled:i.r,tweet:o.a.createHydratedTweetSelector(s)}})),l=n("VoLI"),d=c((function(e){var t=e.dmType,n=e.mediaPreviewsEnabled,a=e.style,i=e.tweet,o=e.onPress;return r.createElement(l.a,{dmType:t,onPress:o,style:a,tweet:i,withInlineMedia:n})}));t.a=d},b9JY:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return l}));n("vrRf");var r=n("aWyx"),a=function(e){return e&&e.type===r.b.MESSAGE},i=function(e){return e&&e.type===r.b.WELCOME_MESSAGE},o=function(e){return e&&e.type===r.b.TRUST_CONVERSATION},s=function(e){return e&&e.type===r.b.REACTION_CREATE},c=[r.b.CONVERSATION_AVATAR_UPDATE,r.b.CONVERSATION_NAME_UPDATE,r.b.JOIN_CONVERSATION,r.b.PARTICIPANTS_JOIN,r.b.PARTICIPANTS_LEAVE],l=function(e){return e&&c.indexOf(e.type)>-1}},c2p2:function(e,t,n){"use strict";n("LW0h"),n("z84I"),n("M+/F");var r=n("ERkP"),a=n("3xO4"),i=n.n(a),o=n("oSwX"),s=n("rHpw"),c=function(e){var t=e.users.slice(0,e.maxItems).filter((function(e){return!!e}));return r.createElement(i.a,{style:[l.root,"center"===e.align&&l.rootCenter,e.style]},t.map((function(t,n){return r.createElement(o.default,{importantForAccessibility:"no-hide-descendants",key:n,screenName:t.screen_name,size:"large",style:[l.item,0===n&&"left"===e.align&&l.itemLeftFirst],uri:t.profile_image_url_https,withHoverCard:!0,withLink:!0})})))};c.defaultProps={align:"left",maxItems:5};var l=s.a.create((function(e){return{root:{flexWrap:"wrap",flexDirection:"row",overflow:"hidden",height:e.spaces.large},rootCenter:{justifyContent:"center"},item:{marginHorizontal:e.spaces.xxSmall},itemLeftFirst:{marginLeft:0}}}));t.a=c},g54k:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));n("KOtZ");var r=n("oEGd"),a=n("hqKg"),i=(n("2G9S"),n("LW0h"),n("z84I"),n("s1N3")),o=function(e){var t=e.sender_id,n=e.by_user_id,r=e.participants,a=void 0===r?[]:r;return Object(i.a)(a.map((function(e){return e.user_id})).concat([t,n]).filter(Boolean))},s=n("G6rE"),c=function(e,t){return{users:o(t).reduce((function(t,n){return t[n]=e[n],t}),{})}},l=Object(a.createSelector)(s.e.selectAll,(function(e,t){return t.entry}),c);t.a=Object(r.c)(l)},"n+Zb":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r=function(e){return{id:e,distanceToViewportTop:0}},a=function(e){return{id:e,distanceToViewportBottom:0}}},p9G8:function(e,t,n){"use strict";n.d(t,"b",(function(){return p}));n("LW0h"),n("z84I"),n("M+/F"),n("ho0z"),n("+KXO");var r=n("aWyx"),a=n("XnpN"),i=n("3XMw"),o=n.n(i),s=r.a.GROUP,c=o.a.g755fcde,l=o.a.f6b1ff81,d=o.a.d27cf5ef,u=o.a.i3b60816;t.a=function(e,t){var n=e.type,r=e.name,i=e.participants,o=void 0===i?{}:i;if(n===s&&r)return r;if(Object.keys(o).length){var c=Object(a.a)(e,t).map((function(e){return e.user}));return p(c,t,n)}};var p=function(e,t,n){void 0===e&&(e=[]),void 0===n&&(n=s);var r=e.filter((function(e){return e.id_str!==t})),a=r[0],i=r.slice(1);switch(r.length){case 0:return c;case 1:return n===s?l({name:a.name}):a.name;case 2:return d({name1:a.name,name2:i[0].name});default:return u({name:a.name,count:i.length})}}},prG5:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));n("2G9S");var r=n("97Jx"),a=n.n(r),i=n("LdEA"),o=n.n(i),s=n("1Pcy"),c=n.n(s),l=n("W/Kd"),d=n.n(l),u=n("KEM+"),p=n.n(u),m=n("ERkP"),f=(n("aWzz"),n("nT9l")),h=n("3XMw"),v=n.n(h),g=n("TIdA"),b=n("a6qo"),_=v.a.f93bb3ee,y=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=e.call.apply(e,[this].concat(r))||this,p()(c()(t),"_renderContent",(function(e){var n=e.useMinimumData,r=e.resourceSelectionHandler,i=t.props,s=(i.hideAcceptOverlay,i.shouldShowAltLabel),c=o()(i,["hideAcceptOverlay","shouldShowAltLabel"]);return m.createElement(m.Fragment,null,m.createElement(g.a,a()({},c,{onVariantSelection:r,previewMode:n})),s?m.createElement(b.a,{align:"left",bold:!0},"ALT"):null)})),t}return d()(t,e),t.prototype.render=function(){var e=this.props,t=e.image,n=e.hideAcceptOverlay;return m.createElement(f.a,{acceptLabel:_,hideAcceptOverlay:n,renderContent:this._renderContent,resourceId:"string"==typeof t?t:t.url})},t}(m.Component)},"r/+w":function(e,t,n){"use strict";n("IAdD"),t.__esModule=!0,t.default=void 0;var r=o(n("7DT3")),a=o(n("ERkP")),i=o(n("OkZJ"));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e){return void 0===e&&(e={}),(0,r.default)("svg",Object.assign({},e,{style:[i.default.root,e.style],viewBox:"0 0 24 24"}),a.default.createElement("g",null,a.default.createElement("path",{d:"M21.13 11.358L3.614 2.108c-.29-.152-.64-.102-.873.126-.23.226-.293.577-.15.868l4.362 8.92-4.362 8.92c-.143.292-.08.643.15.868.145.14.333.212.523.212.12 0 .24-.028.35-.087l17.517-9.25c.245-.13.4-.386.4-.664s-.155-.532-.4-.662zM4.948 4.51l12.804 6.762H8.255l-3.307-6.76zm3.307 8.26h9.498L4.948 19.535l3.307-6.763z"})))};s.metadata={height:24,width:24};var c=s;t.default=c},uB9N:function(e,t,n){"use strict";n("z84I"),n("IAdD"),n("7x/C"),n("DZ+c"),n("tVqn"),n("uFXj");var r=n("Y9Ll"),a=n.n(r),i=n("1Pcy"),o=n.n(i),s=n("W/Kd"),c=n.n(s),l=n("KEM+"),d=n.n(l),u=n("ERkP"),p=n("oocy"),m=n.n(p),f=n("1YZw"),h=n("rxPX"),v=n("zh9S"),g=n("P1r1"),b=n("AspN"),_=Object(h.a)().propsFromState((function(){return{dataSaverMode:g.j}})).propsFromActions((function(){return{addMedia:b.b,addToast:f.b,processMultipleMedia:b.d,removeMediaUpload:b.e,scribeAction:v.c,uploadMedia:b.k}})),y=n("wpu3"),C=(n("1t7P"),n("jQ/y"),n("2G9S"),n("HPNB")),E=n("3xO4"),S=n.n(E),x=n("1oWZ"),R=n("t62R"),w=n("rHpw"),I=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,d()(o()(t),"_handleClick",(function(){var e=t.props,n=e.id,r=e.label;(0,e.onClick)({id:n,label:r})})),t}return c()(t,e),t.prototype.render=function(){var e=this.props,t=e.description,n=e.label,r=e.isWide;return u.createElement(x.a,null,u.createElement(S.a,{accessibilityRole:"button",onClick:this._handleClick,style:[A.root,r&&A.isWide,!r&&A.isNarrow]},u.createElement(R.c,{weight:"bold"},n),u.createElement(R.c,{color:"deepGray",size:"small"},t)))},t}(u.Component),A=w.a.create((function(e){return{root:{backgroundColor:e.colors.cellBackground,borderColor:e.colors.borderColor,borderStyle:"solid",paddingLeft:"1rem",paddingVertical:"1rem"},isWide:{borderRadius:e.borderRadii.large,paddingVertical:"0.5rem",borderWidth:e.borderWidths.small},isNarrow:{borderTopWidth:e.borderWidths.small}}})),O=I,T=n("cHvH"),k=n("mw9i"),M=(n("aWzz"),function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,d()(o()(t),"_handleOptionChoose",(function(e){var n=t.props;return(0,n.onOptionChoose)(n.quickReplyOptions.id,e)})),t}c()(t,e);var n=t.prototype;return n.render=function(){var e=this,t=this.props.quickReplyOptions.options,n=1===t.length;return u.createElement(T.a,null,(function(r){var a=r.windowWidth,i=C.a.isTwoColumnLayout(a),o=[i&&L.isWide,i&&n&&L.oneButtonOnly,!i&&L.isNarrow];return u.createElement(k.a,{style:o,withGutter:i},t.map((function(t){return e.renderOption(t,i)})))}))},n.renderOption=function(e,t){return u.createElement(O,{description:e.description,id:e.id,isWide:t,key:e.id,label:e.label,onClick:this._handleOptionChoose})},t}(u.Component)),L=w.a.create((function(e){return{oneButtonOnly:{gridTemplateColumns:"1fr"},isWide:{backgroundColor:e.colors.faintGray,display:"grid",gridColumnGap:e.spaces.xSmall,gridRowGap:e.spaces.xSmall,gridTemplateColumns:"1fr 1fr",paddingVertical:e.spaces.xSmall},isNarrow:{maxHeight:"168px",overflow:"auto"}}})),F=M,B=n("krmn"),P=n("JYMr"),D=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,d()(o()(t),"state",{currentStepIndex:-1}),t}c()(t,e);var n=t.prototype;return n.componentDidMount=function(){this._scheduleNextStep(0)},n.componentWillUnmount=function(){this._currentTimeoutId&&clearTimeout(this._currentTimeoutId)},n.render=function(){var e=this.props.steps,t=this.state.currentStepIndex,n=t>=0&&t<e.length?e[t].progress:0;return u.createElement(P.a,{progress:n})},n._scheduleNextStep=function(e){var t=this,n=this.props.steps;e<n.length&&(this._currentTimeoutId=setTimeout((function(){t._currentTimeoutId=void 0,t.setState({currentStepIndex:e}),t._scheduleNextStep(e+1)}),n[e].waitMs))},t}(u.Component);d()(D,"defaultProps",{steps:[{waitMs:1e3,progress:.1},{waitMs:1400,progress:.3},{waitMs:1800,progress:.5},{waitMs:2400,progress:.6},{waitMs:3e3,progress:.9}]});var j=n("wrlS"),N=n("cIoY"),W=n("w3n3"),U=n("MLl7"),H=n("3XMw"),z=n.n(H),G=n("+Yfw"),q=n.n(G),V=n("1DfR"),K=n.n(V),Q=n("r/+w"),Y=n.n(Q),X=n("J2UM"),J=n("VPdC"),Z=n("pKoL"),$=n("eyty"),ee=n("oQhu"),te=n("Dtul"),ne=n("Es6L"),re="dmComposerTextInput",ae="dmComposerSendButton",ie=n("GZwR"),oe=n("aITJ"),se=n("6OUF"),ce=n("9Xij"),le=n("/yvb"),de=n("0FVZ"),ue=n("gpVt"),pe=z.a.ee230734,me=z.a.ca0ce0e4,fe=z.a.cdcebd22,he=z.a.e3275464,ve=z.a.ic8c615d,ge=z.a.a04077c4,be=function(e){return!(!e||!e.media)},_e=Object(y.b)({maxNumberOfPhotos:1}),ye=u.createElement(Y.a,null),Ce=function(e){function t(t,n){var r;r=e.call(this,t,n)||this,d()(o()(r),"_handleLayout",(function(e){var t=r.props.onHeightChange,n=r.state.mediaButtonsCollapsible,a=e.nativeEvent.layout;a&&(Object(ne.a)()||t&&t(a.height),a.width<=w.a.theme.breakpoints.small&&j.a.isTrue("responsive_web_dm_composer_media_toggle_enabled")&&!n?r.setState({mediaButtonsCollapsible:!0}):a.width>w.a.theme.breakpoints.small&&n&&r.setState({mediaButtonsCollapsible:!1}))})),d()(o()(r),"_renderQuickReplyPicker",(function(){var e=r.props.quickReplyOptions,t=r.state.isQuickReplyOpen;return e&&t?u.createElement(F,{onOptionChoose:r._handleQROptionSelection,quickReplyOptions:e}):null})),d()(o()(r),"_renderComposeBox",(function(){return u.createElement(S.a,{style:Ee.composeBoxContainer},r._renderMainContent())})),d()(o()(r),"_renderMainContent",(function(){var e=r.props.typeaheadWrapper,t=r.state.value,n=e;return n?u.createElement(n,{contextText:t,isInline:!0,onTextUpdated:r._handleTextChange,onTypeaheadStateChange:r._handleTypeaheadStateChange,source:ie.d.ComposeMessage},r._renderFieldTextInput):r._renderFieldTextInput()})),d()(o()(r),"_renderFieldTextInput",(function(e){var t=r.props,n=t.disabled,a=t.placeholderText,i=t.richTextInputContext,o=oe.a.isKaiOS()?fe:a||me,s=r.state,c=s.editorState,l=s.value,d=!!i,p=i?{editorState:c,element:i.element}:void 0;return u.createElement(se.a,{contentAbove:r._renderAttachments(),editable:!n,emojiPickerButton:r._renderEmojiPicker(),handleReturn:d?r._handleReturn:void 0,inputStyle:Ee.composeTextInput,maxNumberOfLines:d?8:4,multiline:!0,numberOfLines:1,onBlur:r._handleOnBlur,onChange:e?r._getHandleChange(e):r._handleTextChange,onFilesAdded:r._handleAddMediaFiles,onFocus:r._handleTextInputFocus,onKeyPress:d?void 0:r._handleReturn,placeholder:o,ref:r._setTextInputRef,richTextInputContext:p,style:Ee.composeInput,testID:re,useCacheForDOMMeasurements:!r._isSendDisabled(),value:l})})),d()(o()(r),"_getHandleChange",Object(ee.a)((function(e){return function(t){e(t),r._handleTextChange(t)}}))),d()(o()(r),"_handleTypeaheadStateChange",(function(e){r.setState({isTypeaheadActive:e})})),d()(o()(r),"_renderAttachments",(function(){var e=r.props,t=e.attachment,n=e.conversationId,a=e.isCardPreviewTombstoned,i=e.isShareViaDM,o=e.isUploading,s=e.mediaMetadata,c=r.state.value,l=t&&(t.media&&t.media.mediaFile||t.provider&&t.media&&t.media.externalMediaDetails)||{},d=l.height,p=l.width,m=null==t?void 0:t.media,f=m&&m.id.toString(),h=s&&f&&s[f]&&s[f].altText,v=s&&f&&s[f]&&s[f].defaultAltText,g=Object(ue.b)(c);return u.createElement(u.Fragment,null,m?u.createElement(S.a,{style:Ee.attachmentContainer},u.createElement(ce.a,{ratio:p/d,style:Ee.aspectContainer},u.createElement(S.a,{style:Ee.mediaPreviewContainer},u.createElement(Z.a,{accessibilityLabel:h||v,mediaItem:m,onClick:r.canEditImage?r._handleClickMediaDetail:void 0,onEdit:r.canEditImage?r._handleClickMediaDetail:void 0,onRemove:r._handleRemoveMedia(m.id),resizeIfNeeded:"width",style:[Ee.mediaPreview],withAltTextLabel:!!h,withCloseButton:!o,withEditButton:r.canEditImage&&!o}))),t&&t.provider&&t.gifUrl&&u.createElement(S.a,{style:Ee.gifAttribution},u.createElement(N.a,{gifUrl:t.gifUrl,provider:t.provider}))):g&&!i?u.createElement(ue.a,{conversationId:n,isCardPreviewTombstoned:a,style:Ee.cardPreviewContainer,urls:g}):null)})),d()(o()(r),"_renderEmojiPicker",(function(){return r.props.withEmojiPicker&&oe.a.isDesktopOS()?u.createElement(B.a,{disabled:r.props.disabled,onEmojiSelect:r._handleEmojiSelect,onPress:r._handleTextInputFocus,size:"normalCompact",textInputRef:r._textInput||void 0}):null})),d()(o()(r),"_renderActionButton",(function(e){var t=r.props.quickReplyOptions,n=r._hasMessageText();return!t||n||e?u.createElement(le.a,{accessibilityLabel:he,disabled:r._isSendDisabled(),icon:ye,onPress:r._handleSend,size:"normal",style:Ee.actionButton,testID:ae,type:"text"}):r._renderQRToggleButton()})),d()(o()(r),"_renderQRToggleButton",(function(){var e=r.state.isQuickReplyOpen;return u.createElement(le.a,{accessibilityLabel:ve,icon:e?u.createElement(K.a,null):u.createElement(q.a,null),onPress:r._handleQuickReplyPickerToggle,size:"normal",style:Ee.actionButton,type:"text"})})),d()(o()(r),"_renderComposer",(function(){var e=r.props.attachment,t=be(e),n=r._renderComposeBox(),a=r._renderActionButton(t);return u.createElement(S.a,{style:[Ee.composer,t&&Ee.composerWithAttachment]},t?null:r._renderMediaButtons(),n,a)})),d()(o()(r),"_renderMediaButtons",(function(){var e=r.props,t=e.withGifPicker,n=e.withMediaPicker,a=r.state,i=a.mediaButtonsCollapsed,o=a.mediaButtonsCollapsible&&i;return u.createElement(S.a,{style:Ee.uploadButtons},o?u.createElement(le.a,{accessibilityLabel:pe,icon:u.createElement(m.a,null),onMouseDown:r._handleShowMediaControlsMouseDown,type:"text"}):null,n&&!o?r._renderMediaPicker():null,t&&!o?r._renderGifButton():null)})),d()(o()(r),"_handleShowMediaControlsMouseDown",(function(){var e=r.props,t=e.scribeAction,n=e.scribeNamespace;r.setState({mediaButtonsCollapsed:!1}),t(Object.assign({},n,{component:"dm_composer",element:"toggle",action:"expand"}))})),d()(o()(r),"_handleReturn",(function(e){var t=e.nativeEvent,n=t.ctrlKey,a=t.key,i=t.metaKey,o=t.shiftKey,s="Enter"===a;if(!r.state.isTypeaheadActive&&s&&r._keyboardOrMouseDetected&&!(o||i||n))return e.preventDefault(),r._handleSend(e),"handled"})),d()(o()(r),"_handleClickMediaDetail",(function(){var e=r.props,t=e.attachment,n=e.conversationId,a=e.history;if(r.canEditImage){var i=t&&t.media?t.media.id:0;a.push("/messages/compose/media",{mediaId:i,conversationId:n,tab:"crop"})}})),d()(o()(r),"_handleAddMediaFiles",(function(e){var t=r.props,n=t.addMedia,a=t.addToast,i=t.dataSaverMode,o=t.onAddMedia,s=t.processMultipleMedia,c=t.removeMediaUpload,l=t.removeMedia,d=t.uploadMedia;n(e,{location:$.c.Dm}).then((function(e){var t=e.map((function(e){return e.id}));r._validateMedia(e)?(o&&o(t),s(e,{onFailure:l}).then((function(e){i||d(e.map((function(e){return e.id})),{preUpload:!0})}))):(a({text:ge}),c(t))}))})),d()(o()(r),"_handleEmojiSelect",(function(e){var t=r.state.editorState,n=r.props.richTextInputContext;if(n){var a=n.insertTextAtCursor(t,e.text);r._handleTextChange(a)}})),d()(o()(r),"_handleRemoveMedia",(function(e){return function(){r.props.removeMedia&&r.props.removeMedia(e)}})),d()(o()(r),"_handleSend",(function(e){if(!r._isSendDisabled()){var t=r.props.onSend;r._textInput&&r._textInput.applyFinalValue((function(n){t(e,n)})),r._closeQuickReplyPicker()}})),d()(o()(r),"_handleTextChange",(function(e){var t,n=r.props,a=n.onTyping,i=n.richTextInputContext,o=r.state.value;if(i){var s=e.getCurrentContent().getPlainText(),c=i.convertEmojiToEntities(e);t=s,r.setState({editorState:c,value:t})}else t=e.target.value,r.setState({value:t});o!==t&&a&&a()})),d()(o()(r),"_handleOnBlur",(function(){var e=r.props.onBlur,t=r.state.mediaButtonsCollapsible;e&&e(),t&&j.a.isTrue("responsive_web_dm_composer_media_toggle_enabled")&&r.setState({mediaButtonsCollapsed:!1})})),d()(o()(r),"_handleTextInputFocus",(function(){var e=r.props.quickReplyOptions,t=r.state,n=t.isQuickReplyOpen,a=t.mediaButtonsCollapsible;e&&n&&r._closeQuickReplyPicker(),a&&j.a.isTrue("responsive_web_dm_composer_media_toggle_enabled")&&r.setState({mediaButtonsCollapsed:!0})})),d()(o()(r),"_handleQROptionSelection",(function(e,t){var n=r.props,a=n.onSend;n.disabled||(a({quickReply:{id:e,selected_id:t.id}},t.label),r._closeQuickReplyPicker())})),d()(o()(r),"_handleQuickReplyPickerToggle",(function(){r.setState({isQuickReplyOpen:!r.state.isQuickReplyOpen})})),d()(o()(r),"_validateMedia",(function(e){return!be(r.props.attachment)&&_e(e)})),d()(o()(r),"_detectKeyboardOrMouse",(function(e){(0,e.registerSome)((function(){r._keyboardOrMouseDetected=!0}),[e.KEYBOARD,e.MOUSE])})),d()(o()(r),"_isSendDisabled",(function(){var e=r.props,t=e.attachment,n=e.canSendEmptyMessage,a=e.disabled,i=e.isUploading,o=be(t),s=r._hasMessageText()||n,c=!(!t||!t.media)&&(t.media.needsProcessing||i);return a||!s&&!o||c||i})),d()(o()(r),"_hasMessageText",(function(){return!!(r.state.value||"").trim()})),d()(o()(r),"_closeQuickReplyPicker",(function(){r.setState({isQuickReplyOpen:!1})})),d()(o()(r),"_setTextInputRef",(function(e){r._textInput=e}));var a=t.richTextInputContext,i=t.prefillText,s=(a||{}).initEditorState;return r.state={isQuickReplyOpen:!0,value:i,editorState:s&&s(i),isTypeaheadActive:!1,mediaButtonsCollapsed:!1,mediaButtonsCollapsible:!1},r}c()(t,e);var n=t.prototype;return n.componentDidMount=function(){Object(X.a)().then(this._detectKeyboardOrMouse),this._unlockReload=te.a.acquire()},n.componentWillUnmount=function(){this._unlockReload()},n.componentDidUpdate=function(){this.props.quickReplyOptions&&this.state.isQuickReplyOpen&&this._textInput&&this._textInput.blur()},n.UNSAFE_componentWillReceiveProps=function(e){var t=this.props.quickReplyOptions,n=e.quickReplyOptions;t&&!n?this.setState({isQuickReplyOpen:!1}):(!t&&n||t&&n&&t.id!==n.id)&&this.setState({isQuickReplyOpen:!0}),this.props.conversationId!==e.conversationId&&this.clear()},n.render=function(){var e=this.props,t=e.dtabBarInfo,n=e.placeholderText,r=e.mediaUploadProgress,a=e.isSending,i=e.isUploading,o=e.style,s=n||me,c=Object(ne.a)()?u.Fragment:de.a.BottomComposer,l=Object(ne.a)()&&t&&(t.dtabAll||t.ttsToken)&&!t.hide;return u.createElement(c,null,u.createElement(S.a,{accessibilityLabel:s,accessibilityRole:"complementary",onLayout:this._handleLayout,style:[Ee.root,l&&Ee.dtabOffset,o]},a&&!i?u.createElement(D,null):u.createElement(P.a,{progress:a?Math.max(r,.02):0}),this._renderComposer(),this._renderQuickReplyPicker()))},n._renderMediaPicker=function(){return u.createElement(J.a,{onChange:this._handleAddMediaFiles,style:Ee.mediaPicker,type:"text"})},n._renderGifButton=function(){var e=this.props,t=e.conversationId,n=e.history;return u.createElement(W.a,{dmConversationId:t,enabled:!0,gifSearchKeySource:U.a.DMComposition,history:n})},n.clear=function(){var e=this.props.richTextInputContext;if(e){var t=(e||{}).initEditorState;this.setState({value:"",editorState:t&&t("")})}else this.setState({value:""})},n.focus=function(){this._textInput&&this._textInput.focus()},n.value=function(){return this.state.value},a()(t,[{key:"canEditImage",get:function(){var e=this.props.attachment;return!!(e&&e.media&&e.media.mediaFile&&e.media.mediaFile.isImage)}}]),t}(u.Component);d()(Ce,"defaultProps",{prefillText:"",withEmojiPicker:!0,withGifPicker:!0,withMediaPicker:!0});var Ee=w.a.create((function(e){return{root:{backgroundColor:e.colors.navigationBackground,borderTopColor:e.colors.borderColor,borderTopWidth:e.borderWidths.small},attachmentContainer:{maxHeight:"10rem",margin:e.spaces.xSmall},aspectContainer:{flexShrink:1},cardPreviewContainer:{margin:e.spaces.xSmall},dtabOffset:{marginBottom:e.spaces.xLarge},gifAttribution:{flexDirection:"row",marginVertical:e.spaces.xxSmall,marginHorizontal:0},mediaPicker:{margin:0},icon:{color:e.colors.primary,fontSize:"1.5em"},composeBoxContainer:{flexGrow:1,flexShrink:1,alignSelf:"center"},composeInput:{width:"100%"},composeTextInput:{paddingVertical:e.spaces.xxSmall},mediaPreviewContainer:{flexDirection:"row",height:"100%"},mediaPreview:{borderRadius:e.borderRadii.large,overflow:"hidden"},composer:{alignItems:"flex-end",flexDirection:"row",padding:e.spaces.xxSmall,width:"100%"},composerWithAttachment:{paddingLeft:e.spaces.xSmall},actionButton:{marginLeft:e.spaces.xxSmall},uploadButtons:{flexDirection:"row",marginRight:e.spaces.xxSmall}}}));t.a=_.forwardRef(Ce)},zQEV:function(e,t,n){"use strict";n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return f}));n("z84I"),n("ho0z");var r=n("ERkP"),a=n("t62R"),i=n("aWyx"),o=n("3XMw"),s=n.n(o),c=(n("aWzz"),s.a.c1d4ac83),l=s.a.abc7b032,d=s.a.i263b293,u=function(e){var t=e.conversationId,n=e.children;return r.createElement(a.c,{link:"/messages/"+t+"/participants"},n)},p=function(e,t){return e>=3?r.createElement(s.a.I18NFormatMessage,{$i18n:"e3534476"},r.createElement(u,{conversationId:t},s.a.d1242bcc({count:e}))):r.createElement(s.a.I18NFormatMessage,{$i18n:"b6656850",count:e})},m=function(e){var t=e.entry,n=e.users;return t.participants?r.createElement("span",null,t.participants.map((function(e,t){var i=e.user_id,o=n[i];return o?r.createElement("span",{key:t},t>0?", ":null,r.createElement(a.c,null,o.name)):null}))):null},f=function(e,t,n,o){var u,p=n===e.by_user_id;switch(t){case i.b.CONVERSATION_AVATAR_UPDATE:return(u=e.by_user_id&&o[e.by_user_id]&&o[e.by_user_id].name)?p?c:function(e){return r.createElement(s.a.I18NFormatMessage,{$i18n:"bff29c94"},r.createElement(a.c,null,e))}(u):l;case i.b.CONVERSATION_NAME_UPDATE:var f=r.createElement(a.c,null,e.conversation_name);return(u=e.by_user_id&&o[e.by_user_id]&&o[e.by_user_id].name)?p?function(e){return r.createElement(s.a.I18NFormatMessage,{$i18n:"b16e4d45"},e)}(f):function(e,t){return r.createElement(s.a.I18NFormatMessage,{$i18n:"c5760698"},r.createElement(a.c,null,e),t)}(u,f):function(e){return r.createElement(s.a.I18NFormatMessage,{$i18n:"a72730a0"},e)}(f);case i.b.JOIN_CONVERSATION:return(u=e.sender_id&&o[e.sender_id]&&o[e.sender_id].name)?function(e){return r.createElement(s.a.I18NFormatMessage,{$i18n:"fa95b019"},r.createElement(a.c,null,e))}(u):d;case i.b.PARTICIPANTS_LEAVE:return function(e){return r.createElement(s.a.I18NFormatMessage,{$i18n:"fc10875e"},e)}(r.createElement(m,{entry:e,users:o}));case i.b.PARTICIPANTS_JOIN:return function(e,t){return e?r.createElement(s.a.I18NFormatMessage,{$i18n:"a4bc88c2"},r.createElement(a.c,null,e),t):r.createElement(s.a.I18NFormatMessage,{$i18n:"bfdff0c3"},t)}(u=e.sender_id&&o[e.sender_id]&&o[e.sender_id].name,r.createElement(m,{entry:e,users:o}));default:return""}}}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/web_legacy/shared~loader.DMDrawer~bundle.DirectMessages~bundle.DMRichTextCompose.914d8e94.js.map