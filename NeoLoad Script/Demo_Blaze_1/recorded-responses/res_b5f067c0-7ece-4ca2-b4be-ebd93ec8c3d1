(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{"0Ki6":function(e,t,n){"use strict";n("i4UL"),n("IAdD");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("YRQv"),d=n("ERkP"),u=n("CHgo"),p=n("fs1G"),h=n("7nmT"),m=n.n(h),f=n("rHpw"),v=n("3xO4"),b=n.n(v),g=n("Enqy"),_=l.a(),y={zoom:1,lastX:0,lastY:0,zoomCenter:{x:0,y:0}},C={height:0,width:0,left:0,right:0,top:0,bottom:0},E=function(e,t,n){return Math.min(t,Math.max(e,n))},I=function(e,t){return Math.sqrt(Math.pow(e.clientY-t.clientY,2)+Math.pow(e.clientX-t.clientX,2))},w=function(e){function t(t){var n;return n=e.call(this,t)||this,c()(r()(n),"_itemDimensions",C),c()(r()(n),"_setTouchableNode",(function(e){n._touchableNode=m.a.findDOMNode(e),n._touchableNode&&(n._removeTouchListener=Object(u.a)(n._touchableNode,n._handleTouchMove,!1))})),c()(r()(n),"_handleTouchStart",(function(e){n._zoomable instanceof Element&&(n._zoomedDimensions=n._zoomable.getBoundingClientRect()),n._moved=!1;var t=e.touches.length;2===t?(e.preventDefault(),n._handlePinchStart(e)):1===t&&n._handleTapStart(e)})),c()(r()(n),"_handleTouchMove",(function(e){var t=e.touches.length;2===t?n._handlePinchMove(e):1===t&&(n._moved=!0,n._handlePanMove(e)),e.preventDefault()})),c()(r()(n),"_handleTouchEnd",(function(e){var t=n.props,o=t.maxZoom,r=t.minZoom,a=t.onTap,i=E(r,o,n.state.zoom),s=n.state.zoom;s!==i&&1===i?n.resetZoom():n.setState({lastX:0,lastY:0,zoom:i}),0===e.touches.length?(n._lastTouchTime&&n._lastTouchTime+300>e.timeStamp?(n._clickTimer&&clearTimeout(n._clickTimer),n._handleDoubleTap(e)):s<=1&&!n._moved&&(n._clickTimer=setTimeout(a,300)),n._lastTouchTime=e.timeStamp):e.preventDefault()})),n.state=Object.assign({},y),n._ref=d.createRef(),n}i()(t,e),t.getDerivedStateFromProps=function(e,t){return _&&e.resetZoom?(e.onZoomed(!1),Object.assign({},y)):t};var n=t.prototype;return n.render=function(){var e=this;if(!_)return this.props.children;var t=this.state,n=t.zoom,o=t.zoomCenter,r=this._moved,a={zoom:Object(g.spring)(n),zoomCenterX:Object(g.spring)(o.x),zoomCenterY:Object(g.spring)(o.y)};return d.createElement(b.a,{onTouchEnd:this._handleTouchEnd,onTouchStart:this._handleTouchStart,ref:this._setTouchableNode,style:S.fill},d.createElement(g.Motion,{style:a},(function(t){var n=t.zoom,a=t.zoomCenterX,i=t.zoomCenterY;return d.createElement(b.a,{ref:e._ref,style:[S.fill,{transform:[{scale:n}],transformOrigin:(r?a:o.x)+"px "+(r?i:o.y)+"px"}]},e.props.children)})))},n.componentDidMount=function(){_&&(this._zoomable=m.a.findDOMNode(this._ref.current),this._updateWindowDimensions())},n.componentWillUnmount=function(){this._removeTouchListener&&this._removeTouchListener()},n.resetZoom=function(){this.props.onZoomed(!1),this.setState({zoom:y.zoom})},n._handlePanMove=function(e){if(!(this.state.zoom<=1)&&this._zoomedDimensions&&this._windowDimensions){var t=e.touches[0],n=t.clientX,o=t.clientY;if(this.state.lastX&&this.state.lastY){var r=this.state,a=r.lastX,i=r.lastY,s=r.zoomCenter,c=s.x,l=s.y,d=this._windowDimensions,u=d.height,p=d.width,h=this._zoomedDimensions,m=h.height,f=0,v=0;h.width-p>0&&(f=n-a),m-u>0&&(v=o-i),this.setState({lastX:n,lastY:o,zoomCenter:{x:Math.min(Math.max(c-f,0),p),y:Math.min(Math.max(l-v,0),u)}})}else this.setState({lastX:n,lastY:o})}},n._handlePinchStart=function(e){var t,n,o=e.touches;if(this._updateWindowDimensions(),this._lastDistance=I(o[0],o[1]),1===this.state.zoom){var r=(t=o[0],n=o[1],{x:(t.clientX+n.clientX)/2,y:(t.clientY+n.clientY)/2});this.setState({zoomCenter:this._getZoomCenter(r.x,r.y)}),this.props.onZoomed(!0)}},n._handlePinchMove=function(e){var t=this.state,n=t.zoom,o=t.zoomCenter,r=this.props,a=r.maxZoom,i=r.maxZoomBounce,s=r.minZoom,c=r.minZoomBounce;if(0!==o.x||0!==o.y){var l=I(e.touches[0],e.touches[1]),d=this._lastDistance?l/this._lastDistance:1,u=E(s-c,a+i,n*d);this._lastDistance=l,this.setState({zoom:u})}else 2===e.touches.length&&this._handlePinchStart(e)},n._handleTapStart=function(e){var t=e.touches;this._tapCenter=this._getZoomCenter(t[0].clientX,t[0].clientY)},n._handleDoubleTap=function(e){var t=this.props,n=t.maxZoom,o=t.onZoomed;1!==this.state.zoom?this.resetZoom():(this._updateWindowDimensions(),this.setState({zoom:n,zoomCenter:this._tapCenter||y.zoomCenter}),o(!0))},n._getZoomCenter=function(e,t){this._zoomable instanceof Element&&(this._itemDimensions=this._zoomable.getBoundingClientRect());var n=this._itemDimensions;return{x:e-n.left,y:t-n.top}},n._updateWindowDimensions=function(){this._windowDimensions={height:window.innerHeight,width:window.innerWidth}},t}(d.Component);c()(w,"defaultProps",{maxZoom:2.5,maxZoomBounce:.15,minZoom:1,minZoomBounce:.15,onTap:p.a,onZoomed:p.a,resetZoom:!1});var S=f.a.create((function(e){return{fill:{flex:1}}}));t.a=w},"2doW":function(e,t,n){"use strict";n("jQ3i"),n("z84I"),n("KqXw"),n("Ysgh");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=(n("2G9S"),n("vrRf"),n("97Jx")),u=n.n(d),p=n("LdEA"),h=n.n(p),m=n("aWzz"),f=(n("IAdD"),n("7x/C"),n("JtPf"),n("FwvS")),v=n("3XMw"),b=n.n(v),g=n("mN6z"),_=n("D4le"),y=n.n(_),C=n("3xO4"),E=n.n(C),I=n("0Ki6"),w=n("r1lV"),S=n("rHpw"),O=n("JYMr"),x=b.a.b327c129,M=b.a.gff1f69e,P=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,c()(r()(t),"state",{loadingVariant:null,imageLoading:!1}),c()(r()(t),"_handleLoadStart",(function(){return t.setState({imageLoading:!0})})),c()(r()(t),"_handleLoadEnd",(function(){return t.setState({imageLoading:!1})})),t}i()(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;this._mountPromiseForTesting=t._selectCachedVariant(this.props.photo).then((function(t){return e.setState({loadingVariant:t})}))},n.componentDidUpdate=function(e,n){var o=this;Object(g.a)(e.photo,this.props.photo)||(this.setState({loadingVariant:null}),t._selectCachedVariant(this.props.photo).then((function(e){return o.setState({loadingVariant:e})})))},n.render=function(){var e=this.props,n=e.dataSaver,o=e.onContextMenu,r=e.onError,a=e.onLoad,i=e.onTap,s=e.onZoomed,c=e.photo,d=e.resetZoom,u=e.zoomable,p=e.style,h=this.state.loadingVariant,m=(n&&h&&Math.max(h.width,h.height)>=680?h.uri:null)||t._selectSource(c);if(!m||null===h)return null;var f=l.createElement(y.a,{accessibilityLabel:c.ext_alt_text?c.ext_alt_text:x,defaultSource:h&&h.uri,draggable:!0,onContextMenu:o,onError:h?void 0:r,onLoad:a,onLoadEnd:this._handleLoadEnd,onLoadStart:this._handleLoadStart,resizeMode:"contain",source:m,style:A.img});return l.createElement(E.a,{style:p},this.state.imageLoading?D:null,u?l.createElement(I.a,{onTap:i,onZoomed:s,resetZoom:d},f):f)},t._selectCachedVariant=function(e){var t=f.c(e);return t?w.a.selectLargestCachedVariant(t):Promise.resolve()},t._selectSource=function(e){var t=f.c(e);return t&&w.a.selectLargestUrl(t)},t}(l.PureComponent);c()(P,"defaultProps",{zoomable:!1});var A=S.a.create((function(e){return{img:Object.assign({},S.a.absoluteFillObject,{height:"auto",margin:"auto",maxHeight:"100%",maxWidth:"100%",width:"auto"}),progressBar:{position:"absolute",top:0,zIndex:1}}})),D=l.createElement(O.a,{ariaValueText:M,indeterminate:!0,style:A.progressBar}),T=P,k=n("RCZO"),N=n("KdqI"),R=n("TrHT"),L=n("Modb"),j=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,c()(r()(t),"_handlePlaybackStarted",(function(){t._player&&!t.props.isCurrentlyDisplayed&&t._player.pause()})),c()(r()(t),"_setPlayer",(function(e){t._player=e,t._player&&t.props.isCurrentlyDisplayed&&t._player.play()})),t}i()(t,e);var n=t.prototype;return n.render=function(){var e=this.props.style;return l.createElement(E.a,{style:e},l.createElement(E.a,{style:B.root},this._renderVideo()))},n.componentDidUpdate=function(e){var t=this.props.isCurrentlyDisplayed;this._player&&t!==e.isCurrentlyDisplayed&&(t?this._player.play():this._player.pause())},n._renderVideo=function(){var e=this.props,t=e.promotedContent,n=e.video,o=e.videoId;return l.createElement(L.a,u()({},Object(R.a)(o,n),{onPlaybackStarted:this._handlePlaybackStarted,playbackCoordination:null,promotedContent:t,setPlayer:this._setPlayer,withPostPlayback:!0}))},t}(l.PureComponent),B=S.a.create({root:{flexBasis:0,flexGrow:1,flexShrink:1,justifyContent:"center"}}),U=j,G=n("ziVO"),z=n("q9Zt"),W=n("mjJ+"),F=n("TGLq"),H=n.n(F),V=b.a.ac85c6b1,q=b.a.f46c1d5e,K=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,c()(r()(t),"state",{error:null,contextMenuPoint:{top:0,left:0},showContextMenu:!1,containerDimensions:{width:0,height:0}}),c()(r()(t),"_handleError",(function(e){t.setState({error:e.nativeEvent.error})})),c()(r()(t),"_handleLoad",(function(){t.setState({error:null})})),c()(r()(t),"_handleMediaPress",(function(e){e.stopPropagation()})),c()(r()(t),"_handleRetry",(function(){t.setState({error:null})})),c()(r()(t),"_handleContextMenu",(function(e){Object(N.e)()&&(e.preventDefault(),e.stopPropagation(),t.setState({contextMenuPoint:{left:e.clientX,top:e.clientY}}),t.setState({showContextMenu:!0}))})),c()(r()(t),"_handleContextCancel",(function(){return t.setState({showContextMenu:!1})})),c()(r()(t),"_handleOpenImageURI",(function(){H.a.openURL(t.props.mediaDetail.media_url_https),t._handleContextCancel()})),c()(r()(t),"_getContextMenuItems",(function(){return[{text:q,onClick:t._handleOpenImageURI}]})),c()(r()(t),"_handleLayout",(function(e){var n=e.nativeEvent.layout,o=n.height,r=n.width;t.setState({containerDimensions:{width:r,height:o}})})),t}i()(t,e);var n=t.prototype;return n.shouldComponentUpdate=function(e,t){return!Object(g.a)(e,this.props)||!Object(g.a)(t,this.state)},n.UNSAFE_componentWillReceiveProps=function(e){this.setState({error:null,showContextMenu:!1})},n.render=function(){var e,t=this.props,n=t.isCurrentlyDisplayed,o=t.mediaDetail,r=t.onDismiss,a=t.onTap,i=t.promotedContent,s=t.videoId,c=h()(t,["isCurrentlyDisplayed","mediaDetail","onDismiss","onTap","promotedContent","videoId"]),d=o.original_info||{},p=d.width,m=d.height,f=this.state,v=f.error,b=f.showContextMenu,g=f.containerDimensions,_=g.width,y=g.height,C=this.context.isModal,I=C?Object(k.e)({mediaWidth:p,mediaHeight:m,containerWidth:_,containerHeight:y}):X.mediaItem;return o&&(e=["animated_gif","video","vine"].indexOf(o.type)>-1),l.createElement(G.a,{onDismiss:r,onLayout:C?this._handleLayout:void 0,style:X.root},v?l.createElement(z.a,{onRetry:this._handleRetry,style:X.errorDetail,title:V,withLightOnDarkColorScheme:!0}):null,b?l.createElement(W.a,{items:this._getContextMenuItems(),onCloseRequested:this._handleContextCancel,position:this.state.contextMenuPoint}):null,v?null:l.createElement(E.a,{onClick:this._handleMediaPress,style:I},"photo"===o.type?l.createElement(T,u()({},c,{onContextMenu:this._handleContextMenu,onError:this._handleError,onLoad:this._handleLoad,onTap:a,photo:o,style:X.container,zoomable:!0})):null,e&&s?l.createElement(U,{isCurrentlyDisplayed:n,promotedContent:i,style:X.container,video:o,videoId:s}):null))},t}(l.Component);c()(K,"contextTypes",{isModal:m.bool});var X=S.a.create((function(e){return{root:{flexGrow:1,justifyContent:"center",alignItems:"center",flexShrink:1},mediaItem:{flexGrow:1,width:"100%",height:"100%"},container:{height:"100%",position:"absolute",width:"100%"},errorDetail:{alignItems:"center",alignSelf:"center",justifyContent:"center",position:"absolute",height:"100%",maxWidth:400}}})),Z=K,Q=n("lklz"),Y=n("cHvH"),J=n("uavX"),$=n("fs1G"),ee=function(e){function t(t,n){var o;return o=e.call(this,t,n)||this,c()(r()(o),"_getWithReducedNavButtonClickArea",(function(e,t){return e<S.a.theme.breakpoints.large||o._isItemVideo(t)})),c()(r()(o),"_isItemVideo",(function(e){return["video","animated_gif","vine"].includes(e.type)})),c()(r()(o),"_getItemVideoId",(function(e){return o.props.videoId||function(e){return Q.b.forTweet(e.expanded_url.split("/")[3])}(e)})),c()(r()(o),"_handleMediaDetailZoomed",(function(e){var t=o.props.onMediaDetailZoomed;o.state.isZoomed!==e&&o.setState({isZoomed:e}),t&&t(e)})),o.state={isZoomed:!1},o}i()(t,e);var n=t.prototype;return n.shouldComponentUpdate=function(e,t){return!Object(g.a)(e,this.props)||!Object(g.a)(t,this.state)},n.render=function(){var e=this,t=this.props,n=t.dataSaver,o=t.dominantColor,r=t.mediaIndex,a=t.mediaItems,i=t.onDismiss,s=t.onMediaItemChanged,c=t.onTap,d=t.promotedContent,u=this.state.isZoomed,p=a.map((function(t,o){var s=e._isItemVideo(t),p=e._getItemVideoId(t),h=r===o;return s&&p||!s?l.createElement(Z,{dataSaver:n,isCurrentlyDisplayed:h,key:o,mediaDetail:a[o],onDismiss:u?void 0:i,onTap:c,onZoomed:h?e._handleMediaDetailZoomed:void 0,promotedContent:d,resetZoom:r!==o,videoId:p}):null}));return l.createElement(Y.a,null,(function(t){var n=t.windowWidth;return l.createElement(E.a,{style:te.root},a.length>1?l.createElement(J.a,{currentSlide:r,dominantColor:o,locked:u||1===a.length,onChange:s,withReducedNavButtonClickArea:e._getWithReducedNavButtonClickArea(n,a[r])},p):p)}))},t}(l.Component);c()(ee,"defaultProps",{mediaIndex:0,onMediaDetailZoomed:$.a,onMediaItemChanged:$.a});var te=S.a.create((function(e){return{root:{flex:1,zIndex:1}}}));t.a=ee},"3OvD":function(e,t,n){"use strict";n("IAdD"),t.__esModule=!0,t.default=void 0;var o=i(n("7DT3")),r=i(n("ERkP")),a=i(n("OkZJ"));function i(e){return e&&e.__esModule?e:{default:e}}var s=function(e){return void 0===e&&(e={}),(0,o.default)("svg",Object.assign({},e,{style:[a.default.root,e.style],viewBox:"0 0 24 24"}),r.default.createElement("g",null,r.default.createElement("path",{d:"M19.708 22H4.292C3.028 22 2 20.972 2 19.708V7.375C2 6.11 3.028 5.083 4.292 5.083h2.146C7.633 3.17 9.722 2 12 2c2.277 0 4.367 1.17 5.562 3.083h2.146C20.972 5.083 22 6.11 22 7.375v12.333C22 20.972 20.972 22 19.708 22zM4.292 6.583c-.437 0-.792.355-.792.792v12.333c0 .437.355.792.792.792h15.416c.437 0 .792-.355.792-.792V7.375c0-.437-.355-.792-.792-.792h-2.45c-.317.05-.632-.095-.782-.382-.88-1.665-2.594-2.7-4.476-2.7-1.883 0-3.598 1.035-4.476 2.702-.16.302-.502.46-.833.38H4.293z"}),r.default.createElement("path",{d:"M12 8.167c-2.68 0-4.86 2.18-4.86 4.86s2.18 4.86 4.86 4.86 4.86-2.18 4.86-4.86-2.18-4.86-4.86-4.86zm2 5.583h-1.25V15c0 .414-.336.75-.75.75s-.75-.336-.75-.75v-1.25H10c-.414 0-.75-.336-.75-.75s.336-.75.75-.75h1.25V11c0-.414.336-.75.75-.75s.75.336.75.75v1.25H14c.414 0 .75.336.75.75s-.336.75-.75.75z"})))};s.metadata={height:24,width:24};var c=s;t.default=c},"7oQg":function(e,t,n){"use strict";n.r(t);n("KqXw"),n("WNMA"),n("MvUL");var o=n("W/Kd"),r=n.n(o),a=n("ERkP"),i=n("RqPI"),s=n("uDfI"),c=n("3nOA"),l=n("0KEI"),d=n("hqKg"),u=n("GOQE"),p=n("kGix"),h=n("v//M"),m=n("fs1G"),f=(n("aWzz"),n("G6rE")),v=Object(d.createSelector)([i.g,function(e,t){return t.match.params.screenName},function(e,t){return f.e.selectIdByScreenName(e,t.match.params.screenName)}],(function(e,t,n){return{conversationId:e&&n?Object(c.a)(e,n):null,screenName:t}})),b={createLocalApiErrorHandler:Object(l.d)("CREATE_CONVERSATION"),fetchOneByScreenNameWithExtraFieldsIfNeeded:f.e.createFetchOneByScreenNameWithExtraFieldsIfNeeded([f.a,f.d])},g=function(e){function t(){return e.apply(this,arguments)||this}r()(t,e);var n=t.prototype;return n.UNSAFE_componentWillMount=function(){var e=this.props,t=e.createLocalApiErrorHandler,n=e.fetchOneByScreenNameWithExtraFieldsIfNeeded,o=e.history;n(e.screenName).catch((function(e){t(u.a)(e),o.replace("/messages")}))},n.UNSAFE_componentWillReceiveProps=function(e){var t=e.conversationId,n=e.history;t&&n.replace("/messages/"+t)},n.render=function(){return a.createElement(h.a,{fetchStatus:p.a.LOADING,render:m.a})},t}(a.Component);t.default=Object(s.b)(v,b)(g)},CFcj:function(e,t,n){"use strict";n.r(t),n.d(t,"ConversationGroupInfoScreen",(function(){return K}));n("lTEL"),n("7x/C"),n("JtPf"),n("KqXw"),n("87if"),n("MvUL"),n("kYxP");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=(n("WNMA"),n("MMRb")),u=n("AspN"),p=n("RqPI"),h=n("oEGd"),m=n("0KEI"),f=n("hqKg"),v=n("p9G8"),b=n("AQOc"),g=n("/NU0"),_=n("QK5w"),y=n("G6rE"),C=function(e,t){return t.match.params.conversationId},E=Object(f.createSelector)((function(e,t){return d.selectConversation(e,C(0,t))}),d.selectEntries,_.a,C,(function(e,t){return d.selectConversationFetchStatus(e,C(0,t))}),p.g,y.e.selectAll,(function(e,t){var n=d.selectConversationAvatarMediaId(e,C(0,t));return(Object(g.a)(n)?u.g(e,n):[])[0]}),(function(e,t){return d.selectConversationAvatarMediaIsUploading(e,C(0,t))}),(function(e,t){return d.selectConversationAvatarMediaUploadProgress(e,C(0,t))}),(function(e,t,n,o,r,a,i,s,c,l){var d=e&&e.data,u=d&&Object(b.b)(d,t,i),p=u&&Object(v.a)(u,a);if(!a)throw new Error("logged-in user not found");return{avatarMedia:s,conversation:u,canGoBack:n,conversationId:o,fetchStatus:r,isUploading:c,groupName:p,mediaUploadProgress:l,perspective:a}})),I={addAvatarMedia:d.addAvatarMedia,createLocalApiErrorHandler:Object(m.d)("CONVERSATION_GROUP_INFO_SCREEN"),fetchConversation:d.fetchConversation,fetchConversationIfNeeded:d.fetchConversationIfNeeded,removeAvatarMedia:d.removeAvatarMedia,removeMediaUpload:u.e,setConversationAvatar:d.setConversationAvatar,updateConversationName:d.updateConversationName},w=Object(h.g)(E,I),S=n("7JQg"),O=n("I2k/"),x=n("aA19"),M=n("v//M"),P=n("jHSc"),A=n("3XMw"),D=n.n(A),T=n("mN6z"),k=n("P68U"),N=n("eyty"),R=n("3xO4"),L=n.n(R),j=n("0yYu"),B=n("mw9i"),U=n("/yvb"),G=n("JYMr"),z=n("p+r5"),W=n("rHpw"),F=D.a.abd845fd,H=D.a.d87bff5a,V=D.a.i2209530,q=D.a.cabb453d,K=function(e){function t(t,n){var o;return o=e.call(this,t,n)||this,c()(r()(o),"_renderContent",(function(){return l.createElement(L.a,null,o._renderGroupAvatarPicker(),l.createElement(j.a,null),o._renderGroupNameEditor())})),c()(r()(o),"_handleFetch",(function(){var e=o.props,t=e.createLocalApiErrorHandler,n=e.conversationId;(0,e.fetchConversationIfNeeded)({conversationId:n}).catch(t(Object(O.a)(n)))})),c()(r()(o),"_handleGroupNameUpdated",(function(e){o.setState({groupNameEdit:e.target.value})})),c()(r()(o),"_handleSavePress",(function(){o._savePress()})),c()(r()(o),"_savePress",(function(){var e=o.props,t=e.avatarMedia,n=e.canGoBack,r=e.conversationId,a=e.createLocalApiErrorHandler,i=e.fetchConversation,s=e.groupName,c=e.history,l=e.setConversationAvatar,d=e.updateConversationName,u=o.state.groupNameEdit,p=[];return t&&p.push(l(r).catch(a())),u&&s!==u&&p.push(d({conversationId:r,name:u}).catch(a({showToast:!0}))),Promise.all(p).then((function(){i({conversationId:r}).catch(a(Object(O.a)(r))),n?c.goBack():c.replace("/messages/"+r+"/info")}),(function(){return t&&o._clearAvatarMedia(t.id)}))})),c()(r()(o),"_handleAvatarMediaChange",(function(e){var t=e[0],n=o.props,r=n.addAvatarMedia,a=n.avatarMedia,i=n.conversationId;a&&o._clearAvatarMedia(a.id),r(i,t)})),c()(r()(o),"_handleMediaFailure",(function(e){o._clearAvatarMedia(e)})),o.state={groupNameEdit:t.groupName},o}i()(t,e),t.getDerivedStateFromProps=function(e,t){var n=e.groupName;return"string"==typeof n&&null===t.groupNameEdit?{groupNameEdit:n}:null};var n=t.prototype;return n.componentDidMount=function(){this._handleFetch()},n.componentWillUnmount=function(){var e=this.props.avatarMedia;e&&this._clearAvatarMedia(e.id)},n.shouldComponentUpdate=function(e,t){return!Object(T.a)(e,this.props)||!Object(T.a)(t,this.state)},n.render=function(){var e=this.props,t=e.fetchStatus,n=e.conversationId,o=e.history,r=e.location;return l.createElement(P.b,{backLocation:"/messages/"+n+"/info",history:o,location:r,rightControl:this._renderRightControl(),title:F},l.createElement(B.a,{style:X.root},l.createElement(M.a,{accessibilityLabel:H,fetchStatus:t,onRequestRetry:this._handleFetch,render:this._renderContent})))},n._renderRightControl=function(){var e=this.props,t=e.avatarMedia,n=e.groupName,o=e.isUploading,r=this.state.groupNameEdit,a=o||!(r&&r!==n||t);return l.createElement(U.a,{children:V,disabled:a,onPress:this._handleSavePress,size:"normalCompact",type:"primary"})},n._renderGroupAvatarPicker=function(){var e=this.props,t=e.avatarMedia,n=e.conversation,o=e.mediaUploadProgress,r=e.perspective,a=l.createElement(x.a,{conversation:n,perspective:r});return l.createElement(L.a,null,l.createElement(G.a,{progress:o}),l.createElement(L.a,{style:X.avatarContainerRoot},l.createElement(k.a,{borderRadius:"infinite",currentContent:a,location:N.c.Avatar,mediaItem:t||void 0,onChange:this._handleAvatarMediaChange,onFailure:this._handleMediaFailure,rootStyle:X.avatarContainer})))},n._renderGroupNameEditor=function(){return l.createElement(z.a,{label:q,maxLength:50,name:"groupNameEdit",onChange:this._handleGroupNameUpdated,style:X.groupNameEditor,value:this.state.groupNameEdit||""})},n._clearAvatarMedia=function(e){var t=this.props,n=t.avatarMedia,o=t.conversationId,r=t.removeAvatarMedia,a=t.removeMediaUpload;n&&n.uploading||a(e),r(o,e)},t}(l.Component);c()(K,"defaultProps",{canGoBack:!1});var X=W.a.create((function(e){return{root:{backgroundColor:e.colors.faintGray},avatarContainerRoot:{alignItems:"center",backgroundColor:e.colors.cellBackground,paddingVertical:e.spaces.medium},groupNameEditor:{backgroundColor:e.colors.cellBackground},avatarContainer:{height:"calc(5 * "+e.spaces.medium+")",width:"calc(5 * "+e.spaces.medium+")"}}}));t.default=Object(S.c)({page:"messages",section:"group_settings"})(w(K))},EPsT:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=n("jtO7"),u=n("eb3s"),p=function(e){function t(t){var n;return n=e.call(this,t)||this,c()(r()(n),"_handleClick",(function(e){n.setState({showConfirmation:!0})})),c()(r()(n),"_handleCancel",(function(){n.setState({showConfirmation:!1})})),c()(r()(n),"_handleConfirm",(function(){n.setState({showConfirmation:!1}),n.props.onConfirmationSheetConfirm()})),n.state={showConfirmation:!1},n}return i()(t,e),t.prototype.render=function(){var e=this.props,t=e.color,n=e.confirmationSheetConfirmButtonLabel,o=e.confirmationSheetHeadline,r=e.confirmationSheetText,a=e.label,i=e.confirmationSheetConfirmButtonType,s=e.withBottomBorder;return l.createElement(l.Fragment,null,l.createElement(d.a,{color:t,label:a,onPress:this._handleClick,withBottomBorder:s}),this.state.showConfirmation?l.createElement(u.a,{confirmButtonLabel:n,confirmButtonType:i,headline:o,onCancel:this._handleCancel,onConfirm:this._handleConfirm,text:r}):null)},t}(l.Component);c()(p,"defaultProps",{color:"red"})},H9O4:function(e,t,n){"use strict";n("IAdD"),t.__esModule=!0,t.default=void 0;var o=s(n("7DT3")),r=s(n("/uF9")),a=s(n("ERkP")),i=s(n("OkZJ"));function s(e){return e&&e.__esModule?e:{default:e}}var c=function(e){return void 0===e&&(e={}),(0,o.default)("svg",Object.assign({},e,{style:[i.default.root,e.style,r.default.isRTL&&i.default.iconRtl],viewBox:"0 0 24 24"}),a.default.createElement("g",null,a.default.createElement("path",{d:"M19.687 22H7.813C6.538 22 5.5 20.962 5.5 19.687v-4.452c0-.414.336-.75.75-.75s.75.335.75.75v4.45c0 .45.365.815.813.815h11.873c.448 0 .813-.365.813-.813V7.813c0-.448-.365-.813-.813-.813h-4.452c-.414 0-.75-.336-.75-.75s.336-.75.75-.75h4.452C20.962 5.5 22 6.538 22 7.813v11.873C22 20.962 20.962 22 19.687 22z"}),a.default.createElement("path",{d:"M11.25 4.045c-.414 0-.75.336-.75.75V9.44L3.064 2.004c-.293-.293-.768-.293-1.06 0s-.294.768 0 1.06L9.438 10.5H4.804c-.414 0-.75.336-.75.75s.336.75.75.75h6.445c.414 0 .75-.336.75-.75V4.795c0-.414-.336-.75-.75-.75z"})))};c.metadata={height:24,width:24};var l=c;t.default=l},P68U:function(e,t,n){"use strict";n("2G9S"),n("hBpG"),n("hCOa"),n("jQ3i"),n("z84I"),n("x4t0"),n("87if");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=n("oEGd"),u=n("AspN"),p={addMedia:u.b,processMultipleMedia:u.d},h=Object(d.b)(p),m=n("3XMw"),f=n.n(m),v=n("3OvD"),b=n.n(v),g=n("l2F/"),_=n.n(g),y=n("pKoL"),C=n("3xO4"),E=n.n(C),I=n("rFBM"),w=n("/yvb"),S=n("9Xij"),O=n("rHpw"),x=n("VPdC"),M=f.a.b87ca51a,P=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,c()(r()(t),"_getAcceptedFileInputs",(function(){var e=t.props,n=e.acceptGifs,o=e.acceptVideo;return Object(x.b)({acceptGifs:n,acceptVideo:o})})),c()(r()(t),"_handleAddMediaFiles",(function(e){var n=t.props,o=n.addMedia,r=n.location,a=n.onChange,i=n.onFailure,s=n.processMultipleMedia,c=t._getAcceptedFileInputs(),l=Array.from(e).find((function(e){return c.includes(e.type)}));l&&o([l],{location:r}).then((function(e){a&&a(e.map((function(e){return e.id}))),s(e,{onFailure:i})}))})),t}i()(t,e);var n=t.prototype;return n.render=function(){var e=this.props,t=e.borderRadius,n=e.maskStyle,o=e.mediaItem,r=e.onRemove,a=e.rootStyle,i=o&&!o.uploader;return l.createElement(E.a,{style:[D.container,a,A[t]]},l.createElement(I.a,{onFilesAdded:this._handleAddMediaFiles,style:[D.dragDropContainer,A[t]]},this._renderPreview(),i?null:l.createElement(l.Fragment,null,l.createElement(E.a,{style:[D.mask,n,A[t]]}),l.createElement(E.a,{style:D.mediaPicker},this._renderMediaPicker(),r?this._renderMediaRemove():null))))},n._renderMediaRemove=function(){var e=this.props.onRemove;return l.createElement(w.a,{accessibilityLabel:M,icon:l.createElement(_.a,null),onPress:e,style:D.remove,type:"invertedText"})},n._renderMediaPicker=function(){var e=this.props,t=e.acceptGifs,n=e.acceptVideo,o=e.accessibilityLabel;return l.createElement(x.a,{acceptGifs:t,acceptVideo:n,accessibilityLabel:o,icon:l.createElement(b.a,null),onChange:this._handleAddMediaFiles,type:"invertedText"})},n._renderPreview=function(){var e=this.props,t=e.aspectRatio,n=e.borderRadius,o=e.currentContent,r=e.mediaItem;return r?l.createElement(S.a,{ratio:t},l.createElement(y.a,{borderRadius:n,enableGif:!1,mediaItem:r,style:D.mediaPreview,withCloseButton:!1})):o},t}(l.Component);c()(P,"defaultProps",{acceptGifs:!1,acceptVideo:!1,aspectRatio:1,borderRadius:"none"});var A=O.a.create((function(e){return{infinite:{borderRadius:e.borderRadii.infinite},medium:{borderRadius:e.borderRadii.medium},none:{borderRadius:0}}})),D=O.a.create((function(e){return{mediaPreview:{height:"100%"},mediaPicker:{alignItems:"center",flexDirection:"row",height:"100%",justifyContent:"center",opacity:.75,position:"absolute",top:0,width:"100%"},remove:{marginLeft:e.spaces.large},mask:{backgroundColor:e.colors.translucentBlack30,height:"100%",position:"absolute",top:0,width:"100%"},container:{justifyContent:"center",overflow:"hidden"},dragDropContainer:{borderWidth:e.borderWidths.medium,borderColor:e.colors.transparent,borderStyle:"solid"}}}));t.a=h(P)},TGLq:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var o,r=n("6/RC"),a=(o=n("tI3i"))&&o.__esModule?o:{default:o};var i=r.canUseDOM?window.location.href:"",s={addEventListener:function(){},removeEventListener:function(){},canOpenURL:function(){return Promise.resolve(!0)},getInitialURL:function(){return Promise.resolve(i)},openURL:function(e){try{return c(e),Promise.resolve()}catch(t){return Promise.reject(t)}},_validateURL:function(e){(0,a.default)("string"==typeof e,"Invalid URL: should be a string. Was: "+e),(0,a.default)(e,"Invalid URL: cannot be empty")}},c=function(e){r.canUseDOM&&(window.location=new URL(e,window.location).toString())},l=s;t.default=l,e.exports=t.default},UPvq:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));n("2G9S"),n("IAdD");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=n("RCZO"),u=n("aWzz"),p=n("3XMw"),h=n.n(p),m=n("l2F/"),f=n.n(m),v=n("3xO4"),b=n.n(v),g=n("mw9i"),_=n("cm6r"),y=n("/yvb"),C=n("rHpw"),E=h.a.ia5e7487,I=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,c()(r()(t),"_handleCloseButtonPress",(function(e){e.stopPropagation(),(0,t.props.onCloseButtonPress)()})),c()(r()(t),"_handleBackgroundPress",(function(){var e=t.props.onCloseButtonPress;t.context.isModal&&e()})),t}return i()(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.children,o=t.backgroundColor,r=t.mediaItem,a=t.mediaUrl,i=t.hideButtons,s=t.topRightButton,c=t.footerButtons,u=t.overlayFooter,p=this.context.isModal,h=Object.assign({backgroundColor:o.rgba},d.a),m=Object.assign({backgroundColor:o.rgb},d.a),v=[w.root,p?h:m,{position:p?"relative":"fixed"}];return l.createElement(l.Fragment,null,l.createElement(b.a,{onClick:this._handleBackgroundPress,style:v},n,c?l.createElement(b.a,{pointerEvents:i?"none":void 0,style:[w.footerButtons,u&&h,u&&w.footerButtonsAbsolute,i&&w.fadeOut]},l.createElement(g.a,{withGutter:!0},c)):null),l.createElement(_.a,{accessibilityRole:"none",interactiveStyles:null,onClick:this._handleCloseButtonPress,pointerEvents:i?"none":void 0,style:[w.buttonWrapper,w.buttonWrapperLeft,d.a,i&&w.fadeOut]},(function(t){return l.createElement(y.a,{accessibilityLabel:E,dominantColor:o.rgb,icon:l.createElement(f.a,null),interactivityState:t,onClick:e._handleCloseButtonPress,type:r||a?"onMedia":"invertedPrimary"})})),s?l.createElement(b.a,{pointerEvents:i?"none":void 0,style:[w.buttonWrapper,w.buttonWrapperRight,d.a,i&&w.fadeOut]},s):null)},t}(l.Component);c()(I,"contextTypes",{isModal:u.bool}),c()(I,"defaultProps",{hideButtons:!1});var w=C.a.create((function(e){return{root:{overflowX:"hidden",overflowY:"hidden",height:"100%",width:"100%"},buttonWrapper:{position:"absolute",top:0,padding:e.spaces.xSmall,alignItems:"center",justifyContent:"center",cursor:"pointer"},buttonWrapperLeft:{left:0},buttonWrapperRight:{right:0},fadeOut:{opacity:0},footerButtons:{width:"100%",alignSelf:"center"},footerButtonsAbsolute:{position:"absolute",bottom:0,paddingBottom:C.a.iPhoneOffsetBottom,zIndex:1}}}))},VV6P:function(e,t,n){"use strict";n.r(t),n.d(t,"DMLowQualityUntrustedInboxScreen",(function(){return A}));n("2G9S"),n("KqXw"),n("WNMA"),n("uFXj");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=n("HPNB"),u=n("7JQg"),p=n("qz2E"),h=n("qS4/"),m=n("3XMw"),f=n.n(m),v=n("f42t"),b=n("M2mT"),g=n("zML4"),_=(n("AxOO"),n("3xO4")),y=n.n(_),C=n("cHvH"),E=n("t62R"),I=n("FIs5"),w=n("rHpw"),S=(n("aWzz"),n("hl/W")),O=f.a.e7172d70,x=f.a.bef0039f,M=f.a.a5359aac,P={page:"messages",section:"inbox",component:"low_quality_timeline"},A=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,c()(r()(t),"_renderStickyCopy",(function(){var e=t.props.conversationIds;return l.createElement(C.a,null,(function(t){var n=t.windowWidth,o=d.a.isTwoColumnLayout(n),r=0===e.length;return o||r?null:l.createElement(y.a,{style:D.stickyCopyContainer},l.createElement(E.c,{style:D.stickyCopy},M))}))})),c()(r()(t),"_renderSettingsAppBarButton",(function(){return l.createElement(g.a,{to:"/settings/safety"})})),c()(r()(t),"_renderEmptyDMInbox",(function(){return l.createElement(I.a,{header:x,message:M})})),c()(r()(t),"_handleBackClick",(function(){t.props.history.push("/messages/requests")})),c()(r()(t),"_hasDetailOpen",(function(){return!t.props.match.isExact})),t}return i()(t,e),t.prototype.render=function(){var e=this.props,t=e.conversationIds,n=e.createLocalApiErrorHandler,o=e.fetchInbox,r=e.fetchInboxHistory,a=e.fetchInboxIfNeeded,i=e.fetchStatus,s=e.fetchUpdates,c=e.googleAnalyticsPageView,d=e.isRefreshing,u=e.scribeAction,p=e.scribePageImpression,m=e.updateLastSeenEventId;return l.createElement(b.a,{backLocation:"/messages/requests",onBackClick:this._handleBackClick,rightControl:this._renderSettingsAppBarButton(),screenType:"secondaryRoot",title:O,withDetailOpen:this._hasDetailOpen()},l.createElement(h.a,{accessibilityTitle:O,conversationIds:t,conversationPathPrefix:"/messages/requests/additional",createLocalApiErrorHandler:n,fetchInbox:o,fetchInboxHistory:r,fetchInboxIfNeeded:a,fetchStatus:i,fetchUpdates:s,googleAnalyticsPageView:c,isRefreshing:d,isTertiaryInbox:!0,renderEmptyDMInbox:this._renderEmptyDMInbox,renderStickyContent:this._renderStickyCopy,scribeAction:u,scribeNamespace:P,scribePageImpression:p,updateLastSeenEventId:m,virtualScrollerCacheKey:"dmLowQualityUntrustedInbox"}))},t}(l.Component),D=w.a.create((function(e){return{stickyCopyContainer:{backgroundColor:e.colors.cellBackground,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,zIndex:1},stickyCopy:{color:e.colors.deepGray,padding:e.spaces.medium}}})),T=Object(v.a)(Object(u.c)(P)(Object(S.b)({inbox:S.a.tertiary})(A)),{directMessages:p.a});t.default=T},XG7v:function(e,t,n){"use strict";n.r(t),n.d(t,"DMComposeScreen",(function(){return ie}));n("2G9S"),n("DfhM"),n("i4UL"),n("LW0h"),n("hBpG"),n("7xRU"),n("z84I"),n("M+/F"),n("ho0z"),n("IAdD"),n("7x/C"),n("JtPf"),n("KqXw"),n("MvUL");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=n("aWzz"),u=n("7JQg"),p=n("s14A"),h=n("uB9N"),m=n("3nOA"),f=n("jHSc"),v=n("wO1l"),b=n("p9G8"),g=n("AQOc"),_=n("3XMw"),y=n.n(_),C="nextButton",E=n("aITJ"),I=n("2dXj"),w=n("3xO4"),S=n.n(w),O=n("/yvb"),x=n("I7xG"),M=n("w9LO"),P=n("rHpw"),A=n("zh9S"),D=n("MMRb"),T=n("VnFT"),k=n("1YZw"),N=n("oEGd"),R=n("0KEI"),L=n("hqKg"),j=n("tn7R"),B=n("Hw0q"),U=n("RqPI"),G=n("X/yg"),z=n("G6rE"),W=Object(B.b)("text"),F=Object(B.b)("recipient_id"),H=Object(L.createSelector)(D.selectConversations,(function(e){return Object(j.a)(e).filter((function(e){return!e.isDeleted&&e.data})).map((function(e){return e.data}))})),V=Object(L.createSelector)(H,W,U.g,G.d,z.e.selectAll,F,(function(e,t,n,o,r,a){if(!n)throw new Error("logged-in user not found");return{conversations:e,initialMessage:t,perspective:n,recipientId:a,tweetAttachment:o,users:r}})),q={addToast:k.b,createLocalApiErrorHandler:Object(R.d)("DIRECT_MESSAGES_COMPOSE"),fetchConversationFromParticipants:D.fetchConversationFromParticipants,fetchInboxIfNeeded:D.fetchInboxIfNeeded,popOutConversation:D.popOutConversation,scribeAction:A.c,sendMessage:T.n},K=Object(N.g)(V,q),X=n("883S"),Z=n("GZwR"),Q={page:"messages",section:"compose",component:"dm"},Y=y.a.de4669e2,J=y.a.cdcebd22,$=y.a.j9e025aa,ee=y.a.c64c1883,te=y.a.f277e949,ne=y.a.a2ccb2e7,oe=y.a.e3275464,re=y.a.c1df579e,ae=y.a.e1bde73e,ie=function(e){function t(t,n){var o;return o=e.call(this,t,n)||this,c()(r()(o),"_composer",l.createRef()),c()(r()(o),"_setDisableFocusingPreviousActiveElement",(function(e){var t=e.disableFocusingPreviousActiveElement;o._disableFocusingPreviousActiveElement=t})),c()(r()(o),"_renderAppBarRightControl",(function(){var e=o.props.tweetAttachment?oe:re;return l.createElement(S.a,{style:ce.rightColumn},l.createElement(O.a,{disabled:0===o.state.participants.length,onPress:o._handleConversationRouting,size:"normalCompact",style:ce.button,testID:C,type:"primary"},e))})),c()(r()(o),"_getItemIsDisabled",(function(e){var t=o.state,n=t.isGroupSelected,r=t.participants,a=e.data,i=e.type;return(!n||r[0].id!==e.id)&&(!!(n||i===Z.b.DMConversation&&r.length>0)||i===Z.b.User&&!(a.can_dm||a.is_dm_able))})),c()(r()(o),"_getItemDisabledMessage",(function(e){return ae({screenName:e.data.screen_name})})),c()(r()(o),"_getInjections",Object(x.a)(r()(o),(function(e){return e.conversations}),(function(e){return e.perspective}),(function(e,t){return t.query}),(function(e,t,n){return Object(v.a)(n,e.map((function(e){return Object(g.b)(e,void 0,o.props.users)})),t).slice(0,12)}))),c()(r()(o),"_handleQueryChange",(function(e){o.setState({query:e})})),c()(r()(o),"_handleSuggestionSelected",(function(e){var t=o.props.perspective,n=o.state,r=n.isGroupSelected,a=n.participants;if(r)e.id===a[0].id&&o._handleRemoveParticipant(e);else if(e.type===Z.b.DMConversation)if(o._isShareViaDM())o._createConversationObjectForSelectionPill(e);else{var i=se(e,t);o._goToConversation(i)}else o._handleParticipantToggle(e)})),c()(r()(o),"_createConversationObjectForSelectionPill",(function(e){var t=o.props,n=t.conversations,r=t.perspective,a=t.users,i=n.find((function(t){return e.id===t.conversation_id}));if(i){var s=Object(g.b)(i,void 0,a),c=Object(b.a)(s,r);e.data=Object.assign({},e.data,s,{name:c}),o.setState({isGroupSelected:!0,participants:[e]})}})),c()(r()(o),"_handleParticipantToggle",(function(e){var t=o.state.participants;if(t.find((function(t){return t.id===e.id})))o._handleRemoveParticipant(e);else{var n=t.concat(e);o.setState({participants:n})}})),c()(r()(o),"_handleRemoveParticipant",(function(e){var t=e.type,n=o.state.participants.filter((function(t){return t.id!==e.id}));t===Z.b.DMConversation&&o.setState({isGroupSelected:!1}),o.setState({participants:n})})),c()(r()(o),"_handleConversationRouting",(function(){o.props.tweetAttachment?o._handleShareTweet():o._handleCreateConversation()})),c()(r()(o),"_getExistingGroupConversationFromCache",(function(e){return o.props.conversations.find((function(t){var n=t.participants.length-1;return!t.name&&n===e.length&&e.every((function(e){return Boolean(t.participants.find((function(t){return e.id===t.user_id})))}))}))})),c()(r()(o),"_getExistingGroupConversationFromApi",(function(e){var t=e.map((function(e){return e.id})).join(",");return o.props.fetchConversationFromParticipants(t)})),c()(r()(o),"_getExistingGroupConversation",(function(e){if(e.length<=1)return Promise.resolve();var t=o._getExistingGroupConversationFromCache(e);return t?Promise.resolve(t):o._getExistingGroupConversationFromApi(e)})),c()(r()(o),"_handleCreateConversation",(function(){var e=o.props,t=e.history,n=e.initialMessage,r=e.perspective,a=e.tweetAttachment,i=o.state.participants;if(1===i.length){var s=se(i[0],r);o._goToConversation(s)}else{var c=o._getExistingGroupConversation(i);o._disableFocusingPreviousActiveElement&&o._disableFocusingPreviousActiveElement(),c.then((function(e){if(!e)throw new Error("No conversation found");o._goToConversation(e.conversation_id)})).catch((function(){var e;t.replace({pathname:"/messages/group",query:(e={},e.text=n,e),state:{participants:i,tweetAttachment:a,isNewGroupConversation:!0}})})),o._disableFocusingPreviousActiveElement&&o._disableFocusingPreviousActiveElement()}})),c()(r()(o),"_handleShareTweet",(function(e,t){var n=o.props,r=n.createLocalApiErrorHandler,a=n.tweetAttachment,i=n.perspective,s=o.state.participants,c=1===s.length,l=s;c&&(l=s[0]);var d={senderId:i,tweetAttachment:a,text:t},u=se(l,i);return u?o._sendMessage(u,s,d):o._getExistingGroupConversation(s).catch(r(X.a)).then((function(e){var t=e?e.conversation_id:null;return o._sendMessage(t,s,d)}))})),c()(r()(o),"_sendMessage",(function(e,t,n){var r=o.props,a=r.createLocalApiErrorHandler,i=r.history,s=r.sendMessage,c=Object.assign({conversationId:void 0,recipients:void 0},n);if(!e&&Array.isArray(t)){var l=t.map((function(e){if(e.type===Z.b.User)return e.data.id_str})).filter(Boolean);c.recipients=l}else c.conversationId=e;var d=a(X.b);return o.setState({isSending:!0}),s(c).then((function(e){o._displayDMMessageSentSuccessToast(e),o.setState({isSending:!1}),i.goBack()}),(function(e){o.setState({isSending:!1}),d(e)}))})),c()(r()(o),"_goToConversation",(function(e){var t,n,r,a=o.props,i=a.history,s=a.popOutConversation,c=a.initialMessage,l=a.tweetAttachment;(o._disableFocusingPreviousActiveElement&&o._disableFocusingPreviousActiveElement(),e)&&("drawer"===(null===(t=i.location)||void 0===t||null===(n=t.state)||void 0===n?void 0:n.source)?(s(e),i.goBack()):i.replace({pathname:"/messages/"+e,query:(r={},r.text=c,r),state:{tweetAttachment:l}}))})),c()(r()(o),"_displayDMMessageSentSuccessToast",(function(e){var t=o.props,n=t.addToast,r=t.scribeAction;o._isShareViaDM()&&r(Object.assign({},Q,{action:"send_tweet_dm"})),n({text:ne,actionLink:"/messages/"+e,actionLabel:te})})),o.state={isGroupSelected:!1,participants:[],query:"",isSending:!1},o}i()(t,e);var n=t.prototype;return n.UNSAFE_componentWillMount=function(){var e=this.props,t=e.createLocalApiErrorHandler,n=e.history,o=e.initialMessage,r=e.location.query,a=e.perspective,i=e.recipientId;if(i){var s,c=Object(m.a)(i,a);n.replace({pathname:"/messages/"+c,query:Object.assign({},r,(s={},s.text=o,s))})}else this.props.fetchInboxIfNeeded().catch(t())},n.componentDidUpdate=function(e,t){var n=this.state.participants;this._isShareViaDM()&&t.participants.length<n.length&&this._composer.current&&this._composer.current.focus()},n.render=function(){var e=this.props,t=e.history,n=e.initialMessage,o=e.location,r=e.recipientId,a=e.scribeNamespace,i=e.tweetAttachment,s=this.context.isModal,c=this.state,d=c.isSending,u=c.participants,m=this._isShareViaDM();if(r)return null;var v=i?$:J;return l.createElement(f.b,{backButtonType:"close",backLocation:"/messages",containerStyle:ce.fill,documentTitle:ee,history:t,location:o,rightControl:m?void 0:this._renderAppBarRightControl(),title:v},l.createElement(M.a.Context.Consumer,null,this._setDisableFocusingPreviousActiveElement),l.createElement(p.a,{style:ce.fill},l.createElement(I.d,{getItemDisabledMessage:this._getItemDisabledMessage,getItemIsDisabled:this._getItemIsDisabled,injections:this._getInjections(),onQueryChange:this._handleQueryChange,onRemove:this._handleRemoveParticipant,onSelect:this._handleSuggestionSelected,selectedUsers:u,shouldAutoFocus:!m||!E.a.isIOS(),source:Z.d.ComposeMessage,withCompactPills:!0}),m&&!s?l.createElement(S.a,{style:ce.placeholder}):null,m?l.createElement(h.a,{canSendEmptyMessage:!!i,conversationId:"DMComposeScreen",disabled:0===u.length||d,history:t,isSending:d,isShareViaDM:!!m,isUploading:!1,mediaUploadProgress:0,onSend:this._handleShareTweet,placeholderText:Y,prefillText:n,ref:this._composer,scribeNamespace:a,style:[ce.shadow,!s&&ce.fixToBottom],withEmojiPicker:!1,withGifPicker:!1,withMediaPicker:!1}):null))},n._isShareViaDM=function(){var e=this.props,t=e.initialMessage;return e.tweetAttachment||!!t},t}(l.Component);c()(ie,"contextTypes",{isModal:d.bool});var se=function(e,t){return Array.isArray(e)||e.type!==Z.b.DMConversation?Array.isArray(e)||e.type!==Z.b.User?null:Object(m.a)(e.data.id_str,t):e.data.conversationId},ce=P.a.create((function(e){return{fill:{flex:1},button:{marginLeft:e.spaces.xSmall},rightColumn:{alignItems:"center",flexDirection:"row",flexGrow:1,justifyContent:"flex-end"},shadow:{boxShadow:"0 -1px 3px rgba(0,0,0,0.12)"},placeholder:{height:46},fixToBottom:{position:"fixed",backfaceVisibility:"hidden",bottom:0,left:0,right:0,paddingBottom:P.a.iPhoneOffsetBottom}}}));t.default=Object(u.c)(Q)(K(ie))},XoqV:function(e,t,n){"use strict";n.r(t),n.d(t,"DMParticipantsScreen",(function(){return D}));n("2G9S"),n("z84I");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=(n("KqXw"),n("WNMA"),n("MMRb")),u=n("0KEI"),p=n("hqKg"),h=n("RqPI"),m=n("oEGd"),f=function(e,t){return t.match.params.conversationId},v=Object(p.createSelector)(f,(function(e,t){return d.selectConversationFetchStatus(e,f(0,t))}),d.selectConversations,h.g,(function(e,t,n,o){if(!o)throw new Error("logged-in user not found");var r=n[e];return{conversation:r&&r.data,conversationId:e,fetchStatus:t,perspective:o}})),b={createLocalApiErrorHandler:Object(u.d)("DIRECT_MESSAGES_PARTICIPANTS"),fetchConversationIfNeeded:d.fetchConversationIfNeeded},g=Object(m.g)(v,b),_=n("7JQg"),y=n("I2k/"),C=n("v//M"),E=n("3XMw"),I=n.n(E),w=n("M2mT"),S=n("Es6L"),O=n("rHpw"),x=n("hqDb"),M=n("yw4N"),P=(n("aWzz"),I.a.g2fd3205),A=I.a.d4986f85,D=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,c()(r()(t),"_renderList",(function(){var e=t.props.conversation,n=e&&(e.participants||[]).map((function(e){return e.user_id}))||[];return l.createElement(x.a,{userIds:n,withItemBorder:!0})})),c()(r()(t),"_handleFetch",(function(){t._fetchIfNeeded(t.props.conversationId)})),t}i()(t,e);var n=t.prototype;return n.componentDidMount=function(){this._handleFetch()},n.UNSAFE_componentWillReceiveProps=function(e){this.props.conversationId!==e.conversationId&&this._fetchIfNeeded(e.conversationId)},n.render=function(){var e=this.props,t=e.fetchStatus,n=e.conversationId;return l.createElement(w.a,{backLocation:"/messages/"+n+"/info",documentTitle:A,screenType:"secondaryDetail",title:P},l.createElement(M.a,{style:[T.root,!Object(S.a)()&&T.bottomOffset]},l.createElement(C.a,{fetchStatus:t,onRequestRetry:this._handleFetch,render:this._renderList})))},n._fetchIfNeeded=function(e){var t=this.props,n=t.createLocalApiErrorHandler;(0,t.fetchConversationIfNeeded)({conversationId:e}).catch(n(Object(y.a)(e)))},t}(l.Component),T=O.a.create((function(e){return{root:{backgroundColor:e.colors.cellBackground},bottomOffset:{paddingBottom:"calc("+O.a.theme.componentDimensions.appBarHeight+" + "+O.a.iPhoneOffsetBottom+")"}}}));t.default=Object(_.c)({page:"messages",section:"view_participants"})(g(D))},cOtO:function(e,t,n){"use strict";n.r(t),n.d(t,"DMConversationScreen",(function(){return se}));n("z84I"),n("+KXO"),n("KqXw"),n("MvUL"),n("uFXj");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=n("HPNB"),u=(n("WNMA"),n("zh9S")),p=n("MMRb"),h=n("VnFT"),m=n("RqPI"),f=n("oEGd"),v=n("hqKg"),b=(n("Myq3"),n("AQOc")),g=n("z2Pn"),_=n("pNZL"),y=n("G6rE"),C=n("X/yg"),E=function(e,t){return t.match.params.conversationId},I=Object(v.createSelector)((function(e,t){return p.selectConversation(e,E(0,t))}),p.selectEntries,E,C.b,m.g,C.c,C.d,y.e.selectAll,(function(e,t){return h.j(e,E(0,t))}),(function(e,t){return h.i(e,E(0,t))}),p.selectPoppedOutConversationId,p.selectDrawerVisibility,(function(e,t,n,o,r,a,i,s,c,l,d,u){var p=e&&e.data;return{conversation:p&&Object(b.a)(p,t,s),conversationId:n,isNewGroupConversation:o,isUploading:c,media:l,newConversationParticipants:a,perspective:r,poppedOutConversationId:d,dmDrawerVisibility:u}})),w=function(e){return function(t){return h.c(e,t)}},S=Object(f.d)(I,(function(e){return{cancelUpload:(t=e.match.params.conversationId,function(){return h.b(t)}),googleAnalyticsPageView:u.a,removeMedia:w(e.match.params.conversationId),scribePageImpression:u.d,setLastViewedDmInboxPath:g.h,updateTweetDetailNav:_.b,popOutConversation:p.popOutConversation,setDrawerVisibility:p.setDrawerVisibility};var t})),O=n("7JQg"),x=n("jdj2"),M=n.n(x),P=(n("uB9N"),n("Oi4X")),A=n("SrtL"),D=n("3XMw"),T=n.n(D),k=n("rHpw"),N=n("mw9i"),R=n("FIs5"),L=T.a.a2f8105f,j=T.a.fa91f351,B=T.a.b999caa8,U=T.a.de2c3337,G=k.a.create((function(e){return{root:{alignItems:"center",justifyContent:"center",flex:1,backgroundColor:e.colors.cellBackground}}})),z=function(e){function t(){return e.apply(this,arguments)||this}return i()(t,e),t.prototype.render=function(){var e=this.props.onButtonPress;return l.createElement(N.a,{style:G.root},l.createElement(A.a,{title:L}),l.createElement(R.a,{buttonText:U,header:j,message:B,onButtonPress:e}))},t}(l.PureComponent),W=n("xPna"),F=n("wrlS"),H=n("XnpN"),V=n("E8TX"),q=n.n(V),K=n("H9O4"),X=n.n(K),Z=n("7myi"),Q=n("M2mT"),Y=(n("AxOO"),n("aITJ")),J=n("3xO4"),$=n.n(J),ee=(n("aWzz"),n("/yvb")),te=n("OhSZ"),ne=T.a.d4986f85,oe=T.a.e3e58b6d,re=T.a.a9ddbb94,ae=l.createElement(q.a,null),ie=l.createElement(X.a,null),se=function(e){function t(t){var n;n=e.call(this,t)||this,c()(r()(n),"_composer",l.createRef()),c()(r()(n),"_handleConversationClose",(function(e){var t=n.props,o=t.conversation,r=t.history;(null==o?void 0:o.trusted)?r.push("/messages"):e()})),c()(r()(n),"_handlePopOutConvo",(function(){var e=n.props,t=e.conversationId;(0,e.popOutConversation)(t)})),c()(r()(n),"_handlePopInConvoFromScreen",(function(){(0,n.props.setDrawerVisibility)(W.a.CLOSED)})),c()(r()(n),"_handleInfoClick",(function(){var e=n.props,t=e.history,o=e.conversationId;o&&t.push("/messages/"+o+"/info")})),c()(r()(n),"_updateLastViewDmInboxPath",(function(){var e=n.props;(0,e.setLastViewedDmInboxPath)(e.location.pathname)}));var o=t.conversationId,a=t.history,i=t.location,s=t.isNewGroupConversation;return o||s||i.pathname!==window.location.pathname||a.replace({pathname:"/messages"}),n._showDMQuickAccess=F.a.isTrue("responsive_web_dm_quick_access_enabled"),n._showDMQuickAccessWithClose=F.a.isTrue("responsive_web_dm_quick_access_with_close_enabled"),n}i()(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.googleAnalyticsPageView,n=e.scribeNamespace,o=e.scribePageImpression,r=e.updateTweetDetailNav;o(n),r(n),t(n),this._updateLastViewDmInboxPath()},n.componentDidUpdate=function(e){this.props.conversationId!==e.conversationId&&this._updateLastViewDmInboxPath()},n.render=function(){var e=this.props,t=e.conversationId,n=e.dmDrawerVisibility,o=e.history,r=e.location,a=e.poppedOutConversationId,i=e.richTextInputContext,s=e.typeaheadWrapper,c="string"==typeof r.query.text?r.query.text:void 0,d=M.a.get("window").width>=k.a.theme.breakpoints.small,u=this._showDMQuickAccess&&this._showDMQuickAccessWithClose&&t===a&&n!==W.a.CLOSED;return l.createElement(Q.a,this._getNavProps(),u?l.createElement(z,{onButtonPress:this._handlePopInConvoFromScreen}):l.createElement(P.a,{conversationId:t,history:o,isWide:d,location:r,prefillText:c,richTextInputContext:i,typeaheadWrapper:s}))},n._getNavProps=function(){var e=this.props,t=e.conversation,n=e.newConversationParticipants,o=e.perspective,r=t&&Object.keys(t.participants).length?Object(te.a)({conversation:t,perspective:o}):n?Object(te.a)({newConversationParticipants:n,perspective:o}):ne,a=t&&Object.keys(t.participants).length?l.createElement(te.b,{conversation:t,perspective:o,titleWeight:"heavy",withScreenName:!1}):n?l.createElement(te.b,{newConversationParticipants:n,perspective:o,titleWeight:"heavy",withScreenName:!1}):ne,i=t&&t.type===p.CONVERSATION_TYPE.ONE_TO_ONE&&o&&Object(H.a)(t,o).map((function(e){return e.user.screen_name})),s=i?"@"+i[0]:void 0;return{backLocation:"/messages",onBackClick:this._handleConversationClose,documentTitle:r,rightControl:this._renderRightControl(),title:a,subtitle:s,screenType:"primaryDetail",withBottomTabBar:!1,headerless:Y.a.isKaiOS()}},n._renderRightControl=function(){var e=this.props,t=e.conversation,n=e.conversationId,o=(null==t?void 0:t.type)===p.CONVERSATION_TYPE.GROUP;return n?l.createElement($.a,{style:ce.rightControlStyles},d.a.isTwoColumnLayout(M.a.get("window").width)&&this._showDMQuickAccess&&this._showDMQuickAccessWithClose&&l.createElement(ee.a,{icon:ie,onPress:this._handlePopOutConvo,pullRight:!0,style:ce.infoButton,type:"text"}),l.createElement(ee.a,{accessibilityLabel:o?re:oe,icon:ae,key:n,link:"/messages/"+n+"/info",pullRight:!0,style:ce.infoButton,type:"text"})):void 0},t}(l.PureComponent);c()(se,"defaultProps",{isNewGroupConversation:!1,typeaheadWrapper:Z.a});var ce=k.a.create((function(e){return{root:{flexGrow:1},activity:{flexBasis:"1px",flexGrow:1,height:"100%"},kaiOSFix:{paddingBottom:20},dragDrop:{flexGrow:1},scrollView:{flexGrow:1},infoButton:{marginRight:e.spaces.xxSmall},offsetBottom:{paddingBottom:k.a.iPhoneOffsetBottom},rightControlStyles:{flexDirection:"row"}}}));t.default=Object(O.c)({page:"messages",section:"thread"})(S(se))},f42t:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n("lTEL"),n("z84I"),n("KOtZ"),n("+KXO"),n("7x/C"),n("JtPf"),n("87if"),n("kYxP");var o=n("97Jx"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("ERkP"),c=(n("aWzz"),function(e){function t(t){var n;return(n=e.call(this,t)||this).state={isLoaded:!1},n}i()(t,e);var n=t.prototype;return n.componentDidMount=function(){return this._isMounted=!0,this.load()},n.componentDidUpdate=function(e){return this.props.modules===e.modules?null:this.load()},n.componentWillUnmount=function(){this._isMounted=!1},n.load=function(){var e=this;this.setState({isLoaded:!1});var t=this.props.modules,n=Object.keys(t);return Promise.all(n.map((function(e){return t[e]()}))).then((function(e){return n.reduce((function(t,n,o){return t[n]=e[o],t}),{})})).then((function(t){if(!e._isMounted)return null;e.setState({modules:t,isLoaded:!0})}))},n.render=function(){var e=this.state.isLoaded?this.state.modules:{};return s.Children.only(this.props.children(e||{}))},t}(s.Component)),l=function(e,t){return function(n){return s.createElement(c,{modules:t},(function(t){return s.createElement(e,r()({},t,n))}))}}},fzwJ:function(e,t,n){"use strict";n.r(t),n.d(t,"DMAddParticipantsScreen",(function(){return ee}));n("2G9S"),n("i4UL"),n("LW0h"),n("hBpG"),n("z84I"),n("M+/F");var o=n("RhWx"),r=n.n(o),a=n("1Pcy"),i=n.n(a),s=n("W/Kd"),c=n.n(s),l=n("KEM+"),d=n.n(l),u=n("ERkP"),p=n("k49u"),h=n("VAZu"),m=(n("+KXO"),n("KqXw"),n("WNMA"),n("MMRb")),f=n("1YZw"),v=n("lnti"),b=n("0KEI"),g=n("hqKg"),_=n("RqPI"),y=n("G6rE"),C=n("oEGd"),E=function(e,t){return t.match.params.conversationId},I=Object(g.createSelector)(m.selectConversations,(function(e){return Object(v.a)(Object.keys(e).map((function(t){var n=e[t];if(!n.isDeleted)return n.data})))})),w=Object(g.createSelector)(E,I,(function(e,t){var n=m.selectConversation(e,E(0,t)),o=n&&n.data;return o&&o.participants}),(function(e,t){return m.selectConversationFetchStatus(e,E(0,t))}),_.g,y.e.selectAll,(function(e,t,n,o,r,a){if(!r)throw new Error("logged-in user not found");return{conversationId:e,conversations:t,existingParticipants:n,fetchStatus:o,perspective:r,users:a}})),S={addParticipants:m.addParticipants,addToast:f.b,createLocalApiErrorHandler:Object(b.d)("DIRECT_MESSAGES_ADD_PARTICIPANTS"),fetchConversationIfNeeded:m.fetchConversationIfNeeded},O=Object(C.g)(w,S),x=n("7JQg"),M=n("I2k/"),P=n("s14A"),A=n("kGix"),D=n("jHSc"),T=n("wO1l"),k=n("AQOc"),N=n("3XMw"),R=n.n(N),L=n("oQhu"),j={nextButton:"nextButton",searchPeople:"searchPeople"},B=n("GZwR"),U=n("2dXj"),G=n("3xO4"),z=n.n(G),W=n("/yvb"),F=n("rHpw"),H=R.a.c6026009,V=R.a.d4986f85,q=R.a.af40a8ef,K=R.a.e1bde73e,X=R.a.e62d3c10,Z=R.a.f17f716a,Q=R.a.e3fc3547,Y=R.a.c55f5c9a,J=R.a.h8403fb5,$=R.a.ja522ed3,ee=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,d()(i()(t),"state",{participantsToAdd:[],query:""}),d()(i()(t),"_renderHeader",(function(){var e=t.props,n=e.conversationId,o=e.history,r=e.location;return u.createElement(h.a,{backButtonType:"close",backLocation:"/messages/"+n,history:o,location:r,ref:t._setAppBarRef,rightControl:t._renderAppBarRightControl(),title:H,withBottomBorder:!1})})),d()(i()(t),"_renderAppBarRightControl",(function(){return u.createElement(z.a,{style:te.rightColumn},u.createElement(W.a,{disabled:0===t.state.participantsToAdd.length||t.props.fetchStatus!==A.a.LOADED,onPress:t._handleAddSelectedParticipantsToConversation,size:"normalCompact",testID:j.addPeopleButtonText,type:"primary"},q))})),d()(i()(t),"_handleQueryChange",(function(e){t.setState({query:e})})),d()(i()(t),"_handleSuggestionClicked",(function(e){var n=t.state.participantsToAdd;n.find((function(t){return t.id===e.id}))?t._handleUnselectParticipant(e):t.setState({participantsToAdd:[].concat(r()(n),[e])})})),d()(i()(t),"_handleUnselectParticipant",(function(e){var n=t.state.participantsToAdd;t.setState({participantsToAdd:n.filter((function(t){return t.id!==e.id}))})})),d()(i()(t),"_handleAddSelectedParticipantsToConversation",(function(){var e,n=t.props,o=n.addParticipants,r=n.conversationId,a=n.createLocalApiErrorHandler;o(r,t.state.participantsToAdd.map((function(e){return e.id}))).then((function(e){t._appBarRef&&t._appBarRef.goBack()}),a(((e={defaultToast:{text:$}})[p.a.DirectMessageCannotDmOtherUser]={toast:{text:Y}},e[p.a.DirectMessageGenericUserCouldNotBeAdded]={toast:{text:J}},e[p.a.DirectMessageOtherUserNotFollowing]={toast:{text:Z}},e[p.a.TargetUserNotFound]={toast:{text:X}},e[p.a.TieredActionTweetSpammer]={toast:{text:Q}},e.showToast=!0,e)))})),d()(i()(t),"_getInjections",Object(L.a)((function(e,t,n,o){return Object(T.b)(n,e.map((function(e){return Object(k.b)(e,void 0,o)})),t).slice(0,12)}))),d()(i()(t),"_getItemIsDisabled",(function(e){var t=e.data;return!(t.can_dm||t.is_dm_able)})),d()(i()(t),"_getItemDisabledMessage",(function(e){return K({screenName:e.data.screen_name})})),d()(i()(t),"_setAppBarRef",(function(e){t._appBarRef=e})),t}c()(t,e);var n=t.prototype;return n.UNSAFE_componentWillMount=function(){var e=this.props,t=e.createLocalApiErrorHandler,n=e.conversationId;(0,e.fetchConversationIfNeeded)({conversationId:n}).catch(t(Object(M.a)(n)))},n.render=function(){var e=this.props,t=e.conversations,n=e.existingParticipants,o=e.location,r=e.perspective,a=e.users,i=this.state.query,s=n&&n.map((function(e){return e.user_id}));return u.createElement(D.b,{containerStyle:te.fill,documentTitle:V,location:o,renderHeader:this._renderHeader},u.createElement(P.a,{style:te.fill},u.createElement(U.d,{getItemDisabledMessage:this._getItemDisabledMessage,getItemIsDisabled:this._getItemIsDisabled,injections:this._getInjections(t,r,i,a),onQueryChange:this._handleQueryChange,onRemove:this._handleUnselectParticipant,onSelect:this._handleSuggestionClicked,preselectedUsers:s,selectedUsers:this.state.participantsToAdd,source:B.d.ComposeMessage,withCompactPills:!0})))},t}(u.Component);d()(ee,"defaultProps",{existingParticipants:[]});var te=F.a.create((function(e){return{fill:{flex:1},rightColumn:{flexDirection:"row",flexGrow:1,justifyContent:"flex-end",alignItems:"center"}}}));t.default=Object(x.c)({page:"messages",section:"add_participants"})(O(ee))},"hl/W":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));n("LW0h"),n("z84I"),n("tQbP"),n("7x/C"),n("1IsZ"),n("JtPf");var o=n("zh9S"),r=n("MMRb"),a=n("P1r1"),i=n("oEGd"),s=n("4q8G"),c=n("0KEI"),l=n("hqKg"),d=n("kGix"),u=n("tn7R"),p=n("z2Pn"),h={primary:"primary",secondary:"secondary",tertiary:"tertiary"},m=function(e,t){return"all"===e.allow_dms_from||t>0},f=function(e){return e===h.primary?r.fetchTrustedInboxHistory:e===h.secondary?r.fetchUntrustedInboxHistory:r.fetchUntrustedLowQualityInboxHistory},v=function(e){return e===h.primary?r.updateTrustedLastSeenEventId:e===h.secondary?r.updateUntrustedLastSeenEventId:function(){return function(){return Promise.resolve()}}},b=function(e,t){var n=e.low_quality?"low":"high",o=e.trusted===t.trusted;return t.filterByQuality?n===t.allowedQuality&&o:o},g=function(e,t){return t&&("HAS_MORE"===t.status||"AT_END"===t.status&&e>0)},_=function(e,t){return e===h.primary?{filterByQuality:!1,trusted:!0}:e===h.secondary?{filterByQuality:t,allowedQuality:"high",trusted:!1}:{filterByQuality:!0,allowedQuality:"low",trusted:!1}};t.b=function(e){var t=e.inbox;return Object(i.g)(function(e){return Object(l.createSelector)(r.selectFetchStatus,r.selectIsLoadingTop,r.selectConversations,r.selectUntrustedUnreadCount,r.selectUntrustedCursor,r.selectUntrustedConversationCount,r.selectUntrustedLowQualityConversationCount,r.selectUntrustedLowQualityCursor,a.f,(function(t,n,o,r,a,i,c,l,p){var f=(e===h.secondary||e===h.tertiary)&&"all"===p.allow_dms_from&&"enabled"===p.dm_quality_filter,v=_(e,f),y=!!Object.values(o).length,C=Object(u.a)(o).filter((function(e){return e.data&&!e.isDeleted&&b(e.data,v)})).map((function(e){return e.data})).sort(s.a);return{fetchStatus:y?d.a.LOADED:t,isRefreshing:y&&n,conversationIds:C.map((function(e){return e.conversation_id})),untrustedUnreadCount:r,allowUntrustedInbox:m(p,i),allowLowQualityUntrustedInbox:f&&g(c,l),isAtEndOfUntrustedInbox:"AT_END"===a.status}}))}(t),function(e){return{createLocalApiErrorHandler:Object(c.d)("DIRECT_MESSAGES_INBOX"),fetchInboxHistory:f(e),fetchInbox:r.fetchInbox,fetchInboxIfNeeded:r.fetchInboxIfNeeded,fetchUpdates:r.fetchUpdatesIfNeeded,googleAnalyticsPageView:o.a,scribeAction:o.c,scribePageImpression:o.d,setDrawerExperimentEnabled:r.setDrawerExperimentEnabled,setLastViewedDmInboxPath:p.h,updateLastSeenEventId:v(e)}}(t))}},hqDb:function(e,t,n){"use strict";n("2G9S");var o=n("97Jx"),r=n.n(o),a=n("LdEA"),i=n.n(a),s=n("1Pcy"),c=n.n(s),l=n("W/Kd"),d=n.n(l),u=n("KEM+"),p=n.n(u),h=n("ERkP"),m=n("k49u"),f=(n("LW0h"),n("vrRf"),n("KOtZ"),n("rxPX")),v=n("0KEI"),b=n("6xIQ"),g=n("kGix"),_=n("G6rE"),y=function(e,t){return t.userIds},C=function(e,t){return t.userIds.filter((function(t){return!!_.e.select(e,t)}))},E=function(e,t){return t.userIds.reduce((function(t,n){var o=_.e.selectFetchStatus(e,n);return t[n]=o===g.a.NONE?g.a.LOADING:o,t}),{})},I=Object(f.a)().propsFromState((function(){return{availableUserIds:Object(b.a)(C,(function(e){return e})),fetchStatus:Object(b.a)(C,E,y,(function(e,t,n){for(var o=g.a.LOADED,r=0;r<n.length;r++){var a=n[r];if(-1===e.indexOf(a)){var i=t[a]||g.a.LOADING;o=o===g.a.LOADED?i:o}if(o===g.a.LOADED)break}return o}))}})).propsFromActions((function(){return{createLocalApiErrorHandler:Object(v.d)("USERS_LIST_CONTAINER"),fetchUsersIfNeeded:_.e.fetchManyIfNeeded}})),w=n("v//M"),S=n("3XMw"),O=n.n(S),x=n("pQ3Z"),M=n.n(x),P=(n("z84I"),n("cFuS")),A=n("Re5t"),D=n("3xO4"),T=n.n(D),k=n("88ay"),N=function(e){var t=e.displayMode,n=e.renderUserCell,o=e.withFinalItemBorder,r=e.withItemBorder,a=e.userIds;return h.createElement(T.a,null,a.map((function(e,i){var s=i===a.length-1,c=s&&r&&o||!s&&r;return n?n(e):h.createElement(k.b,{decoration:k.d,displayMode:t,key:e,promotedItemType:P.c.USER,userId:e,withBottomBorder:!!c,withFollowsYou:!0})})))};N.defaultProps={displayMode:A.a.UserDetailed,withFinalItemBorder:!0,withItemBorder:!1};var R=N,L=O.a.f5b426c2,j=I(function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,p()(c()(t),"state",{allUsersUnavailable:!1}),p()(c()(t),"_renderContent",(function(){var e=t.props,n=e.availableUserIds,o=(e.createLocalApiErrorHandler,e.fetchStatus,e.fetchUsersIfNeeded,e.userIds,i()(e,["availableUserIds","createLocalApiErrorHandler","fetchStatus","fetchUsersIfNeeded","userIds"]));return h.createElement(R,r()({},o,{userIds:n}))})),p()(c()(t),"_handleFetch",(function(){t._fetchUsersIfNeeded()})),t}d()(t,e);var n=t.prototype;return n.componentDidMount=function(){this._fetchUsersIfNeeded()},n.componentDidUpdate=function(e){M()(e.userIds,this.props.userIds)||this._fetchUsersIfNeeded()},n.render=function(){return h.createElement(w.a,{accessibilityLabel:L,fetchStatus:this.state.allUsersUnavailable?g.a.LOADED:this.props.fetchStatus,onRequestRetry:this._handleFetch,render:this._renderContent,retryable:!1})},n._fetchUsersIfNeeded=function(){var e,t=this,n=this.props,o=n.createLocalApiErrorHandler,r=n.fetchUsersIfNeeded,a=n.availableUserIds;r(n.userIds).then((function(){t.setState({allUsersUnavailable:!1})}),o(((e={})[m.a.AddressBookLookupNotFound]={customAction:function(){0===a.length&&t.setState({allUsersUnavailable:!0})}},e)))},t}(h.Component));t.a=j},jUV2:function(e,t,n){"use strict";n.r(t),n.d(t,"DMInboxScreen",(function(){return z}));n("2G9S"),n("IAdD"),n("uFXj");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=n("7JQg"),u=n("/yvb"),p=n("3XMw"),h=n.n(p),m=n("1sB9"),f=n.n(m),v=h.a.f325afc3,b=function(e){var t=e.testID;return l.createElement(u.a,{accessibilityLabel:v,icon:l.createElement(f.a,null),link:"/messages/compose",pullRight:!0,testID:t,type:"text"})},g=n("qz2E"),_=n("wrlS"),y=n("qS4/"),C=n("f42t"),E=n("v6aA"),I=n("M2mT"),w=n("Es6L"),S="NewDM_Button",O=n("3xO4"),x=n.n(O),M=n("csss"),P=n("Znyr"),A=n("FIs5"),D=n("rHpw"),T=n("hl/W"),k=h.a.a2f8105f,N=h.a.cf2d1047,R=h.a.b8aa3744,L=h.a.j06309e1,j=h.a.gee5150a,B=h.a.da2f9224,U=h.a.h6beb5fa,G={page:"messages",section:"inbox",component:"inbox_timeline"},z=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,c()(r()(t),"_renderPivot",(function(){return t.props.allowUntrustedInbox?l.createElement(x.a,{style:W.requestPivotContainer},l.createElement(M.a,{label:N,link:"/messages/requests",onPress:t._handleRequestsPivotClick,renderRightContent:t._renderPivotBadge,withBottomBorder:!1})):null})),c()(r()(t),"_renderPivotBadge",(function(){var e=t.props.untrustedUnreadCount;return e>0?l.createElement(P.a,{count:e,standalone:!0,truncatedCountFormatter:U,unreadCountLabel:B}):null})),c()(r()(t),"_renderEmptyDMInbox",(function(){return l.createElement(A.a,{buttonLink:"/messages/compose",buttonText:j,header:R,message:L,onImpression:t._handleEmptyDMInboxImpression})})),c()(r()(t),"_handleEmptyDMInboxImpression",(function(){var e=t.props,n=e.scribeAction,o=e.scribeNamespace;n(Object.assign({},o,{component:"empty_message",action:"impression"}))})),c()(r()(t),"_handleRequestsPivotClick",(function(){var e=t.props,n=e.scribeAction,o=e.scribeNamespace;n(Object.assign({},o,{element:"requests_pivot",action:"click"}))})),t}i()(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this.props,t=e.allowUntrustedInbox,n=e.location,o=e.scribeAction,r=e.scribeNamespace,a=e.setLastViewedDmInboxPath,i=e.setDrawerExperimentEnabled;a(n.pathname),t&&o(Object.assign({},r,{element:"requests_pivot",action:"impression"})),i(_.a.isTrue("responsive_web_dm_quick_access_enabled"))},n.render=function(){var e=Object(w.a)()?l.createElement(b,{testID:S}):void 0,t=this.props,n=t.conversationIds,o=t.createLocalApiErrorHandler,r=t.fetchInbox,a=t.fetchInboxHistory,i=t.fetchInboxIfNeeded,s=t.fetchStatus,c=t.fetchUpdates,d=t.googleAnalyticsPageView,u=t.isRefreshing,p=t.scribeAction,h=t.scribePageImpression,m=t.updateLastSeenEventId;return l.createElement(I.a,{rightControl:e,screenType:"root",title:k},l.createElement(y.a,{accessibilityTitle:k,conversationIds:n,conversationPathPrefix:"/messages",createLocalApiErrorHandler:o,fetchInbox:r,fetchInboxHistory:a,fetchInboxIfNeeded:i,fetchStatus:s,fetchUpdates:c,googleAnalyticsPageView:d,isRefreshing:u,renderEmptyDMInbox:this._renderEmptyDMInbox,renderStickyContent:this._renderPivot,scribeAction:p,scribeNamespace:G,scribePageImpression:h,updateLastSeenEventId:m,virtualScrollerCacheKey:"dmInbox",withDmSearch:!0}))},t}(l.Component);c()(z,"contextType",E.a),c()(z,"defaultProps",{conversationIds:[],untrustedUnreadCount:0});var W=D.a.create((function(e){return{requestPivotContainer:{backgroundColor:e.colors.cellBackground,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,zIndex:2}}})),F=Object(C.a)(Object(d.c)(G)(Object(T.b)({inbox:T.a.primary})(z)),{directMessages:g.a});t.default=F},lL5k:function(e,t,n){"use strict";var o=/[|\\{}()[\]^$+*?.]/g;e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(o,"\\$&")}},uHIe:function(e,t,n){"use strict";n.r(t),n.d(t,"DMMediaScreen",(function(){return O}));n("2G9S"),n("KqXw"),n("MvUL");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=(n("WNMA"),n("oEGd")),u=n("hqKg"),p=n("zh9S"),h=n("H9MA"),m=n("uKEd"),f=function(e,t){return t.match.params.entryId},v=Object(u.createSelector)(f,(function(e,t){return Object(m.n)(e,f(0,t))}),(function(e,t){return t.match.params.conversationId}),h.c,(function(e,t,n,o){var r=t&&t.message_data.attachment||{};return{conversationId:n,mediaItem:r.photo||r.animated_gif||r.video,messageId:e,dataSaver:o}})),b={scribeAction:p.c},g=Object(d.g)(v,b),_=n("7JQg"),y=n("RCZO"),C=n("kp0V"),E=n("2doW"),I=n("UPvq"),w=n("wiP2"),S=n("lklz"),O=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,c()(r()(t),"_handleClose",(function(){var e=t.props,n=e.conversationId,o=e.history,r=e.location,a=n?"/messages/"+n:"/messages";Object(C.a)({backLocation:a,history:o,location:r})})),t}i()(t,e);var n=t.prototype;return n.UNSAFE_componentWillMount=function(){var e=this.props,t=e.conversationId,n=e.history;e.mediaItem||n.replace(t?"/messages/"+t:"/messages")},n.render=function(){var e=this.props,t=e.dataSaver,n=e.mediaItem,o=e.messageId,r=Object(y.b)(n);return n?l.createElement(w.a.Configure,{headerless:!0},l.createElement(I.a,{backgroundColor:r,mediaItem:n,onCloseButtonPress:this._handleClose},l.createElement(E.a,{dataSaver:t,mediaItems:[n],onDismiss:this._handleClose,videoId:S.b.forDm(o)}))):null},t}(l.Component);t.default=Object(_.c)({page:"messages",section:"media"})(g(O))},wG2w:function(e,t,n){"use strict";n.r(t),n.d(t,"DMUntrustedInboxScreen",(function(){return L}));n("2G9S"),n("IAdD"),n("KqXw"),n("WNMA"),n("uFXj");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=n("HPNB"),u=n("7JQg"),p=n("qz2E"),h=n("qS4/"),m=n("3XMw"),f=n.n(m),v=n("f42t"),b=n("v6aA"),g=n("zCf4"),_=n("M2mT"),y=n("zML4"),C=n("3xO4"),E=n.n(C),I=n("0yYu"),w=n("t62R"),S=n("cm6r"),O=n("cHvH"),x=n("FIs5"),M=n("rHpw"),P=n("hl/W"),A=f.a.cf2d1047,D=f.a.bef0039f,T=f.a.eb7de4a9,k=f.a.a0e81a2e,N=f.a.a5359aac,R={page:"messages",section:"inbox",component:"requests_timeline"},L=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,c()(r()(t),"componentDidMount",(function(){var e=t.props.scribeAction;t._shouldRenderTombstone()&&e(Object.assign({},R,{element:"low_quality_pivot",action:"impression"}))})),c()(r()(t),"componentDidUpdate",(function(e){var n=t.props.scribeAction;!t._shouldRenderTombstone()||e.allowLowQualityUntrustedInbox&&e.isAtEndOfUntrustedInbox||n(Object.assign({},R,{element:"low_quality_pivot",action:"impression"}))})),c()(r()(t),"_shouldRenderTombstone",(function(){var e=t.props,n=e.allowLowQualityUntrustedInbox,o=e.isAtEndOfUntrustedInbox;return n&&o})),c()(r()(t),"_renderTombstone",(function(){var e=t.props.conversationIds;return t._shouldRenderTombstone()?l.createElement(E.a,null,e.length>0&&l.createElement(I.a,null),l.createElement(E.a,{style:j.tombstoneDescription},l.createElement(w.c,{color:"deepGray",size:"small"},T)),l.createElement(S.a,{link:"/messages/requests/additional",onPress:t._handleTombstoneClick,style:j.tombstoneContainer},l.createElement(w.c,{align:"center",color:"primary",size:"normal"},k))):null})),c()(r()(t),"_renderStickyCopy",(function(){var e=t.props.conversationIds;return l.createElement(O.a,null,(function(t){var n=t.windowWidth,o=d.a.isTwoColumnLayout(n),r=0===e.length;return o||r?null:l.createElement(E.a,{style:j.stickyCopyContainer},l.createElement(w.c,{style:j.stickyCopy},N))}))})),c()(r()(t),"_renderSettingsAppBarButton",(function(){return l.createElement(y.a,{to:"/settings/safety"})})),c()(r()(t),"_renderEmptyDMInbox",(function(){var e=t._renderTombstone();return l.createElement(l.Fragment,null,l.createElement(x.a,{header:e?"":D,message:N,style:j.emptyMessage}),e)})),c()(r()(t),"_handleBackClick",(function(){t.props.history.push("/messages")})),c()(r()(t),"_handleTombstoneClick",(function(){(0,t.props.scribeAction)(Object.assign({},R,{element:"low_quality_pivot",action:"click"}))})),c()(r()(t),"_hasConversationOpen",(function(){return!t.props.match.isExact})),t}return i()(t,e),t.prototype.render=function(){var e=this.props,t=e.allowUntrustedInbox,n=e.conversationIds,o=e.createLocalApiErrorHandler,r=e.fetchInbox,a=e.fetchInboxHistory,i=e.fetchInboxIfNeeded,s=e.fetchStatus,c=e.fetchUpdates,d=e.googleAnalyticsPageView,u=e.isRefreshing,p=e.scribeAction,m=e.scribePageImpression,f=e.updateLastSeenEventId;return t?l.createElement(_.a,{backLocation:"/messages",onBackClick:this._handleBackClick,rightControl:this._renderSettingsAppBarButton(),screenType:"secondaryRoot",title:A,withDetailOpen:this._hasConversationOpen()},l.createElement(h.a,{accessibilityTitle:A,conversationIds:n,conversationPathPrefix:"/messages/requests",createLocalApiErrorHandler:o,fetchInbox:r,fetchInboxHistory:a,fetchInboxIfNeeded:i,fetchStatus:s,fetchUpdates:c,footer:this._renderTombstone(),googleAnalyticsPageView:d,isRefreshing:u,renderEmptyDMInbox:this._renderEmptyDMInbox,renderStickyContent:this._renderStickyCopy,scribeAction:p,scribeNamespace:R,scribePageImpression:m,updateLastSeenEventId:f,virtualScrollerCacheKey:"dmUntrustedInbox"})):l.createElement(g.a,{to:"/messages"})},t}(l.Component);c()(L,"contextType",b.a),c()(L,"defaultProps",{conversationIds:[]});var j=M.a.create((function(e){return{emptyMessage:{borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor,borderBottomWidth:e.borderWidths.small,paddingVertical:e.spaces.small},stickyCopyContainer:{backgroundColor:e.colors.cellBackground,borderBottomStyle:"solid",borderBottomWidth:e.borderWidths.small,borderBottomColor:e.colors.borderColor,zIndex:1},stickyCopy:{color:e.colors.deepGray,padding:e.spaces.medium},tombstoneContainer:{borderTopStyle:"solid",borderTopColor:e.colors.borderColor,borderTopWidth:e.borderWidths.small,borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor,borderBottomWidth:e.borderWidths.small,paddingVertical:e.spaces.xSmall},tombstoneDescription:{paddingHorizontal:e.spaces.small,paddingVertical:e.spaces.small}}})),B=Object(v.a)(Object(u.c)(R)(Object(P.b)({inbox:P.a.secondary})(L)),{directMessages:p.a});t.default=B},wO1l:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return b}));n("2G9S"),n("LW0h"),n("z84I"),n("5BYb"),n("tQbP"),n("ho0z"),n("IAdD"),n("iKE+"),n("KqXw"),n("DZ+c");var o=n("LdEA"),r=n.n(o),a=n("aWyx"),i=n("4q8G"),s=n("lL5k"),c=n.n(s),l=n("XnpN"),d=n("w6IS"),u=n("s1N3"),p=n("VIKJ"),h=n("vy4g"),m=n("GZwR");function f(e){return Object(u.a)(e,(function(e){var t=e.type,n=e.id;return t===m.b.DMConversation?"c_"+n:"u_"+n}))}var v=function(e,t,n,o){void 0===o&&(o=!1);var a=e&&new RegExp("(^|.*\\s)"+c()(e)+".*","i");return f(function(e,t){return Object(d.a)(e.map((function(e){return Object(l.a)(e,t).map((function(e){return e.user}))})))}(t.sort(i.a),n).filter((function(e){return(!a||(a.test(e.screen_name)||a.test(e.name)))&&(e.followed_by||o)})).map((function(e){return function(e){var t=e.id_str,n=Object(h.a)(Object(h.b)(e),m.c.DMInjected),o=n.tokens,a=n.rounded_score,i=n.src,s=r()(n,["tokens","rounded_score","src"]);return{data:Object.assign({},s,{can_dm:!0}),rounded_score:a,tokens:o,src:i,id:t,type:m.b.User}}(e)})))};function b(e,t,n){var o=e&&new RegExp("(^|.*\\s)"+c()(e)+".*","i"),r=t.filter((function(e){return e.trusted})).filter((function(t){if(!e)return!0;var r=o&&t.name&&o.test(t.name),a=Object(l.a)(t,n).map((function(e){return e.user})),i=o&&a.some((function(e){return o.test(e.screen_name)||o.test(e.name)}));return r||i})).sort(i.a),s=r;if(e){var u=Object(p.a)(r,(function(e){return e.type===a.a.ONE_TO_ONE})),h=u[0],b=u[1];s=h.concat(b)}return f(Object(d.a)(s.map((function(t){var o=t.type===a.a.GROUP,r=[];return o&&r.push(function(e){return{data:{name:e.name||"",conversationId:e.conversation_id},id:e.conversation_id,type:m.b.DMConversation}}(t)),!e&&o||(r=r.concat(v(o?e:null,[t],n,!o))),r}))))}},yV8l:function(e,t,n){"use strict";n.r(t),n.d(t,"ConversationInfoScreen",(function(){return we})),n.d(t,"styles",(function(){return Se}));n("LW0h"),n("7xRU"),n("z84I"),n("M+/F"),n("IAdD"),n("1IsZ"),n("KqXw"),n("WNMA");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=n("EbOo"),u=n("EPsT"),p=(n("6U7i"),n("+KXO"),n("MMRb")),h=n("RqPI"),m=n("1YZw"),f=n("oEGd"),v=n("0KEI"),b=n("hqKg"),g=n("p9G8"),_=n("AQOc"),y=n("zh9S"),C=n("G6rE"),E=function(e,t){return t.match.params.conversationId},I=Object(b.createSelector)((function(e,t){return p.selectConversation(e,E(0,t))}),p.selectEntries,E,(function(e,t){return p.selectConversationFetchStatus(e,E(0,t))}),h.f,h.g,C.e.selectAll,(function(e,t,n,o,r,a,i){var s=e&&e.data,c=s&&Object(_.b)(s,t,i),l=c&&Object(g.a)(c,a),d=!(!s||!s.notifications_disabled),u=!(!s||!s.mention_notifications_disabled),p=s&&s.mute_expiration_time&&Number(s.mute_expiration_time),h=c?Object.keys(c.participants):[],m=h&&1===h.length&&h[0]===a,f=h&&h.filter((function(e){return e!==a})),v=m?h:f.slice(0,5),b=v.length<f.length;if(!a)throw new Error("logged-in user not found");return{conversation:c,conversationId:n,fetchStatus:o,groupName:l,mentionNotificationsDisabled:u,language:r,muteExpirationTime:p,notificationsDisabled:d,perspective:a,showViewPeople:b,visibleParticipants:v,isSelfConversation:m}})),w={addToast:m.b,block:C.e.block,createLocalApiErrorHandler:Object(v.d)("DIRECT_MESSAGES_CONVERSATION_INFO"),disableMentionNotifications:p.disableMentionNotifications,disableNotifications:p.disableNotifications,enableMentionNotifications:p.enableMentionNotifications,enableNotifications:p.enableNotifications,fetchConversationIfNeeded:p.fetchConversationIfNeeded,leaveConversation:p.leaveConversation,scribeAction:y.c,unblock:C.e.unblock,updateConversationName:p.updateConversationName},S=Object(f.g)(I,w),O=n("7JQg"),x=n("aWyx"),M=n("I2k/"),P=n("aA19"),A=n("v//M"),D=n("XnpN"),T=n("3XMw"),k=n.n(T),N=n("tuLS"),R=n("M2mT"),L=n("u0B7"),j=n("Re5t"),B=n("hqDb"),U=n("3xO4"),G=n.n(U),z=n("mjJ+"),W=n("mw9i"),F=n("5mJL"),H=n("t62R"),V=n("0yYu"),q=n("6vad"),K=n("jtO7"),X=n("CK8+"),Z=n("rHpw"),Q=n("mN6z"),Y=n("fs1G"),J=k.a.e3e58b6d,$=k.a.a9ddbb94,ee=k.a.abd845fd,te=k.a.g2fd3205,ne=k.a.eb1bb5a1,oe=k.a.c6026009,re=k.a.eb75875d,ae=k.a.j9552760,ie=k.a.ec39f437,se=k.a.g946f84b,ce=k.a.i8cf41b1,le=k.a.cc7c8ce6,de=k.a.hab58673,ue=k.a.e3c6e080,pe={confirmButtonLabel:k.a.bb1d57b6,actionTextDelete:k.a.ad63377d,actionTextLeave:k.a.g9074da4,header:k.a.gdf4b79f,text:k.a.h09b49f7},he=k.a.i6b19b07,me=k.a.j7bb1a42,fe=k.a.fcd4d489,ve=k.a.a30e1677,be=k.a.a9fd20be,ge=k.a.e133be4e,_e=k.a.c9623eeb,ye=k.a.cceeaf2b,Ce=k.a.d87bff5a,Ee=[{duration:1,displayText:k.a.j37c4674,toast:k.a.hf94a2d5},{duration:2,displayText:k.a.fb7a43c5,toast:k.a.bd54fad1},{duration:3,displayText:k.a.cb5bf56e,toast:k.a.f6fce0fd},{duration:0,displayText:k.a.cabeb6c1,toast:k.a.hfc86556}],Ie={page:"messages",section:"settings"},we=function(e){function t(t){var n;return n=e.call(this,t)||this,c()(r()(n),"_getScreenNameOfOneToOneConvo",(function(){var e=n._getSenderOfOneToOneConvo();return e?e.screen_name:""})),c()(r()(n),"_getBlockedOfOneToOneConvo",(function(){var e=n._getSenderOfOneToOneConvo();return e?e.blocking:null})),c()(r()(n),"_getSenderOfOneToOneConvo",(function(){var e=n.props,t=e.conversation,o=e.perspective,r=t&&Object(D.a)(t,o).map((function(e){return e.user}));return r&&r[0]||null})),c()(r()(n),"_renderContent",(function(){var e=n.props.conversation,t=!(null==e?void 0:e.trusted);return l.createElement(G.a,null,n._renderGroupSection(),n._renderParticipantsSection(),t?null:n._renderNotificationsSection(),n._renderConversationActions())})),c()(r()(n),"_getItems",(function(){return Ee.map((function(e){return{text:e.displayText,onClick:function(){return n._handleNotificationsDisabled(e)}}}))})),c()(r()(n),"_renderActionMenu",(function(e){return l.createElement(z.a,{items:n._getItems(),onCloseRequested:e})})),c()(r()(n),"_handleViewPeople",(function(){n._scribeAction("view_participants")})),c()(r()(n),"_handleBlockUser",(function(){var e=n.props,t=e.addToast,o=e.block,r=e.createLocalApiErrorHandler,a=n._getSenderOfOneToOneConvo(),i=a?a.id_str:"";""!==i&&(o(i).then((function(){t({actionLabel:ge,onAction:n._handleUnblockUser,text:be})}),r(d.a)),n._scribeAction("block"))})),c()(r()(n),"_handleUnblockUser",(function(){var e=n._getSenderOfOneToOneConvo(),t=e?e.id_str:"",o=n.props,r=o.createLocalApiErrorHandler;(0,o.unblock)(t).catch(r(L.a)),n._scribeAction("unblock")})),c()(r()(n),"_handleReportConversation",(function(){n._scribeAction("report")})),c()(r()(n),"_handleFetch",(function(){var e=n.props,t=e.createLocalApiErrorHandler,o=e.conversationId;(0,e.fetchConversationIfNeeded)({conversationId:o}).catch(t(Object(M.a)(o)))})),c()(r()(n),"_handleLeaveConversation",(function(){var e=n.props,t=e.conversation,o=e.conversationId,r=e.createLocalApiErrorHandler;(0,e.leaveConversation)({conversationId:o}).catch(r({showToast:!0}));var a=(null==t?void 0:t.type)===x.a.GROUP?"leave_group":"delete_thread";n._scribeAction(a),n._handleConversationClose()})),c()(r()(n),"_handleNotificationsDisabled",(function(e){var t=n.props,o=t.addToast,r=t.conversationId;(0,t.disableNotifications)({conversationId:r,duration:e.duration}),o({text:e.toast})})),c()(r()(n),"_handleNotificationsEnabled",(function(){var e=n.props,t=e.addToast,o=e.conversationId,r=e.createLocalApiErrorHandler;(0,e.enableNotifications)({conversationId:o}).then((function(){t({text:ie})}),r({showToast:!0}))})),c()(r()(n),"_handleMentionSwitchChanged",(function(e){var t=n.props,o=t.addToast,r=t.conversationId,a=t.createLocalApiErrorHandler,i=t.disableMentionNotifications,s=t.enableMentionNotifications,c=t.scribeAction,l=t.scribeNamespace;c(Object.assign({},l,{component:"dm_existing_conversation_dialog",action:e?"disable_mentions":"enable_mentions"})),e?i({conversationId:r}).then((function(){o({text:de})}),a({showToast:!0})):s({conversationId:r}).then((function(){o({text:ue})}),a({showToast:!0}))})),c()(r()(n),"_handleConversationClose",(function(){var e=n.props,t=e.history,o=e.match,r=Object.values(o.params).slice(0,-1).filter(Boolean);t.push({pathname:"/messages"+r.join("")})})),c()(r()(n),"_scribeAction",(function(e){var t=n.props,o=t.conversation,r=t.scribeAction,a=t.scribeNamespace,i=(null==o?void 0:o.trusted)?"trusted_conversation_info":"untrusted_conversation_info";r(Object.assign({},a,{element:i,action:e}),n._getScribeData())})),c()(r()(n),"_getScribeData",(function(){var e=n.props.conversation;return{items:[{conversation_type:(null==e?void 0:e.type)===x.a.GROUP?1:0}]}})),n.state={notificationsDisabled:t.notificationsDisabled,muteExpirationTime:t.muteExpirationTime},n}i()(t,e);var n=t.prototype;return n.componentDidMount=function(){this._handleFetch()},n.shouldComponentUpdate=function(e,t){return!Object(Q.a)(e,this.props)||!Object(Q.a)(t,this.state)},n.render=function(){var e=this.props,t=e.conversation,n=e.fetchStatus,o=e.conversationId,r=(null==t?void 0:t.type)===x.a.GROUP;return l.createElement(R.a,{backLocation:"/messages/"+o,screenType:"secondaryDetail",title:r?$:J,withBottomTabBar:!1},l.createElement(W.a,{style:Se.root},l.createElement(A.a,{accessibilityLabel:Ce,fetchStatus:n,onRequestRetry:this._handleFetch,render:this._renderContent})))},n._renderGroupSection=function(){var e=this.props,t=e.conversation,n=e.conversationId,o=e.groupName,r=e.perspective,a=(null==t?void 0:t.type)===x.a.GROUP,i=null==t?void 0:t.trusted;return a?l.createElement(F.a,{avatarCell:l.createElement(P.a,{conversation:t,perspective:r}),cellStyle:Se.groupSectionRight,style:Se.groupSection},l.createElement(H.c,{numberOfLines:1,weight:"bold"},o),i?l.createElement(H.c,{link:"/messages/"+n+"/group-info",style:Se.edit},ee):null):null},n._renderParticipantsSection=function(){var e=this.props,t=e.conversation,n=e.conversationId,o=e.showViewPeople,r=e.visibleParticipants,a=(null==t?void 0:t.type)===x.a.GROUP,i=null==t?void 0:t.trusted;return l.createElement(G.a,null,a?l.createElement(l.Fragment,null,l.createElement(V.a,null),l.createElement(q.a,{text:te})):null,l.createElement(B.a,{displayMode:j.a.UserCompact,userIds:r,withFinalItemBorder:a,withItemBorder:!0}),o?l.createElement(K.a,{color:"primary",label:ne,link:"/messages/"+n+"/participants",onClick:this._handleViewPeople,withBottomBorder:!0}):null,a&&i?l.createElement(K.a,{color:"primary",label:oe,link:"/messages/"+n+"/add"}):null)},n._renderMuteConversationSwitch=function(){var e=this.props,t=e.muteExpirationTime,n=e.notificationsDisabled;return n?l.createElement(G.a,{accessibilityRole:"label"},l.createElement(G.a,{style:Se.notificationsToggleContainer},l.createElement(H.c,{color:"normal"},ae),l.createElement(X.a,{onValueChange:this._handleNotificationsEnabled,value:n})),t?l.createElement(H.c,{color:"deepGray",size:"small",style:Se.notificationsDescription},this._displayExpirationTime()):null):l.createElement(G.a,{style:Se.notificationsToggleContainer},l.createElement(H.c,{color:"normal"},ae),l.createElement(N.a,{accessibilityLabel:ae,renderMenu:this._renderActionMenu},l.createElement(X.a,{onValueChange:Y.a,value:n})))},n._renderMuteMentionsSwitch=function(){var e=this.props.mentionNotificationsDisabled;return l.createElement(G.a,null,l.createElement(G.a,{accessibilityRole:"label",style:Se.notificationsToggleContainer},l.createElement(H.c,{color:"normal"},ce),l.createElement(X.a,{onValueChange:this._handleMentionSwitchChanged,value:e})),l.createElement(H.c,{color:"deepGray",size:"small",style:Se.notificationsDescription},le))},n._renderNotificationsSection=function(){var e=this.props,t=e.conversation,n=e.isSelfConversation,o=(null==t?void 0:t.type)===x.a.GROUP;return n?null:l.createElement(G.a,null,l.createElement(V.a,null),l.createElement(q.a,{text:re}),l.createElement(G.a,{style:o&&Se.settingGroup},this._renderMuteConversationSwitch()),o?this._renderMuteMentionsSwitch():null)},n._displayExpirationTime=function(){var e=this.props,t=e.language,n=e.muteExpirationTime;if(!n)return null;var o=n-(new Date).getTime()<864e5,r=new Date(n).toLocaleString(t||"en",o?{hour:"2-digit",minute:"2-digit"}:{weekday:"long",month:"short",day:"2-digit"});return se({expiration:r})},n._renderConversationActions=function(){var e=this.props.conversation,t=(null==e?void 0:e.type)!==x.a.GROUP,n=!(null==e?void 0:e.trusted);return l.createElement(G.a,null,l.createElement(V.a,null),t?this._renderBlockUserButton():null,this._renderReportConversationButton(),l.createElement(u.a,{confirmationSheetConfirmButtonLabel:pe.confirmButtonLabel,confirmationSheetConfirmButtonType:"destructive",confirmationSheetHeadline:pe.header,confirmationSheetText:pe.text,label:n?pe.actionTextDelete:pe.actionTextLeave,onConfirmationSheetConfirm:this._handleLeaveConversation,withBottomBorder:!1}))},n._renderBlockUserButton=function(){var e=this.props.isSelfConversation,t=this._getScreenNameOfOneToOneConvo(),n=this._getBlockedOfOneToOneConvo(),o=n?ye({screenName:t}):ve({screenName:t}),r=n?_e({screenName:t}):fe({screenName:t});return e?null:l.createElement(u.a,{color:"primary",confirmationSheetText:o,label:r,onConfirmationSheetConfirm:n?this._handleUnblockUser:this._handleBlockUser})},n._renderReportConversationButton=function(){var e=this.props,t=e.conversation,n=e.conversationId,o=e.isSelfConversation,r=(null==t?void 0:t.type)!==x.a.GROUP?me({screenName:this._getScreenNameOfOneToOneConvo()}):he,a={pathname:"/i/report/dm_conversation/"+n,state:{clientReferer:window.location.pathname,scribeNamespace:Ie}};return o?null:l.createElement(K.a,{color:"primary",label:r,link:a,onPress:this._handleReportConversation})},t}(l.Component),Se=Z.a.create((function(e){return{root:{backgroundColor:e.colors.cellBackground},edit:{flexShrink:0},groupSection:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},groupSectionRight:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},notificationsToggleContainer:{alignItems:"center",flexDirection:"row",flexGrow:1,justifyContent:"space-between",paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},notificationsDescription:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingBottom:e.componentDimensions.gutterVertical,paddingTop:0},settingGroup:{borderBottomColor:e.colors.borderColor,borderBottomWidth:1,borderBottomStyle:"solid"}}}));t.default=Object(O.c)(Ie)(S(we))},zML4:function(e,t,n){"use strict";var o=n("W/Kd"),r=n.n(o),a=n("ERkP"),i=n("3XMw"),s=n.n(i),c=n("3c1N"),l=n.n(c),d=n("/yvb"),u=n("rHpw"),p=s.a.bb081ea1,h=function(e){function t(){return e.apply(this,arguments)||this}return r()(t,e),t.prototype.render=function(){var e=this.props,t=e.onPress,n=e.to;return a.createElement(d.a,{accessibilityLabel:p,icon:a.createElement(l.a,null),link:n,onPress:t,pullRight:!0,style:m.button,type:"text"})},t}(a.PureComponent),m=u.a.create((function(e){return{button:{marginVertical:"calc(-"+e.spaces.xSmall+")"}}}));t.a=h},ziVO:function(e,t,n){"use strict";n("2G9S"),n("IAdD");var o=n("1Pcy"),r=n.n(o),a=n("W/Kd"),i=n.n(a),s=n("KEM+"),c=n.n(s),l=n("ERkP"),d=n("3xO4"),u=n.n(d),p={startX:0,startY:0},h=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,c()(r()(t),"_pullDistanceY",0),c()(r()(t),"_pullInfo",Object.assign({},p)),c()(r()(t),"_handleTouchStart",(function(e){t._pullInfo.startX=e.touches[0].clientX,t._pullInfo.startY=e.touches[0].clientY})),c()(r()(t),"_handleTouchMove",(function(e){if("number"==typeof t._pullInfo.startX&&"number"==typeof t._pullInfo.startY){var n=e.touches[0],o=n.clientX-t._pullInfo.startX,r=n.clientY-t._pullInfo.startY;Math.abs(o)>10||(e.preventDefault(),t._updatePullPosition(r))}})),c()(r()(t),"_handleTouchEnd",(function(e){Math.abs(t._pullDistanceY)>50?t._handleDismiss():t._resetPullInfo()})),c()(r()(t),"_updatePullPosition",(function(e){t._pullDistanceY=e})),c()(r()(t),"_handleDismiss",(function(){var e=t.props.onDismiss;e&&e(),t._resetPullInfo()})),c()(r()(t),"_resetPullInfo",(function(){t._updatePullPosition(0),t._pullInfo=Object.assign({},p)})),t}return i()(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=e.onDismiss,o=e.onLayout,r=e.style,a=!!n;return l.createElement(u.a,{onLayout:o,onTouchEnd:a?this._handleTouchEnd:void 0,onTouchMove:a?this._handleTouchMove:void 0,onTouchStart:a?this._handleTouchStart:void 0,style:r},t)},t}(l.Component);t.a=h}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/web_legacy/bundle.DirectMessages.58f18a94.js.map